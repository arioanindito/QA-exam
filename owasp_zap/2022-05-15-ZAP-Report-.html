<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZAP Scanning Report</title>
<link
	href="2022-05-15-ZAP-Report-/normalize/normalize.css" rel="stylesheet">
<link
	href="2022-05-15-ZAP-Report-/themes/original/main.css" rel="stylesheet">
<link
	href="2022-05-15-ZAP-Report-/themes/original/colors.css" rel="stylesheet">
</head>
<body>
	<header>
		<h1>ZAP Scanning Report</h1>
		<p>
			<span>Generated with</span> <a href="https://zaproxy.org"><img
				src="2022-05-15-ZAP-Report-/zap32x32.png" alt="The ZAP logo" class="zap-logo">ZAP</a>
			<span>on Sun 15 May 2022, at 16:33:13</span>
		</p>
	</header>

	<main>

		<section id="contents" class="contents">
			<h2>Contents</h2>
			<nav>
				<ol>
					<li><a
						href="#about-this-report">About this report</a>
						<ol>
							
							<li><a
								href="#report-parameters">Report parameters</a></li>
						</ol></li>
					<data-th-block>
					<li><a
						href="#summaries">Summaries</a>
						<ol>
							<li><a
								href="#risk-confidence-counts">Alert counts by risk and confidence</a></li>
							<li><a
								href="#site-risk-counts">Alert counts by site and risk</a></li>
							<li><a
								href="#alert-type-counts">Alert counts by alert type</a></li>
						</ol></li>
					<li><a
						href="#alerts">Alerts</a>
						<ol>
							
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-3-confidence-2"><span>Risk</span>=<span
									class="risk-level">High</span>, <span>Confidence</span>=<span
									class="confidence-level">Medium</span> <span>(1)</span></a></li>
							
							
							  
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-2-confidence-2"><span>Risk</span>=<span
									class="risk-level">Medium</span>, <span>Confidence</span>=<span
									class="confidence-level">Medium</span> <span>(69)</span></a></li>
							
							
							  
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-1-confidence-2"><span>Risk</span>=<span
									class="risk-level">Low</span>, <span>Confidence</span>=<span
									class="confidence-level">Medium</span> <span>(111)</span></a></li>
							
							<li><a
								href="#alerts--risk-1-confidence-1"><span>Risk</span>=<span
									class="risk-level">Low</span>, <span>Confidence</span>=<span
									class="confidence-level">Low</span> <span>(3)</span></a></li>
							  
							
							
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-0-confidence-1"><span>Risk</span>=<span
									class="risk-level">Informational</span>, <span>Confidence</span>=<span
									class="confidence-level">Low</span> <span>(14)</span></a></li>
							  
						</ol></li>
					<li><a
						href="#appendix">Appendix</a>
						<ol>
							<li><a
								href="#alert-types">Alert types</a></li>
						</ol></li>
					</data-th-block>
				</ol>
			</nav>
		</section>

		<section
			id="about-this-report" class="about-this-report">
			<h2>About this report</h2>

			

			<section
				id="report-parameters">
				<h3>Report parameters</h3>
				<div class="report-parameters--container">
					<h4>Contexts</h4>
					
					
					<p>No contexts were selected, so all contexts were included by default.</p>
					  

					<h4>Sites</h4>
					
					<p>The following sites were included:</p>
					<ul class="sites-list">
						<li><span class="site">https://google-gruyere.appspot.com</span></li>
						<li><span class="site">http://google-gruyere.appspot.com</span></li>
					</ul>
					
					<p>(If no sites were selected, all sites were included by default.)</p>
					<p>An included site must also be within one of the included contexts for its data to be included in the report.</p>

					<h4>Risk levels</h4>
					<p>
						<span>Included</span>:
						 
						<span class="included-risk-codes"><span class="risk-level">High</span>, <span class="risk-level">Medium</span>, <span class="risk-level">Low</span>, <span class="risk-level">Informational</span></span>
					</p>
					<p>
						<span>Excluded</span>:
						 <span>None</span>
						
					</p>

					<h4>Confidence levels</h4>
					<p>
						<span>Included</span>:
						
						
						<span class="included-confidence-codes"><span class="confidence-level">User Confirmed</span>, <span class="confidence-level">High</span>, <span class="confidence-level">Medium</span>, <span class="confidence-level">Low</span></span>
					</p>
					<p>
						<span>Excluded</span>:
						
						
						<span class="included-confidence-codes"> <span class="confidence-level">User Confirmed</span>, <span class="confidence-level">High</span>, <span class="confidence-level">Medium</span>, <span class="confidence-level">Low</span>, <span class="confidence-level">False Positive</span></span>
					</p>
				</div>
			</section>
		</section>

		
		<section>
			
		</section>
		
		<section id="summaries" class="summaries">
			<h2>Summaries</h2>

			<section
				id="risk-confidence-counts">
				<h3>Alert counts by risk and confidence</h3>
				<table class="risk-confidence-counts-table">
					<caption>
						<p>This table shows the number of alerts for each level of risk and confidence included in the report.</p>
						<p>(The percentages in brackets represent the count as a percentage of the total number of alerts included in the report, rounded to one decimal place.)</p>
					</caption>
					<colgroup>
						<col>
						<col>
					</colgroup>
					<colgroup>
						<col
							style="width: 14.0%"><col
							style="width: 14.0%"><col
							style="width: 14.0%"><col
							style="width: 14.0%">
						<col style="width: 14.0%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="2" rowspan="2"></td>
							<th scope="colgroup"
								colspan="5">Confidence</th>
						</tr>
						<tr>
							<th scope="col">User Confirmed</th>
							<th scope="col">High</th>
							<th scope="col">Medium</th>
							<th scope="col">Low</th>
							<th scope="col">Total</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="rowgroup"
								rowspan="5">Risk</th>
							<th scope="row">High</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(0.5%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>1</span><br> <span class="additional-info-percentages">(0.5%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Medium</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>69</span><br> <span
								class="additional-info-percentages">(34.8%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>69</span><br> <span class="additional-info-percentages">(34.8%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Low</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>111</span><br> <span
								class="additional-info-percentages">(56.1%)</span></td>
							<td><span>3</span><br> <span
								class="additional-info-percentages">(1.5%)</span></td>
							<td><span>114</span><br> <span class="additional-info-percentages">(57.6%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Informational</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>14</span><br> <span
								class="additional-info-percentages">(7.1%)</span></td>
							<td><span>14</span><br> <span class="additional-info-percentages">(7.1%)</span></td>
						</tr>
						<tr>
							<th scope="row">Total</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>181</span><br> <span
								class="additional-info-percentages">(91.4%)</span></td>
							<td><span>17</span><br> <span
								class="additional-info-percentages">(8.6%)</span></td>
							<td><span>198</span><br> <span
								class="additional-info-percentages">(100%)</span></td>
						</tr>
					</tbody>
				</table>
			</section>

			<section
				id="site-risk-counts">
				<h3>Alert counts by site and risk</h3>
				<table class="site-risk-counts-table">
					<caption>
						<p>This table shows, for each site for which one or more alerts were raised, the number of alerts raised at each risk level.</p>
						<p>Alerts with a confidence level of &quot;False Positive&quot; have been excluded from these counts.</p>
						<p>(The numbers in brackets are the number of alerts raised for the site at or above that risk level.)</p>
					</caption>
					<colgroup>
						<col>
						<col>
					</colgroup>
					<colgroup>
						<col
							style="width: 16.25%"><col
							style="width: 16.25%"><col
							style="width: 16.25%"><col
							style="width: 16.25%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="2" rowspan="2"></td>
							<th scope="colgroup" colspan="4">Risk</th>
						</tr>
						<tr>
							<th scope="col">
								<span>High</span><br>  <span
									class="additional-info-percentages">(= High)</span>  
							</th>
							<th scope="col">
								<span>Medium</span><br>   <span
									class="additional-info-percentages">(&gt;= Medium)</span> 
							</th>
							<th scope="col">
								<span>Low</span><br>   <span
									class="additional-info-percentages">(&gt;= Low)</span> 
							</th>
							<th scope="col">
								<span>Informational</span><br>   <span
									class="additional-info-percentages">(&gt;= Informational)</span> 
							</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="rowgroup"
								rowspan="2">Site</th>
							<th scope="row">https://google-gruyere.appspot.com</th>
							
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0)</span></td>
							<td><span>6</span><br> <span
								class="additional-info-percentages">(6)</span></td>
							<td><span>18</span><br> <span
								class="additional-info-percentages">(24)</span></td>
							<td><span>6</span><br> <span
								class="additional-info-percentages">(30)</span></td>
							
						</tr>
						<tr>
							
							<th scope="row">http://google-gruyere.appspot.com</th>
							
							<td><span>1</span><br> <span
								class="additional-info-percentages">(1)</span></td>
							<td><span>63</span><br> <span
								class="additional-info-percentages">(64)</span></td>
							<td><span>96</span><br> <span
								class="additional-info-percentages">(160)</span></td>
							<td><span>8</span><br> <span
								class="additional-info-percentages">(168)</span></td>
							
						</tr>
					</tbody>
				</table>
			</section>

			<section
				id="alert-type-counts">
				<h3>Alert counts by alert type</h3>
				<table class="alert-type-counts-table">
					<caption>
						<p>This table shows the number of alerts of each alert type, together with the alert type&#39;s risk level.</p>
						<p>(The percentages in brackets represent each count as a percentage, rounded to one decimal place, of the total number of alerts included in this report.)</p>
					</caption>
					<thead>
						<tr>
							<th scope="col">Alert type</th>
							<th scope="col">Risk</th>
							<th scope="col">Count</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="row"><a
								href="#alert-type-0">Cross Site Scripting (Reflected)</a></th>
							<td class="risk-level">High</td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(0.5%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-1">X-Frame-Options Header Not Set</a></th>
							<td class="risk-level">Medium</td>
							<td><span>69</span><br> <span
								class="additional-info-percentages">(34.8%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-2">Absence of Anti-CSRF Tokens</a></th>
							<td class="risk-level">Low</td>
							<td><span>7</span><br> <span
								class="additional-info-percentages">(3.5%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-3">Cookie No HttpOnly Flag</a></th>
							<td class="risk-level">Low</td>
							<td><span>5</span><br> <span
								class="additional-info-percentages">(2.5%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-4">Cookie without SameSite Attribute</a></th>
							<td class="risk-level">Low</td>
							<td><span>5</span><br> <span
								class="additional-info-percentages">(2.5%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-5">Incomplete or No Cache-control Header Set</a></th>
							<td class="risk-level">Low</td>
							<td><span>6</span><br> <span
								class="additional-info-percentages">(3.0%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-6">Timestamp Disclosure - Unix</a></th>
							<td class="risk-level">Low</td>
							<td><span>3</span><br> <span
								class="additional-info-percentages">(1.5%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-7">X-Content-Type-Options Header Missing</a></th>
							<td class="risk-level">Low</td>
							<td><span>88</span><br> <span
								class="additional-info-percentages">(44.4%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-8">Charset Mismatch (Header Versus Meta Content-Type Charset)</a></th>
							<td class="risk-level">Informational</td>
							<td><span>12</span><br> <span
								class="additional-info-percentages">(6.1%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-9">Information Disclosure - Suspicious Comments</a></th>
							<td class="risk-level">Informational</td>
							<td><span>2</span><br> <span
								class="additional-info-percentages">(1.0%)</span></td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<th scope="row">Total</th>
							<td></td>
							<td>198</td>
						</tr>
					</tfoot>
				</table>
			</section>
		</section>

		<section id="alerts" class="alerts">
			<h2>Alerts</h2>
			<ol>
				
				 
				
				
				
				
				<li id="alerts--risk-3-confidence-2">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">High</span>, <span>Confidence</span>=<span
							class="confidence-level">Medium</span> <span>(1)</span>
					</h3>
					<ol>
						
						
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://google-gruyere.appspot.com</span> <span>(1)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-0">Cross Site Scripting (Reflected)</a> <span>(1)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=%3C%2Fh2%3E%3CscrIpt%3Ealert%281%29%3B%3C%2FscRipt%3E%3Ch2%3E</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP_2021_A03</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting">WSTG-v42-INPV-01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS).html">OWASP_2017_A07</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>Cross-site Scripting (XSS) is an attack technique that involves echoing attacker-supplied code into a user&#39;s browser instance. A browser instance can be a standard web browser client, or a browser object embedded in a software product such as the browser within WinAmp, an RSS reader, or an email client. The code itself is usually written in HTML/JavaScript, but may also extend to VBScript, ActiveX, Java, Flash, or any other browser-supported technology.</p>

<p>When an attacker gets a user&#39;s browser to execute his/her code, the code will run within the security context (or zone) of the hosting web site. With this level of privilege, the code has the ability to read, modify and transmit any sensitive data accessible by the browser. A Cross-site Scripted user could have his/her account hijacked (cookie theft), their browser redirected to another location, or possibly shown fraudulent content delivered by the web site they are visiting. Cross-site Scripting attacks essentially compromise the trust relationship between a user and the web site. Applications utilizing browser object instances which load content from the file system may execute code under the local machine zone allowing for system compromise.</p>

<p>There are three types of Cross-site Scripting attacks: non-persistent, persistent and DOM-based.</p>

<p>Non-persistent attacks and DOM-based attacks require a user to either visit a specially crafted link laced with malicious code, or visit a malicious web page containing a web form, which when posted to the vulnerable site, will mount the attack. Using a malicious form will oftentimes take place when the vulnerable resource only accepts HTTP POST requests. In such a case, the form can be submitted automatically, without the victim&#39;s knowledge (e.g. by using JavaScript). Upon clicking on the malicious link or submitting the malicious form, the XSS payload will get echoed back and will get interpreted by the user&#39;s browser and execute. Another technique to send almost arbitrary requests (GET and POST) is by using an embedded client, such as Adobe Flash.</p>

<p>Persistent attacks occur when the malicious code is submitted to a web site where it&#39;s stored for a period of time. Examples of an attacker&#39;s favorite targets often include message board posts, web mail messages, and web chat software. The unsuspecting user is not required to interact with any additional site/link (e.g. an attacker site or a malicious link sent via email), just simply view the web page containing the code.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (502 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=%3C%2Fh2%3E%3CscrIpt%3Ealert%281%29%3B%3C%2FscRipt%3E%3Ch2%3E HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272
Content-Length: 0

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: b1391bfa472a209a610af43b8f5aabed
Date: Sun, 15 May 2022 13:22:42 GMT
Server: Google Frontend
Content-Length: 2655

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2655 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  &lt;/h2&gt;&lt;scrIpt&gt;alert(1);&lt;/scRipt&gt;&lt;h2&gt;
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;&lt;/h2&gt;&lt;scrIpt&gt;alert(1);&lt;/scRipt&gt;&lt;h2&gt;&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
    &lt;/h2&gt;&lt;scrIpt&gt;alert(1);&lt;/scRipt&gt;&lt;h2&gt;
    is not an author.
  
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>uid</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Attack</th>
		<td><pre><code>&lt;/h2&gt;&lt;scrIpt&gt;alert(1);&lt;/scRipt&gt;&lt;h2&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;/h2&gt;&lt;scrIpt&gt;alert(1);&lt;/scRipt&gt;&lt;h2&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>Examples of libraries and frameworks that make it easier to generate properly encoded output include Microsoft&#39;s Anti-XSS library, the OWASP ESAPI Encoding module, and Apache Wicket.</p>

<p>Phases: Implementation; Architecture and Design</p>

<p>Understand the context in which your data will be used and the encoding that will be expected. This is especially important when transmitting data between different components, or when generating outputs that can contain multiple encodings at the same time, such as web pages or multi-part mail messages. Study all expected communication protocols and data representations to determine the required encoding strategies.</p>

<p>For any data that will be output to another web page, especially any data that was received from external inputs, use the appropriate encoding on all non-alphanumeric characters.</p>

<p>Consult the XSS Prevention Cheat Sheet for more details on the types of encoding and escaping that are needed.</p>

<p>Phase: Architecture and Design</p>

<p>For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server.</p>

<p>If available, use structured mechanisms that automatically enforce the separation between data and code. These mechanisms may be able to provide the relevant quoting, encoding, and validation automatically, instead of relying on the developer to provide this capability at every point where output is generated.</p>

<p>Phase: Implementation</p>

<p>For every web page that is generated, use and specify a character encoding such as ISO-8859-1 or UTF-8. When an encoding is not specified, the web browser may choose a different encoding by guessing which encoding is actually being used by the web page. This can cause the web browser to treat certain sequences as special, opening up the client to subtle XSS attacks. See CWE-116 for more mitigations related to encoding/escaping.</p>

<p>To help mitigate XSS attacks against the user&#39;s session cookie, set the session cookie to be HttpOnly. In browsers that support the HttpOnly feature (such as more recent versions of Internet Explorer and Firefox), this attribute can prevent the user&#39;s session cookie from being accessible to malicious client-side scripts that use document.cookie. This is not a complete solution, since HttpOnly is not supported by all browsers. More importantly, XMLHTTPRequest and other powerful browser technologies provide read access to HTTP headers, including the Set-Cookie header in which the HttpOnly flag is set.</p>

<p>Assume all input is malicious. Use an &quot;accept known good&quot; input validation strategy, i.e., use an allow list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does. Do not rely exclusively on looking for malicious or malformed inputs (i.e., do not rely on a deny list). However, deny lists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.</p>

<p>When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, &quot;boat&quot; may be syntactically valid because it only contains alphanumeric characters, but it is not valid if you are expecting colors such as &quot;red&quot; or &quot;blue.&quot;</p>

<p>Ensure that you perform input validation at well-defined interfaces within the application. This will help protect the application even if a component is reused or moved elsewhere.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				
				
				  
				 
				
				
				
				
				<li id="alerts--risk-2-confidence-2">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">Medium</span>, <span>Confidence</span>=<span
							class="confidence-level">Medium</span> <span>(69)</span>
					</h3>
					<ol>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">https://google-gruyere.appspot.com</span> <span>(6)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-1">X-Frame-Options Header Not Set</a> <span>(6)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (331 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 33537749b2028b9bf13c22aa26ba5f2c
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 11506
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 68642faca77c3cd21d49dee4da457602
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 13686
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 29322522d1b968a3e70b385ad2b8830b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 37564
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e436405686e8a47d09262828f9fddc8
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 29253
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1e89a569badcde4c8a34bb748c9e52ab
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 24149
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e1de65e8de11ab80b5e5f9f018599f64
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 25303
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://google-gruyere.appspot.com</span> <span>(63)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-1">X-Frame-Options Header Not Set</a> <span>(63)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (326 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/0
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 53e16cb763327c4aeefb0327df227823
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 11506

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/0</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/0 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 2bf866ff90342d65770070d5a4eb9ddd
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 6a4e66c74416cfe7c9528ad85fd5281e
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 668f64f9674f1dbde503682e8d232584
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 0341d764bf5b70e56645f9647cce4716
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 8961ddfca96219f3bec32c8932505eeb
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (260 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 9d6b02680aa0dbd5b771773c9522f5f6
Date: Sun, 15 May 2022 13:19:54 GMT
Server: Google Frontend
Content-Length: 3484

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (470 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 70e7ced65dacb53c46f9e0842534c6aa
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3921

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3921 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Profile&lt;/h2&gt;
&lt;/div&gt;

&lt;div class=&#39;content&#39;&gt;


  &lt;h3&gt;Edit your profile.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;update&#39;&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;td&gt;
    User id:
  &lt;/td&gt;&lt;td&gt;


  
    ZAP
  
  

  &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;ZAP&#39;
      name=&#39;name&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    OLD Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;oldpw&#39;&gt;
  &lt;/td&gt;&lt;td&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    NEW Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Icon:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      value=&#39;&#39;
      name=&#39;icon&#39;&gt;
    (32x32 image, URL to image location)
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Homepage:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; size=&#39;50&#39;
      value=&#39;&#39;
      name=&#39;web_site&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Profile Color:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      name=&#39;color&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Private Snippet:
  &lt;/td&gt;&lt;td&gt;
    &lt;textarea name=&#39;private_snippet&#39; rows=&#39;10&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;left&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Update&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: e3793f9f6caa9b67d4002560e4ee444a
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: dd487feea4901d73f1fdcf2a14bf1c0b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 3841
Expires: Sun, 15 May 2022 13:19:59 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3841 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (461 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (358 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: 124dddb8eb00011c2d0006596fec2e05
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 3484
Expires: Sun, 15 May 2022 13:20:02 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;





  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 184dff1f0053e9050e8c7e5812c1986f
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (469 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 4de0db8f7c0a480fd6330de37dbf7b80
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3076

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3076 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: New Snippet&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: New Snippet&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Add a new snippet.&lt;/h3&gt;



&lt;div style=&#39;width:600&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/newsnippet2&#39;&gt;
&lt;textarea name=&#39;snippet&#39; rows=&#39;5&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;br&gt;
&lt;table summary=&#39;&#39; style=&#39;width:100%&#39;&gt;
&lt;tr&gt;
&lt;td align=&#39;left&#39; valign=&#39;top&#39;&gt;
  &lt;i&gt;Limited HTML is now supported in snippets (e.g., &amp;lt;b&amp;gt;, &amp;lt;i&amp;gt;,
  etc.)!&lt;/i&gt;
&lt;/td&gt;
&lt;td align=&#39;right&#39; valign=&#39;top&#39;&gt;
  &lt;input type=&#39;submit&#39; value=&#39;Submit&#39;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 6bed895368159adc47a6df092a41df8b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 2228

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2228 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;User already exists.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=update&amp;color=%23ffffff&amp;icon=ZAP&amp;name=ZAP&amp;oldpw=ZAP&amp;private_snippet&amp;pw=ZAP&amp;web_site=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (535 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=update&amp;color=%23ffffff&amp;icon=ZAP&amp;name=ZAP&amp;oldpw=ZAP&amp;private_snippet&amp;pw=ZAP&amp;web_site=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl
Cookie: GRUYERE=; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 2840796b2b5d70497cf8ae6f1af24a19
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2228

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2228 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;User does not exist.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (467 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: febb86a8a988547400791fa0cb7dcd19
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 2960

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2960 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;


  My Snippets
  

&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;ZAP&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;




  
  
    
      No snippets.
    
    
  
  &lt;br&gt;
  &lt;a href=&#39;&#39;&gt;My site&lt;/a&gt;

&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=brie</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (426 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=brie HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: f270e52f74d08d8c475ecd2166585299
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 3059

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3059 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Brie
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;brie&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Brie&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (429 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 8910dace3bdd82f472971b16b4d0a902
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 3379

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Cheddar Mac
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;cheddar&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Gruyere is the cheesiest application on the web.
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(1 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;1&#39;&gt;
                I wonder if there are any security holes in this....
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Cheddar Mac&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (465 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 1cce769952da3342423c11528e88b66f
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 2930

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2930 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Upload&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Upload&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Select a file to upload to your account.&lt;/h3&gt;



&lt;div&gt;
&lt;form method=&#39;post&#39; enctype=&#39;multipart/form-data&#39; action=&#39;/425450881661954264328804432207969818728/upload2&#39;&gt;
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;
    &lt;input type=&#39;file&#39; name=&#39;upload_file&#39; size=&#39;50&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td align=&#39;center&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Upload&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e6ba2671e3bd4292a66de4ae2c337c7c
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (404 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 579c4b7c507aad673b70d834e309beac
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 3480

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3480 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;


  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: ba1fc60270053cca97a7e64e9599e081
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: cb805a8a9a771a6bd9832957669cc3a8
Date: Sun, 15 May 2022 13:20:06 GMT
Server: Google Frontend
Content-Length: 3839
Expires: Sun, 15 May 2022 13:20:06 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3839 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;



  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: d0514363ce7ebcfc496a81ce54a0b1c8
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: 51f9d1fd2e5c757a866155237d8d93ca
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2224
Expires: Sun, 15 May 2022 13:20:05 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2224 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;Account created.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=brie</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (426 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=brie HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: fee6d2c9dcd1d00daf4eb9e7d5df01bd
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3059

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3059 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Brie
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;582835734666354056417651491707595504272&quot;, &quot;brie&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Brie&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (429 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 5da7bb07707f883e8667ad3da9cc7f67
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3379

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Cheddar Mac
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;582835734666354056417651491707595504272&quot;, &quot;cheddar&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Gruyere is the cheesiest application on the web.
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(1 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;1&#39;&gt;
                I wonder if there are any security holes in this....
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Cheddar Mac&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/6</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/6 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 344d428643f4da8fbbfd1aff1d12c412
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/7</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/7 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 4e6c5c14e438dcb6759f7d5dd3ada038
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/8</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/8 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: b9a6b6375628b625c1250fb6dd228185
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/9</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/9 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 36c6d74188873d46a7ce354a667b0015
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (335 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: ee2ca9212cb00a61114efb77fd34ba5c
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 354

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (354 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?data.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (343 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?data.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 88e89f3d74451368d5985974f107937f
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 367

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (367 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/data.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?gruyere.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?gruyere.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 0de4019c659d2662b808ecda2edb789a
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 370

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (370 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/gruyere.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?gtl.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (342 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?gtl.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 571e688fd2591dc2e9ce05e05d9fad8f
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 366

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (366 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/gtl.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resoources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (355 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resoources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 641b14c9d119e8ea3a771894b86123a3
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 354

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (354 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 16b791a2a5db25d5f428137c25114629
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/dump.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (361 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part3
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: f874a2c05d2324078816943e1489f4b9
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 385

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (385 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/editprofile.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/error.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (355 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/error.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part2
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1804803b8c13c237d5e462abbcf28443
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 379

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/error.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/feed.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/feed.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e08b20152c79be9d31f1a6bf7039e34
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/feed.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/home.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/home.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part2
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 8af31490b4264dcebe22d8c8dedab3f9
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/home.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/manage.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (356 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/manage.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part4
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 30344ae22ab4f6720974b03b8bfdab14
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 380

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (380 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/manage.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/menubar.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (357 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/menubar.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part4
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 56ca62732f6b18323ea608b5bcc467e3
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 381

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (381 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/menubar.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?sanitize.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (347 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?sanitize.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: d26b19d1534070ac9ff43354a211cfe6
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 371

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (371 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/sanitize.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/data.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (350 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/data.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?data.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: d4831cd113a2da5270f73f7dc8fc3bea
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 4190

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (4190 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;data.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere - Default data for Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import copy
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;DEFAULT_DATA = {
&lt;SMALL&gt; 25  &lt;/SMALL&gt;    &#39;administrator&#39;: {
&lt;SMALL&gt; 26  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Admin&#39;,
&lt;SMALL&gt; 27  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;secret&#39;,
&lt;SMALL&gt; 28  &lt;/SMALL&gt;        &#39;is_author&#39;: False,
&lt;SMALL&gt; 29  &lt;/SMALL&gt;        &#39;is_admin&#39;: True,
&lt;SMALL&gt; 30  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;My password is secret. Get it?&#39;,
&lt;SMALL&gt; 31  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://www.google.com/contact/&#39;,
&lt;SMALL&gt; 32  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 33  &lt;/SMALL&gt;    &#39;cheddar&#39;: {
&lt;SMALL&gt; 34  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Cheddar Mac&#39;,
&lt;SMALL&gt; 35  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;orange&#39;,
&lt;SMALL&gt; 36  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 37  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 38  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;My SSN is &amp;lt;a href=&quot;https://www.google.com/&#39; +
&lt;SMALL&gt; 39  &lt;/SMALL&gt;                           &#39;search?q=078-05-1120&quot;&amp;gt;078-05-1120&amp;lt;/a&amp;gt;.&#39;,
&lt;SMALL&gt; 40  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://images.google.com/?q=cheddar+cheese&#39;,
&lt;SMALL&gt; 41  &lt;/SMALL&gt;        &#39;color&#39;: &#39;blue&#39;,
&lt;SMALL&gt; 42  &lt;/SMALL&gt;        &#39;snippets&#39;: [
&lt;SMALL&gt; 43  &lt;/SMALL&gt;            &#39;Gruyere is the cheesiest application on the web.&#39;,
&lt;SMALL&gt; 44  &lt;/SMALL&gt;            &#39;I wonder if there are any security holes in this....&#39;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;        ],
&lt;SMALL&gt; 46  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 47  &lt;/SMALL&gt;    &#39;sardo&#39;: {
&lt;SMALL&gt; 48  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Miss Sardo&#39;,
&lt;SMALL&gt; 49  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;odras&#39;,
&lt;SMALL&gt; 50  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 51  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 52  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;I hate my brother Romano.&#39;,
&lt;SMALL&gt; 53  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://www.google.com/search?q=&quot;pecorino+sardo&quot;&#39;,
&lt;SMALL&gt; 54  &lt;/SMALL&gt;        &#39;color&#39;: &#39;red&#39;,
&lt;SMALL&gt; 55  &lt;/SMALL&gt;        &#39;snippets&#39;: [],
&lt;SMALL&gt; 56  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 57  &lt;/SMALL&gt;    &#39;brie&#39;: {
&lt;SMALL&gt; 58  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Brie&#39;,
&lt;SMALL&gt; 59  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;briebrie&#39;,
&lt;SMALL&gt; 60  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 61  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 62  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;I use the same password for all my accounts.&#39;,
&lt;SMALL&gt; 63  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://news.google.com/news/search?q=brie&#39;,
&lt;SMALL&gt; 64  &lt;/SMALL&gt;        &#39;color&#39;: &#39;red; text-decoration:underline&#39;,
&lt;SMALL&gt; 65  &lt;/SMALL&gt;        &#39;snippets&#39;: [
&lt;SMALL&gt; 66  &lt;/SMALL&gt;            &#39;Brie is the queen of the cheeses&amp;lt;span style=color:red&amp;gt;!!!&amp;lt;/span&amp;gt;&#39;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;        ],
&lt;SMALL&gt; 68  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 69  &lt;/SMALL&gt;}
&lt;SMALL&gt; 70  &lt;/SMALL&gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;def DefaultData():
&lt;SMALL&gt; 73  &lt;/SMALL&gt;  &quot;&quot;&quot;Provides default data for Gruyere.&quot;&quot;&quot;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  return copy.deepcopy(DEFAULT_DATA)
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/gruyere.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (356 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/gruyere.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?gruyere.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: c13940c77049c813278bdd40366ee9d2
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 45208

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (45208 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;gruyere.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;#!/usr/bin/env python2.7
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere - a web application with holes.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  6  &lt;/SMALL&gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;This code is licensed under the
&lt;SMALL&gt;  8  &lt;/SMALL&gt;https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  9  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt; 10  &lt;/SMALL&gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt; 12  &lt;/SMALL&gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 14  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 15  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 16  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 17  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 18  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 19  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 20  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 25  &lt;/SMALL&gt;from BaseHTTPServer import BaseHTTPRequestHandler
&lt;SMALL&gt; 26  &lt;/SMALL&gt;from BaseHTTPServer import HTTPServer
&lt;SMALL&gt; 27  &lt;/SMALL&gt;import cgi
&lt;SMALL&gt; 28  &lt;/SMALL&gt;import cPickle
&lt;SMALL&gt; 29  &lt;/SMALL&gt;import os
&lt;SMALL&gt; 30  &lt;/SMALL&gt;import random
&lt;SMALL&gt; 31  &lt;/SMALL&gt;import sys
&lt;SMALL&gt; 32  &lt;/SMALL&gt;import threading
&lt;SMALL&gt; 33  &lt;/SMALL&gt;import urllib
&lt;SMALL&gt; 34  &lt;/SMALL&gt;from urlparse import urlparse
&lt;SMALL&gt; 35  &lt;/SMALL&gt;
&lt;SMALL&gt; 36  &lt;/SMALL&gt;try:
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  sys.dont_write_bytecode = True
&lt;SMALL&gt; 38  &lt;/SMALL&gt;except AttributeError:
&lt;SMALL&gt; 39  &lt;/SMALL&gt;  pass
&lt;SMALL&gt; 40  &lt;/SMALL&gt;
&lt;SMALL&gt; 41  &lt;/SMALL&gt;# our modules
&lt;SMALL&gt; 42  &lt;/SMALL&gt;import data
&lt;SMALL&gt; 43  &lt;/SMALL&gt;import gtl
&lt;SMALL&gt; 44  &lt;/SMALL&gt;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;DB_FILE = &#39;/stored-data.txt&#39;
&lt;SMALL&gt; 47  &lt;/SMALL&gt;SECRET_FILE = &#39;/secret.txt&#39;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;
&lt;SMALL&gt; 49  &lt;/SMALL&gt;INSTALL_PATH = &#39;.&#39;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;RESOURCE_PATH = &#39;resources&#39;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;SPECIAL_COOKIE = &#39;_cookie&#39;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;SPECIAL_PROFILE = &#39;_profile&#39;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;SPECIAL_DB = &#39;_db&#39;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;SPECIAL_PARAMS = &#39;_params&#39;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;SPECIAL_UNIQUE_ID = &#39;_unique_id&#39;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;COOKIE_UID = &#39;uid&#39;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;COOKIE_ADMIN = &#39;is_admin&#39;
&lt;SMALL&gt; 60  &lt;/SMALL&gt;COOKIE_AUTHOR = &#39;is_author&#39;
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;# Set to True to cause the server to exit after processing the current url.
&lt;SMALL&gt; 64  &lt;/SMALL&gt;quit_server = False
&lt;SMALL&gt; 65  &lt;/SMALL&gt;
&lt;SMALL&gt; 66  &lt;/SMALL&gt;# A global copy of the database so that _GetDatabase can access it.
&lt;SMALL&gt; 67  &lt;/SMALL&gt;stored_data = None
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;# The HTTPServer object.
&lt;SMALL&gt; 70  &lt;/SMALL&gt;http_server = None
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;# A secret value used to generate hashes to protect cookies from tampering.
&lt;SMALL&gt; 73  &lt;/SMALL&gt;cookie_secret = &#39;&#39;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;# File extensions of resource files that we recognize.
&lt;SMALL&gt; 76  &lt;/SMALL&gt;RESOURCE_CONTENT_TYPES = {
&lt;SMALL&gt; 77  &lt;/SMALL&gt;    &#39;.css&#39;: &#39;text/css&#39;,
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    &#39;.gif&#39;: &#39;image/gif&#39;,
&lt;SMALL&gt; 79  &lt;/SMALL&gt;    &#39;.htm&#39;: &#39;text/html&#39;,
&lt;SMALL&gt; 80  &lt;/SMALL&gt;    &#39;.html&#39;: &#39;text/html&#39;,
&lt;SMALL&gt; 81  &lt;/SMALL&gt;    &#39;.js&#39;: &#39;application/javascript&#39;,
&lt;SMALL&gt; 82  &lt;/SMALL&gt;    &#39;.jpeg&#39;: &#39;image/jpeg&#39;,
&lt;SMALL&gt; 83  &lt;/SMALL&gt;    &#39;.jpg&#39;: &#39;image/jpeg&#39;,
&lt;SMALL&gt; 84  &lt;/SMALL&gt;    &#39;.png&#39;: &#39;image/png&#39;,
&lt;SMALL&gt; 85  &lt;/SMALL&gt;    &#39;.ico&#39;: &#39;image/x-icon&#39;,
&lt;SMALL&gt; 86  &lt;/SMALL&gt;    &#39;.text&#39;: &#39;text/plain&#39;,
&lt;SMALL&gt; 87  &lt;/SMALL&gt;    &#39;.txt&#39;: &#39;text/plain&#39;,
&lt;SMALL&gt; 88  &lt;/SMALL&gt;}
&lt;SMALL&gt; 89  &lt;/SMALL&gt;
&lt;SMALL&gt; 90  &lt;/SMALL&gt;
&lt;SMALL&gt; 91  &lt;/SMALL&gt;def main():
&lt;SMALL&gt; 92  &lt;/SMALL&gt;  _SetWorkingDirectory()
&lt;SMALL&gt; 93  &lt;/SMALL&gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;  global quit_server
&lt;SMALL&gt; 95  &lt;/SMALL&gt;  quit_server = False
&lt;SMALL&gt; 96  &lt;/SMALL&gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;  # Normally, Gruyere only accepts connections to/from localhost. If you
&lt;SMALL&gt; 98  &lt;/SMALL&gt;  # would like to allow access from other ip addresses, you can change to
&lt;SMALL&gt; 99  &lt;/SMALL&gt;  # operate in a less secure mode. Set insecure_mode to True to serve on the
&lt;SMALL&gt;100  &lt;/SMALL&gt;  # hostname instead of localhost and add the addresses of the other machines
&lt;SMALL&gt;101  &lt;/SMALL&gt;  # to allowed_ips below.
&lt;SMALL&gt;102  &lt;/SMALL&gt;
&lt;SMALL&gt;103  &lt;/SMALL&gt;  insecure_mode = False
&lt;SMALL&gt;104  &lt;/SMALL&gt;
&lt;SMALL&gt;105  &lt;/SMALL&gt;  # WARNING! DO NOT CHANGE THE FOLLOWING SECTION OF CODE!
&lt;SMALL&gt;106  &lt;/SMALL&gt;
&lt;SMALL&gt;107  &lt;/SMALL&gt;  # This application is very exploitable. It takes several precautions to
&lt;SMALL&gt;108  &lt;/SMALL&gt;  # limit the risk from a real attacker:
&lt;SMALL&gt;109  &lt;/SMALL&gt;  #   (1) Serve requests on localhost so that it will not be accessible
&lt;SMALL&gt;110  &lt;/SMALL&gt;  # from other machines.
&lt;SMALL&gt;111  &lt;/SMALL&gt;  #   (2) If a request is received from any IP other than localhost, quit.
&lt;SMALL&gt;112  &lt;/SMALL&gt;  # (This protection is implemented in do_GET/do_POST.)
&lt;SMALL&gt;113  &lt;/SMALL&gt;  #   (3) Inject a random identifier as the first part of the path and
&lt;SMALL&gt;114  &lt;/SMALL&gt;  # quit if a request is received without this identifier (except for an
&lt;SMALL&gt;115  &lt;/SMALL&gt;  # empty path which redirects and /favicon.ico).
&lt;SMALL&gt;116  &lt;/SMALL&gt;  #   (4) Automatically exit after 2 hours (7200 seconds) to mitigate against
&lt;SMALL&gt;117  &lt;/SMALL&gt;  # accidentally leaving the server running.
&lt;SMALL&gt;118  &lt;/SMALL&gt;
&lt;SMALL&gt;119  &lt;/SMALL&gt;  quit_timer = threading.Timer(7200, lambda: _Exit(&#39;Timeout&#39;))   # DO NOT CHANGE
&lt;SMALL&gt;120  &lt;/SMALL&gt;  quit_timer.start()                                             # DO NOT CHANGE
&lt;SMALL&gt;121  &lt;/SMALL&gt;
&lt;SMALL&gt;122  &lt;/SMALL&gt;  if insecure_mode:                                              # DO NOT CHANGE
&lt;SMALL&gt;123  &lt;/SMALL&gt;    server_name = os.popen(&#39;hostname&#39;).read().replace(&#39;\n&#39;, &#39;&#39;)  # DO NOT CHANGE
&lt;SMALL&gt;124  &lt;/SMALL&gt;  else:                                                          # DO NOT CHANGE
&lt;SMALL&gt;125  &lt;/SMALL&gt;    server_name = &#39;127.0.0.1&#39;                                    # DO NOT CHANGE
&lt;SMALL&gt;126  &lt;/SMALL&gt;  server_port = 8008                                             # DO NOT CHANGE
&lt;SMALL&gt;127  &lt;/SMALL&gt;
&lt;SMALL&gt;128  &lt;/SMALL&gt;  # The unique id is created from a CSPRNG.
&lt;SMALL&gt;129  &lt;/SMALL&gt;  try:                                                           # DO NOT CHANGE
&lt;SMALL&gt;130  &lt;/SMALL&gt;    r = random.SystemRandom()                                    # DO NOT CHANGE
&lt;SMALL&gt;131  &lt;/SMALL&gt;  except NotImplementedError:                                    # DO NOT CHANGE
&lt;SMALL&gt;132  &lt;/SMALL&gt;    _Exit(&#39;Could not obtain a CSPRNG source&#39;)                    # DO NOT CHANGE
&lt;SMALL&gt;133  &lt;/SMALL&gt;
&lt;SMALL&gt;134  &lt;/SMALL&gt;  global server_unique_id                                        # DO NOT CHANGE
&lt;SMALL&gt;135  &lt;/SMALL&gt;  server_unique_id = str(r.randint(2**128, 2**(128+1)))          # DO NOT CHANGE
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;SMALL&gt;137  &lt;/SMALL&gt;  # END WARNING!
&lt;SMALL&gt;138  &lt;/SMALL&gt;
&lt;SMALL&gt;139  &lt;/SMALL&gt;  global http_server
&lt;SMALL&gt;140  &lt;/SMALL&gt;  http_server = HTTPServer((server_name, server_port),
&lt;SMALL&gt;141  &lt;/SMALL&gt;                           GruyereRequestHandler)
&lt;SMALL&gt;142  &lt;/SMALL&gt;
&lt;SMALL&gt;143  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;&#39;&#39;
&lt;SMALL&gt;144  &lt;/SMALL&gt;      Gruyere started...
&lt;SMALL&gt;145  &lt;/SMALL&gt;          http://%s:%d/
&lt;SMALL&gt;146  &lt;/SMALL&gt;          http://%s:%d/%s/&#39;&#39;&#39; % (
&lt;SMALL&gt;147  &lt;/SMALL&gt;              server_name, server_port, server_name, server_port,
&lt;SMALL&gt;148  &lt;/SMALL&gt;              server_unique_id)
&lt;SMALL&gt;149  &lt;/SMALL&gt;
&lt;SMALL&gt;150  &lt;/SMALL&gt;  global stored_data
&lt;SMALL&gt;151  &lt;/SMALL&gt;  stored_data = _LoadDatabase()
&lt;SMALL&gt;152  &lt;/SMALL&gt;
&lt;SMALL&gt;153  &lt;/SMALL&gt;  while not quit_server:
&lt;SMALL&gt;154  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;155  &lt;/SMALL&gt;      http_server.handle_request()
&lt;SMALL&gt;156  &lt;/SMALL&gt;      _SaveDatabase(stored_data)
&lt;SMALL&gt;157  &lt;/SMALL&gt;    except KeyboardInterrupt:
&lt;SMALL&gt;158  &lt;/SMALL&gt;      print &amp;gt;&amp;gt;sys.stderr, &#39;\nReceived KeyboardInterrupt&#39;
&lt;SMALL&gt;159  &lt;/SMALL&gt;      quit_server = True
&lt;SMALL&gt;160  &lt;/SMALL&gt;
&lt;SMALL&gt;161  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;\nClosing&#39;
&lt;SMALL&gt;162  &lt;/SMALL&gt;  http_server.socket.close()
&lt;SMALL&gt;163  &lt;/SMALL&gt;  _Exit(&#39;quit_server&#39;)
&lt;SMALL&gt;164  &lt;/SMALL&gt;
&lt;SMALL&gt;165  &lt;/SMALL&gt;
&lt;SMALL&gt;166  &lt;/SMALL&gt;def _Exit(reason):
&lt;SMALL&gt;167  &lt;/SMALL&gt;  # use os._exit instead of sys.exit because this can&#39;t be trapped
&lt;SMALL&gt;168  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;\nExit: &#39; + reason
&lt;SMALL&gt;169  &lt;/SMALL&gt;  os._exit(0)
&lt;SMALL&gt;170  &lt;/SMALL&gt;
&lt;SMALL&gt;171  &lt;/SMALL&gt;
&lt;SMALL&gt;172  &lt;/SMALL&gt;def _SetWorkingDirectory():
&lt;SMALL&gt;173  &lt;/SMALL&gt;  &quot;&quot;&quot;Set the working directory to the directory containing this file.&quot;&quot;&quot;
&lt;SMALL&gt;174  &lt;/SMALL&gt;  if sys.path[0]:
&lt;SMALL&gt;175  &lt;/SMALL&gt;    os.chdir(sys.path[0])
&lt;SMALL&gt;176  &lt;/SMALL&gt;
&lt;SMALL&gt;177  &lt;/SMALL&gt;
&lt;SMALL&gt;178  &lt;/SMALL&gt;def _LoadDatabase():
&lt;SMALL&gt;179  &lt;/SMALL&gt;  &quot;&quot;&quot;Load the database from stored-data.txt.
&lt;SMALL&gt;180  &lt;/SMALL&gt;
&lt;SMALL&gt;181  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;182  &lt;/SMALL&gt;    The loaded database.
&lt;SMALL&gt;183  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;184  &lt;/SMALL&gt;
&lt;SMALL&gt;185  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;186  &lt;/SMALL&gt;    f = _Open(INSTALL_PATH, DB_FILE)
&lt;SMALL&gt;187  &lt;/SMALL&gt;    stored_data = cPickle.load(f)
&lt;SMALL&gt;188  &lt;/SMALL&gt;    f.close()
&lt;SMALL&gt;189  &lt;/SMALL&gt;  except (IOError, ValueError):
&lt;SMALL&gt;190  &lt;/SMALL&gt;    _Log(&#39;Couldn\&#39;t load data; expected the first time Gruyere is run&#39;)
&lt;SMALL&gt;191  &lt;/SMALL&gt;    stored_data = None
&lt;SMALL&gt;192  &lt;/SMALL&gt;
&lt;SMALL&gt;193  &lt;/SMALL&gt;  f = _Open(INSTALL_PATH, SECRET_FILE)
&lt;SMALL&gt;194  &lt;/SMALL&gt;  global cookie_secret
&lt;SMALL&gt;195  &lt;/SMALL&gt;  cookie_secret = f.readline()
&lt;SMALL&gt;196  &lt;/SMALL&gt;  f.close()
&lt;SMALL&gt;197  &lt;/SMALL&gt;
&lt;SMALL&gt;198  &lt;/SMALL&gt;  return stored_data
&lt;SMALL&gt;199  &lt;/SMALL&gt;
&lt;SMALL&gt;200  &lt;/SMALL&gt;
&lt;SMALL&gt;201  &lt;/SMALL&gt;def _SaveDatabase(save_database):
&lt;SMALL&gt;202  &lt;/SMALL&gt;  &quot;&quot;&quot;Save the database to stored-data.txt.
&lt;SMALL&gt;203  &lt;/SMALL&gt;
&lt;SMALL&gt;204  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;205  &lt;/SMALL&gt;    save_database: the database to save.
&lt;SMALL&gt;206  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;207  &lt;/SMALL&gt;
&lt;SMALL&gt;208  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;209  &lt;/SMALL&gt;    f = _Open(INSTALL_PATH, DB_FILE, &#39;w&#39;)
&lt;SMALL&gt;210  &lt;/SMALL&gt;    cPickle.dump(save_database, f)
&lt;SMALL&gt;211  &lt;/SMALL&gt;    f.close()
&lt;SMALL&gt;212  &lt;/SMALL&gt;  except IOError:
&lt;SMALL&gt;213  &lt;/SMALL&gt;    _Log(&#39;Couldn\&#39;t save data&#39;)
&lt;SMALL&gt;214  &lt;/SMALL&gt;
&lt;SMALL&gt;215  &lt;/SMALL&gt;
&lt;SMALL&gt;216  &lt;/SMALL&gt;def _Open(location, filename, mode=&#39;rb&#39;):
&lt;SMALL&gt;217  &lt;/SMALL&gt;  &quot;&quot;&quot;Open a file from a specific location.
&lt;SMALL&gt;218  &lt;/SMALL&gt;
&lt;SMALL&gt;219  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;220  &lt;/SMALL&gt;    location: The directory containing the file.
&lt;SMALL&gt;221  &lt;/SMALL&gt;    filename: The name of the file.
&lt;SMALL&gt;222  &lt;/SMALL&gt;    mode: File mode for open().
&lt;SMALL&gt;223  &lt;/SMALL&gt;
&lt;SMALL&gt;224  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;225  &lt;/SMALL&gt;    A file object.
&lt;SMALL&gt;226  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;227  &lt;/SMALL&gt;  return open(location + filename, mode)
&lt;SMALL&gt;228  &lt;/SMALL&gt;
&lt;SMALL&gt;229  &lt;/SMALL&gt;
&lt;SMALL&gt;230  &lt;/SMALL&gt;class GruyereRequestHandler(BaseHTTPRequestHandler):
&lt;SMALL&gt;231  &lt;/SMALL&gt;  &quot;&quot;&quot;Handle a http request.&quot;&quot;&quot;
&lt;SMALL&gt;232  &lt;/SMALL&gt;
&lt;SMALL&gt;233  &lt;/SMALL&gt;  # An empty cookie
&lt;SMALL&gt;234  &lt;/SMALL&gt;  NULL_COOKIE = {COOKIE_UID: None, COOKIE_ADMIN: False, COOKIE_AUTHOR: False}
&lt;SMALL&gt;235  &lt;/SMALL&gt;
&lt;SMALL&gt;236  &lt;/SMALL&gt;  # Urls that can only be accessed by administrators.
&lt;SMALL&gt;237  &lt;/SMALL&gt;  _PROTECTED_URLS = [
&lt;SMALL&gt;238  &lt;/SMALL&gt;      &#39;/quit&#39;,
&lt;SMALL&gt;239  &lt;/SMALL&gt;      &#39;/reset&#39;
&lt;SMALL&gt;240  &lt;/SMALL&gt;  ]
&lt;SMALL&gt;241  &lt;/SMALL&gt;
&lt;SMALL&gt;242  &lt;/SMALL&gt;  def _GetDatabase(self):
&lt;SMALL&gt;243  &lt;/SMALL&gt;    &quot;&quot;&quot;Gets the database.&quot;&quot;&quot;
&lt;SMALL&gt;244  &lt;/SMALL&gt;    global stored_data
&lt;SMALL&gt;245  &lt;/SMALL&gt;    if not stored_data:
&lt;SMALL&gt;246  &lt;/SMALL&gt;      stored_data = data.DefaultData()
&lt;SMALL&gt;247  &lt;/SMALL&gt;    return stored_data
&lt;SMALL&gt;248  &lt;/SMALL&gt;
&lt;SMALL&gt;249  &lt;/SMALL&gt;  def _ResetDatabase(self):
&lt;SMALL&gt;250  &lt;/SMALL&gt;    &quot;&quot;&quot;Reset the database.&quot;&quot;&quot;
&lt;SMALL&gt;251  &lt;/SMALL&gt;    # global stored_data
&lt;SMALL&gt;252  &lt;/SMALL&gt;    stored_data = data.DefaultData()
&lt;SMALL&gt;253  &lt;/SMALL&gt;
&lt;SMALL&gt;254  &lt;/SMALL&gt;  def _DoLogin(self, cookie, specials, params):
&lt;SMALL&gt;255  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /login url: validates the user and creates a cookie.
&lt;SMALL&gt;256  &lt;/SMALL&gt;
&lt;SMALL&gt;257  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;258  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;259  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;260  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;261  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;262  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;263  &lt;/SMALL&gt;    message = &#39;&#39;
&lt;SMALL&gt;264  &lt;/SMALL&gt;    if &#39;uid&#39; in params and &#39;pw&#39; in params:
&lt;SMALL&gt;265  &lt;/SMALL&gt;      uid = self._GetParameter(params, &#39;uid&#39;)
&lt;SMALL&gt;266  &lt;/SMALL&gt;      if uid in database:
&lt;SMALL&gt;267  &lt;/SMALL&gt;        if database[uid][&#39;pw&#39;] == self._GetParameter(params, &#39;pw&#39;):
&lt;SMALL&gt;268  &lt;/SMALL&gt;          (cookie, new_cookie_text) = (
&lt;SMALL&gt;269  &lt;/SMALL&gt;              self._CreateCookie(&#39;GRUYERE&#39;, uid))
&lt;SMALL&gt;270  &lt;/SMALL&gt;          self._DoHome(cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;271  &lt;/SMALL&gt;          return
&lt;SMALL&gt;272  &lt;/SMALL&gt;      message = &#39;Invalid user name or password.&#39;
&lt;SMALL&gt;273  &lt;/SMALL&gt;    # not logged in
&lt;SMALL&gt;274  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;275  &lt;/SMALL&gt;    self._SendTemplateResponse(&#39;/login.gtl&#39;, specials, params)
&lt;SMALL&gt;276  &lt;/SMALL&gt;
&lt;SMALL&gt;277  &lt;/SMALL&gt;  def _DoLogout(self, cookie, specials, params):
&lt;SMALL&gt;278  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /logout url: clears the cookie.
&lt;SMALL&gt;279  &lt;/SMALL&gt;
&lt;SMALL&gt;280  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;281  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;282  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;283  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;284  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;285  &lt;/SMALL&gt;    (cookie, new_cookie_text) = (
&lt;SMALL&gt;286  &lt;/SMALL&gt;        self._CreateCookie(&#39;GRUYERE&#39;, None))
&lt;SMALL&gt;287  &lt;/SMALL&gt;    self._DoHome(cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;288  &lt;/SMALL&gt;
&lt;SMALL&gt;289  &lt;/SMALL&gt;  def _Do(self, cookie, specials, params):
&lt;SMALL&gt;290  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the home page (http://localhost/).
&lt;SMALL&gt;291  &lt;/SMALL&gt;
&lt;SMALL&gt;292  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;293  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;294  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;295  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;296  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;297  &lt;/SMALL&gt;    self._DoHome(cookie, specials, params)
&lt;SMALL&gt;298  &lt;/SMALL&gt;
&lt;SMALL&gt;299  &lt;/SMALL&gt;  def _DoHome(self, cookie, specials, params, new_cookie_text=None):
&lt;SMALL&gt;300  &lt;/SMALL&gt;    &quot;&quot;&quot;Renders the home page.
&lt;SMALL&gt;301  &lt;/SMALL&gt;
&lt;SMALL&gt;302  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;303  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;304  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;305  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;306  &lt;/SMALL&gt;      new_cookie_text: New cookie.
&lt;SMALL&gt;307  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;308  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;309  &lt;/SMALL&gt;    specials[SPECIAL_COOKIE] = cookie
&lt;SMALL&gt;310  &lt;/SMALL&gt;    if cookie and cookie.get(COOKIE_UID):
&lt;SMALL&gt;311  &lt;/SMALL&gt;      specials[SPECIAL_PROFILE] = database.get(cookie[COOKIE_UID])
&lt;SMALL&gt;312  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;313  &lt;/SMALL&gt;      specials.pop(SPECIAL_PROFILE, None)
&lt;SMALL&gt;314  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;315  &lt;/SMALL&gt;        &#39;/home.gtl&#39;, specials, params, new_cookie_text)
&lt;SMALL&gt;316  &lt;/SMALL&gt;
&lt;SMALL&gt;317  &lt;/SMALL&gt;  def _DoBadUrl(self, path, cookie, specials, params):
&lt;SMALL&gt;318  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles invalid urls: displays an appropriate error message.
&lt;SMALL&gt;319  &lt;/SMALL&gt;
&lt;SMALL&gt;320  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;321  &lt;/SMALL&gt;      path: The invalid url.
&lt;SMALL&gt;322  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;323  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;324  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;325  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;326  &lt;/SMALL&gt;    self._SendError(&#39;Invalid request: %s&#39; % (path,), cookie, specials, params)
&lt;SMALL&gt;327  &lt;/SMALL&gt;
&lt;SMALL&gt;328  &lt;/SMALL&gt;  def _DoQuitserver(self, cookie, specials, params):
&lt;SMALL&gt;329  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /quitserver url for administrators to quit the server.
&lt;SMALL&gt;330  &lt;/SMALL&gt;
&lt;SMALL&gt;331  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;332  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;333  &lt;/SMALL&gt;      specials: Other special values for this request. (unused)
&lt;SMALL&gt;334  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;335  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;336  &lt;/SMALL&gt;    global quit_server
&lt;SMALL&gt;337  &lt;/SMALL&gt;    quit_server = True
&lt;SMALL&gt;338  &lt;/SMALL&gt;    self._SendTextResponse(&#39;Server quit.&#39;, None)
&lt;SMALL&gt;339  &lt;/SMALL&gt;
&lt;SMALL&gt;340  &lt;/SMALL&gt;  def _AddParameter(self, name, params, data_dict, default=None):
&lt;SMALL&gt;341  &lt;/SMALL&gt;    &quot;&quot;&quot;Transfers a value (with a default) from the parameters to the data.&quot;&quot;&quot;
&lt;SMALL&gt;342  &lt;/SMALL&gt;    if params.get(name):
&lt;SMALL&gt;343  &lt;/SMALL&gt;      data_dict[name] = params[name][0]
&lt;SMALL&gt;344  &lt;/SMALL&gt;    elif default is not None:
&lt;SMALL&gt;345  &lt;/SMALL&gt;      data_dict[name] = default
&lt;SMALL&gt;346  &lt;/SMALL&gt;
&lt;SMALL&gt;347  &lt;/SMALL&gt;  def _GetParameter(self, params, name, default=None):
&lt;SMALL&gt;348  &lt;/SMALL&gt;    &quot;&quot;&quot;Gets a parameter value with a default.&quot;&quot;&quot;
&lt;SMALL&gt;349  &lt;/SMALL&gt;    if params.get(name):
&lt;SMALL&gt;350  &lt;/SMALL&gt;      return params[name][0]
&lt;SMALL&gt;351  &lt;/SMALL&gt;    return default
&lt;SMALL&gt;352  &lt;/SMALL&gt;
&lt;SMALL&gt;353  &lt;/SMALL&gt;  def _GetSnippets(self, cookie, specials, create=False):
&lt;SMALL&gt;354  &lt;/SMALL&gt;    &quot;&quot;&quot;Returns all of the user&#39;s snippets.&quot;&quot;&quot;
&lt;SMALL&gt;355  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;356  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;357  &lt;/SMALL&gt;      profile = database[cookie[COOKIE_UID]]
&lt;SMALL&gt;358  &lt;/SMALL&gt;      if create and &#39;snippets&#39; not in profile:
&lt;SMALL&gt;359  &lt;/SMALL&gt;        profile[&#39;snippets&#39;] = []
&lt;SMALL&gt;360  &lt;/SMALL&gt;      snippets = profile[&#39;snippets&#39;]
&lt;SMALL&gt;361  &lt;/SMALL&gt;    except (KeyError, TypeError):
&lt;SMALL&gt;362  &lt;/SMALL&gt;      _Log(&#39;Error getting snippets&#39;)
&lt;SMALL&gt;363  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;364  &lt;/SMALL&gt;    return snippets
&lt;SMALL&gt;365  &lt;/SMALL&gt;
&lt;SMALL&gt;366  &lt;/SMALL&gt;  def _DoNewsnippet2(self, cookie, specials, params):
&lt;SMALL&gt;367  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /newsnippet2 url: actually add the snippet.
&lt;SMALL&gt;368  &lt;/SMALL&gt;
&lt;SMALL&gt;369  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;370  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;371  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;372  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;373  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;374  &lt;/SMALL&gt;    snippet = self._GetParameter(params, &#39;snippet&#39;)
&lt;SMALL&gt;375  &lt;/SMALL&gt;    if not snippet:
&lt;SMALL&gt;376  &lt;/SMALL&gt;      self._SendError(&#39;No snippet!&#39;, cookie, specials, params)
&lt;SMALL&gt;377  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;378  &lt;/SMALL&gt;      snippets = self._GetSnippets(cookie, specials, True)
&lt;SMALL&gt;379  &lt;/SMALL&gt;      if snippets is not None:
&lt;SMALL&gt;380  &lt;/SMALL&gt;        snippets.insert(0, snippet)
&lt;SMALL&gt;381  &lt;/SMALL&gt;    self._SendRedirect(&#39;/snippets.gtl&#39;, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;382  &lt;/SMALL&gt;
&lt;SMALL&gt;383  &lt;/SMALL&gt;  def _DoDeletesnippet(self, cookie, specials, params):
&lt;SMALL&gt;384  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /deletesnippet url: delete the indexed snippet.
&lt;SMALL&gt;385  &lt;/SMALL&gt;
&lt;SMALL&gt;386  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;387  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;388  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;389  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;390  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;391  &lt;/SMALL&gt;    index = self._GetParameter(params, &#39;index&#39;)
&lt;SMALL&gt;392  &lt;/SMALL&gt;    snippets = self._GetSnippets(cookie, specials)
&lt;SMALL&gt;393  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;394  &lt;/SMALL&gt;      del snippets[int(index)]
&lt;SMALL&gt;395  &lt;/SMALL&gt;    except (IndexError, TypeError, ValueError):
&lt;SMALL&gt;396  &lt;/SMALL&gt;      self._SendError(
&lt;SMALL&gt;397  &lt;/SMALL&gt;          &#39;Invalid index (%s)&#39; % (index,),
&lt;SMALL&gt;398  &lt;/SMALL&gt;          cookie, specials, params)
&lt;SMALL&gt;399  &lt;/SMALL&gt;      return
&lt;SMALL&gt;400  &lt;/SMALL&gt;    self._SendRedirect(&#39;/snippets.gtl&#39;, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;401  &lt;/SMALL&gt;
&lt;SMALL&gt;402  &lt;/SMALL&gt;  def _DoSaveprofile(self, cookie, specials, params):
&lt;SMALL&gt;403  &lt;/SMALL&gt;    &quot;&quot;&quot;Saves the user&#39;s profile.
&lt;SMALL&gt;404  &lt;/SMALL&gt;
&lt;SMALL&gt;405  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;406  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;407  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;408  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;409  &lt;/SMALL&gt;
&lt;SMALL&gt;410  &lt;/SMALL&gt;    If the &#39;action&#39; cgi parameter is &#39;new&#39;, then this is creating a new user
&lt;SMALL&gt;411  &lt;/SMALL&gt;    and it&#39;s an error if the user already exists. If action is &#39;update&#39;, then
&lt;SMALL&gt;412  &lt;/SMALL&gt;    this is editing an existing user&#39;s profile and it&#39;s an error if the user
&lt;SMALL&gt;413  &lt;/SMALL&gt;    does not exist.
&lt;SMALL&gt;414  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;415  &lt;/SMALL&gt;
&lt;SMALL&gt;416  &lt;/SMALL&gt;    # build new profile
&lt;SMALL&gt;417  &lt;/SMALL&gt;    profile_data = {}
&lt;SMALL&gt;418  &lt;/SMALL&gt;    uid = self._GetParameter(params, &#39;uid&#39;, cookie[COOKIE_UID])
&lt;SMALL&gt;419  &lt;/SMALL&gt;    newpw = self._GetParameter(params, &#39;pw&#39;)
&lt;SMALL&gt;420  &lt;/SMALL&gt;    self._AddParameter(&#39;name&#39;, params, profile_data, uid)
&lt;SMALL&gt;421  &lt;/SMALL&gt;    self._AddParameter(&#39;pw&#39;, params, profile_data)
&lt;SMALL&gt;422  &lt;/SMALL&gt;    self._AddParameter(&#39;is_author&#39;, params, profile_data)
&lt;SMALL&gt;423  &lt;/SMALL&gt;    self._AddParameter(&#39;is_admin&#39;, params, profile_data)
&lt;SMALL&gt;424  &lt;/SMALL&gt;    self._AddParameter(&#39;private_snippet&#39;, params, profile_data)
&lt;SMALL&gt;425  &lt;/SMALL&gt;    self._AddParameter(&#39;icon&#39;, params, profile_data)
&lt;SMALL&gt;426  &lt;/SMALL&gt;    self._AddParameter(&#39;web_site&#39;, params, profile_data)
&lt;SMALL&gt;427  &lt;/SMALL&gt;    self._AddParameter(&#39;color&#39;, params, profile_data)
&lt;SMALL&gt;428  &lt;/SMALL&gt;
&lt;SMALL&gt;429  &lt;/SMALL&gt;    # Each case below has to set either error or redirect
&lt;SMALL&gt;430  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;431  &lt;/SMALL&gt;    message = None
&lt;SMALL&gt;432  &lt;/SMALL&gt;    new_cookie_text = None
&lt;SMALL&gt;433  &lt;/SMALL&gt;    action = self._GetParameter(params, &#39;action&#39;)
&lt;SMALL&gt;434  &lt;/SMALL&gt;    if action == &#39;new&#39;:
&lt;SMALL&gt;435  &lt;/SMALL&gt;      if uid in database:
&lt;SMALL&gt;436  &lt;/SMALL&gt;        message = &#39;User already exists.&#39;
&lt;SMALL&gt;437  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;438  &lt;/SMALL&gt;        profile_data[&#39;pw&#39;] = newpw
&lt;SMALL&gt;439  &lt;/SMALL&gt;        database[uid] = profile_data
&lt;SMALL&gt;440  &lt;/SMALL&gt;        (cookie, new_cookie_text) = self._CreateCookie(&#39;GRUYERE&#39;, uid)
&lt;SMALL&gt;441  &lt;/SMALL&gt;        message = &#39;Account created.&#39;  # error message can also indicates success
&lt;SMALL&gt;442  &lt;/SMALL&gt;    elif action == &#39;update&#39;:
&lt;SMALL&gt;443  &lt;/SMALL&gt;      if uid not in database:
&lt;SMALL&gt;444  &lt;/SMALL&gt;        message = &#39;User does not exist.&#39;
&lt;SMALL&gt;445  &lt;/SMALL&gt;      elif (newpw and database[uid][&#39;pw&#39;] != self._GetParameter(params, &#39;oldpw&#39;)
&lt;SMALL&gt;446  &lt;/SMALL&gt;            and not cookie.get(COOKIE_ADMIN)):
&lt;SMALL&gt;447  &lt;/SMALL&gt;        # must be admin or supply old pw to change password
&lt;SMALL&gt;448  &lt;/SMALL&gt;        message = &#39;Incorrect password.&#39;
&lt;SMALL&gt;449  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;450  &lt;/SMALL&gt;        if newpw:
&lt;SMALL&gt;451  &lt;/SMALL&gt;          profile_data[&#39;pw&#39;] = newpw
&lt;SMALL&gt;452  &lt;/SMALL&gt;        database[uid].update(profile_data)
&lt;SMALL&gt;453  &lt;/SMALL&gt;        redirect = &#39;/&#39;
&lt;SMALL&gt;454  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;455  &lt;/SMALL&gt;      message = &#39;Invalid request&#39;
&lt;SMALL&gt;456  &lt;/SMALL&gt;    _Log(&#39;SetProfile(%s, %s): %s&#39; %(str(uid), str(action), str(message)))
&lt;SMALL&gt;457  &lt;/SMALL&gt;    if message:
&lt;SMALL&gt;458  &lt;/SMALL&gt;      self._SendError(message, cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;459  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;460  &lt;/SMALL&gt;      self._SendRedirect(redirect, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;461  &lt;/SMALL&gt;
&lt;SMALL&gt;462  &lt;/SMALL&gt;  def _SendHtmlResponse(self, html, new_cookie_text=None):
&lt;SMALL&gt;463  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends the provided html response with appropriate headers.
&lt;SMALL&gt;464  &lt;/SMALL&gt;
&lt;SMALL&gt;465  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;466  &lt;/SMALL&gt;      html: The response.
&lt;SMALL&gt;467  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;468  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;469  &lt;/SMALL&gt;    self.send_response(200)
&lt;SMALL&gt;470  &lt;/SMALL&gt;    self.send_header(&#39;Content-type&#39;, &#39;text/html&#39;)
&lt;SMALL&gt;471  &lt;/SMALL&gt;    self.send_header(&#39;Pragma&#39;, &#39;no-cache&#39;)
&lt;SMALL&gt;472  &lt;/SMALL&gt;    if new_cookie_text:
&lt;SMALL&gt;473  &lt;/SMALL&gt;      self.send_header(&#39;Set-Cookie&#39;, new_cookie_text)
&lt;SMALL&gt;474  &lt;/SMALL&gt;    self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;475  &lt;/SMALL&gt;    self.end_headers()
&lt;SMALL&gt;476  &lt;/SMALL&gt;    self.wfile.write(html)
&lt;SMALL&gt;477  &lt;/SMALL&gt;
&lt;SMALL&gt;478  &lt;/SMALL&gt;  def _SendTextResponse(self, text, new_cookie_text=None):
&lt;SMALL&gt;479  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a verbatim text response.&quot;&quot;&quot;
&lt;SMALL&gt;480  &lt;/SMALL&gt;
&lt;SMALL&gt;481  &lt;/SMALL&gt;    self._SendHtmlResponse(&#39;&amp;lt;pre&amp;gt;&#39; + cgi.escape(text) + &#39;&amp;lt;/pre&amp;gt;&#39;,
&lt;SMALL&gt;482  &lt;/SMALL&gt;                           new_cookie_text)
&lt;SMALL&gt;483  &lt;/SMALL&gt;
&lt;SMALL&gt;484  &lt;/SMALL&gt;  def _SendTemplateResponse(self, filename, specials, params,
&lt;SMALL&gt;485  &lt;/SMALL&gt;                            new_cookie_text=None):
&lt;SMALL&gt;486  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a response using a gtl template.
&lt;SMALL&gt;487  &lt;/SMALL&gt;
&lt;SMALL&gt;488  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;489  &lt;/SMALL&gt;      filename: The template file.
&lt;SMALL&gt;490  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;491  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;492  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;493  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;494  &lt;/SMALL&gt;    f = None
&lt;SMALL&gt;495  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;496  &lt;/SMALL&gt;      f = _Open(RESOURCE_PATH, filename)
&lt;SMALL&gt;497  &lt;/SMALL&gt;      template = f.read()
&lt;SMALL&gt;498  &lt;/SMALL&gt;    finally:
&lt;SMALL&gt;499  &lt;/SMALL&gt;      if f: f.close()
&lt;SMALL&gt;500  &lt;/SMALL&gt;    self._SendHtmlResponse(
&lt;SMALL&gt;501  &lt;/SMALL&gt;        gtl.ExpandTemplate(template, specials, params),
&lt;SMALL&gt;502  &lt;/SMALL&gt;        new_cookie_text)
&lt;SMALL&gt;503  &lt;/SMALL&gt;
&lt;SMALL&gt;504  &lt;/SMALL&gt;  def _SendFileResponse(self, filename, cookie, specials, params):
&lt;SMALL&gt;505  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends the contents of a file.
&lt;SMALL&gt;506  &lt;/SMALL&gt;
&lt;SMALL&gt;507  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;508  &lt;/SMALL&gt;      filename: The file to send.
&lt;SMALL&gt;509  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;510  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;511  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;512  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;513  &lt;/SMALL&gt;    content_type = None
&lt;SMALL&gt;514  &lt;/SMALL&gt;    if filename.endswith(&#39;.gtl&#39;):
&lt;SMALL&gt;515  &lt;/SMALL&gt;      self._SendTemplateResponse(filename, specials, params)
&lt;SMALL&gt;516  &lt;/SMALL&gt;      return
&lt;SMALL&gt;517  &lt;/SMALL&gt;
&lt;SMALL&gt;518  &lt;/SMALL&gt;    name_only = filename[filename.rfind(&#39;/&#39;):]
&lt;SMALL&gt;519  &lt;/SMALL&gt;    extension = name_only[name_only.rfind(&#39;.&#39;):]
&lt;SMALL&gt;520  &lt;/SMALL&gt;    if &#39;.&#39; not in extension:
&lt;SMALL&gt;521  &lt;/SMALL&gt;      content_type = &#39;text/plain&#39;
&lt;SMALL&gt;522  &lt;/SMALL&gt;    elif extension in RESOURCE_CONTENT_TYPES:
&lt;SMALL&gt;523  &lt;/SMALL&gt;      content_type = RESOURCE_CONTENT_TYPES[extension]
&lt;SMALL&gt;524  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;525  &lt;/SMALL&gt;      self._SendError(
&lt;SMALL&gt;526  &lt;/SMALL&gt;          &#39;Unrecognized file type (%s).&#39; % (filename,),
&lt;SMALL&gt;527  &lt;/SMALL&gt;          cookie, specials, params)
&lt;SMALL&gt;528  &lt;/SMALL&gt;      return
&lt;SMALL&gt;529  &lt;/SMALL&gt;    f = None
&lt;SMALL&gt;530  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;531  &lt;/SMALL&gt;      f = _Open(RESOURCE_PATH, filename, &#39;rb&#39;)
&lt;SMALL&gt;532  &lt;/SMALL&gt;      self.send_response(200)
&lt;SMALL&gt;533  &lt;/SMALL&gt;      self.send_header(&#39;Content-type&#39;, content_type)
&lt;SMALL&gt;534  &lt;/SMALL&gt;      # Always cache static resources
&lt;SMALL&gt;535  &lt;/SMALL&gt;      self.send_header(&#39;Cache-control&#39;, &#39;public, max-age=7200&#39;)
&lt;SMALL&gt;536  &lt;/SMALL&gt;      self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;537  &lt;/SMALL&gt;      self.end_headers()
&lt;SMALL&gt;538  &lt;/SMALL&gt;      self.wfile.write(f.read())
&lt;SMALL&gt;539  &lt;/SMALL&gt;    finally:
&lt;SMALL&gt;540  &lt;/SMALL&gt;      if f: f.close()
&lt;SMALL&gt;541  &lt;/SMALL&gt;
&lt;SMALL&gt;542  &lt;/SMALL&gt;  def _SendError(self, message, cookie, specials, params, new_cookie_text=None):
&lt;SMALL&gt;543  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends an error message (using the error.gtl template).
&lt;SMALL&gt;544  &lt;/SMALL&gt;
&lt;SMALL&gt;545  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;546  &lt;/SMALL&gt;      message: The error to display.
&lt;SMALL&gt;547  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;548  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;549  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;550  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;551  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;552  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;553  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;554  &lt;/SMALL&gt;        &#39;/error.gtl&#39;, specials, params, new_cookie_text)
&lt;SMALL&gt;555  &lt;/SMALL&gt;
&lt;SMALL&gt;556  &lt;/SMALL&gt;  def _CreateCookie(self, cookie_name, uid):
&lt;SMALL&gt;557  &lt;/SMALL&gt;    &quot;&quot;&quot;Creates a cookie for this user.
&lt;SMALL&gt;558  &lt;/SMALL&gt;
&lt;SMALL&gt;559  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;560  &lt;/SMALL&gt;      cookie_name: Cookie to create.
&lt;SMALL&gt;561  &lt;/SMALL&gt;      uid: The user.
&lt;SMALL&gt;562  &lt;/SMALL&gt;
&lt;SMALL&gt;563  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;564  &lt;/SMALL&gt;      (cookie, new_cookie_text).
&lt;SMALL&gt;565  &lt;/SMALL&gt;
&lt;SMALL&gt;566  &lt;/SMALL&gt;    The cookie contains all the information we need to know about
&lt;SMALL&gt;567  &lt;/SMALL&gt;    the user for normal operations, including whether or not the user
&lt;SMALL&gt;568  &lt;/SMALL&gt;    should have access to the authoring pages or the admin pages.
&lt;SMALL&gt;569  &lt;/SMALL&gt;    The cookie is signed with a hash function.
&lt;SMALL&gt;570  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;571  &lt;/SMALL&gt;    if uid is None:
&lt;SMALL&gt;572  &lt;/SMALL&gt;      return (self.NULL_COOKIE, cookie_name + &#39;=; path=/&#39;)
&lt;SMALL&gt;573  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;574  &lt;/SMALL&gt;    profile = database[uid]
&lt;SMALL&gt;575  &lt;/SMALL&gt;    if profile.get(&#39;is_author&#39;, False):
&lt;SMALL&gt;576  &lt;/SMALL&gt;      is_author = &#39;author&#39;
&lt;SMALL&gt;577  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;578  &lt;/SMALL&gt;      is_author = &#39;&#39;
&lt;SMALL&gt;579  &lt;/SMALL&gt;    if profile.get(&#39;is_admin&#39;, False):
&lt;SMALL&gt;580  &lt;/SMALL&gt;      is_admin = &#39;admin&#39;
&lt;SMALL&gt;581  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;582  &lt;/SMALL&gt;      is_admin = &#39;&#39;
&lt;SMALL&gt;583  &lt;/SMALL&gt;
&lt;SMALL&gt;584  &lt;/SMALL&gt;    c = {COOKIE_UID: uid, COOKIE_ADMIN: is_admin, COOKIE_AUTHOR: is_author}
&lt;SMALL&gt;585  &lt;/SMALL&gt;    c_data = &#39;%s|%s|%s&#39; % (uid, is_admin, is_author)
&lt;SMALL&gt;586  &lt;/SMALL&gt;
&lt;SMALL&gt;587  &lt;/SMALL&gt;    # global cookie_secret; only use positive hash values
&lt;SMALL&gt;588  &lt;/SMALL&gt;    h_data = str(hash(cookie_secret + c_data) &amp;amp; 0x7FFFFFF)
&lt;SMALL&gt;589  &lt;/SMALL&gt;    c_text = &#39;%s=%s|%s; path=/&#39; % (cookie_name, h_data, c_data)
&lt;SMALL&gt;590  &lt;/SMALL&gt;    return (c, c_text)
&lt;SMALL&gt;591  &lt;/SMALL&gt;
&lt;SMALL&gt;592  &lt;/SMALL&gt;  def _GetCookie(self, cookie_name):
&lt;SMALL&gt;593  &lt;/SMALL&gt;    &quot;&quot;&quot;Reads, verifies and parses the cookie.
&lt;SMALL&gt;594  &lt;/SMALL&gt;
&lt;SMALL&gt;595  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;596  &lt;/SMALL&gt;      cookie_name: The cookie to get.
&lt;SMALL&gt;597  &lt;/SMALL&gt;
&lt;SMALL&gt;598  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;599  &lt;/SMALL&gt;      a dict containing user, is_admin, and is_author if the cookie
&lt;SMALL&gt;600  &lt;/SMALL&gt;      is present and valid. Otherwise, None.
&lt;SMALL&gt;601  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;602  &lt;/SMALL&gt;    cookies = self.headers.get(&#39;Cookie&#39;)
&lt;SMALL&gt;603  &lt;/SMALL&gt;    if isinstance(cookies, str):
&lt;SMALL&gt;604  &lt;/SMALL&gt;      for c in cookies.split(&#39;;&#39;):
&lt;SMALL&gt;605  &lt;/SMALL&gt;        matched_cookie = self._MatchCookie(cookie_name, c)
&lt;SMALL&gt;606  &lt;/SMALL&gt;        if matched_cookie:
&lt;SMALL&gt;607  &lt;/SMALL&gt;          return self._ParseCookie(matched_cookie)
&lt;SMALL&gt;608  &lt;/SMALL&gt;    return self.NULL_COOKIE
&lt;SMALL&gt;609  &lt;/SMALL&gt;
&lt;SMALL&gt;610  &lt;/SMALL&gt;  def _MatchCookie(self, cookie_name, cookie):
&lt;SMALL&gt;611  &lt;/SMALL&gt;    &quot;&quot;&quot;Matches the cookie.
&lt;SMALL&gt;612  &lt;/SMALL&gt;
&lt;SMALL&gt;613  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;614  &lt;/SMALL&gt;      cookie_name: The name of the cookie.
&lt;SMALL&gt;615  &lt;/SMALL&gt;      cookie: The full cookie (name=value).
&lt;SMALL&gt;616  &lt;/SMALL&gt;
&lt;SMALL&gt;617  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;618  &lt;/SMALL&gt;      The cookie if it matches or None if it doesn&#39;t match.
&lt;SMALL&gt;619  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;620  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;621  &lt;/SMALL&gt;      (cn, cd) = cookie.strip().split(&#39;=&#39;, 1)
&lt;SMALL&gt;622  &lt;/SMALL&gt;      if cn != cookie_name:
&lt;SMALL&gt;623  &lt;/SMALL&gt;        return None
&lt;SMALL&gt;624  &lt;/SMALL&gt;    except (IndexError, ValueError):
&lt;SMALL&gt;625  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;626  &lt;/SMALL&gt;    return cd
&lt;SMALL&gt;627  &lt;/SMALL&gt;
&lt;SMALL&gt;628  &lt;/SMALL&gt;  def _ParseCookie(self, cookie):
&lt;SMALL&gt;629  &lt;/SMALL&gt;    &quot;&quot;&quot;Parses the cookie and returns NULL_COOKIE if it&#39;s invalid.
&lt;SMALL&gt;630  &lt;/SMALL&gt;
&lt;SMALL&gt;631  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;632  &lt;/SMALL&gt;      cookie: The text of the cookie.
&lt;SMALL&gt;633  &lt;/SMALL&gt;
&lt;SMALL&gt;634  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;635  &lt;/SMALL&gt;      A map containing the values in the cookie.
&lt;SMALL&gt;636  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;637  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;638  &lt;/SMALL&gt;      (hashed, cookie_data) = cookie.split(&#39;|&#39;, 1)
&lt;SMALL&gt;639  &lt;/SMALL&gt;      # global cookie_secret
&lt;SMALL&gt;640  &lt;/SMALL&gt;      if hashed != str(hash(cookie_secret + cookie_data) &amp;amp; 0x7FFFFFF):
&lt;SMALL&gt;641  &lt;/SMALL&gt;        return self.NULL_COOKIE
&lt;SMALL&gt;642  &lt;/SMALL&gt;      values = cookie_data.split(&#39;|&#39;)
&lt;SMALL&gt;643  &lt;/SMALL&gt;      return {
&lt;SMALL&gt;644  &lt;/SMALL&gt;          COOKIE_UID: values[0],
&lt;SMALL&gt;645  &lt;/SMALL&gt;          COOKIE_ADMIN: values[1] == &#39;admin&#39;,
&lt;SMALL&gt;646  &lt;/SMALL&gt;          COOKIE_AUTHOR: values[2] == &#39;author&#39;,
&lt;SMALL&gt;647  &lt;/SMALL&gt;      }
&lt;SMALL&gt;648  &lt;/SMALL&gt;    except (IndexError, ValueError):
&lt;SMALL&gt;649  &lt;/SMALL&gt;      return self.NULL_COOKIE
&lt;SMALL&gt;650  &lt;/SMALL&gt;
&lt;SMALL&gt;651  &lt;/SMALL&gt;  def _DoReset(self, cookie, specials, params):  # debug only; resets this db
&lt;SMALL&gt;652  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /reset url for administrators to reset the database.
&lt;SMALL&gt;653  &lt;/SMALL&gt;
&lt;SMALL&gt;654  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;655  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;656  &lt;/SMALL&gt;      specials: Other special values for this request. (unused)
&lt;SMALL&gt;657  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;658  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;659  &lt;/SMALL&gt;    self._ResetDatabase()
&lt;SMALL&gt;660  &lt;/SMALL&gt;    self._SendTextResponse(&#39;Server reset to default values...&#39;, None)
&lt;SMALL&gt;661  &lt;/SMALL&gt;
&lt;SMALL&gt;662  &lt;/SMALL&gt;  def _DoUpload2(self, cookie, specials, params):
&lt;SMALL&gt;663  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /upload2 url: finish the upload and save the file.
&lt;SMALL&gt;664  &lt;/SMALL&gt;
&lt;SMALL&gt;665  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;666  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;667  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;668  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;669  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;670  &lt;/SMALL&gt;    (filename, file_data) = self._ExtractFileFromRequest()
&lt;SMALL&gt;671  &lt;/SMALL&gt;    directory = self._MakeUserDirectory(cookie[COOKIE_UID])
&lt;SMALL&gt;672  &lt;/SMALL&gt;
&lt;SMALL&gt;673  &lt;/SMALL&gt;    message = None
&lt;SMALL&gt;674  &lt;/SMALL&gt;    url = None
&lt;SMALL&gt;675  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;676  &lt;/SMALL&gt;      f = _Open(directory, filename, &#39;wb&#39;)
&lt;SMALL&gt;677  &lt;/SMALL&gt;      f.write(file_data)
&lt;SMALL&gt;678  &lt;/SMALL&gt;      f.close()
&lt;SMALL&gt;679  &lt;/SMALL&gt;      (host, port) = http_server.server_address
&lt;SMALL&gt;680  &lt;/SMALL&gt;      url = &#39;http://%s:%d/%s/%s/%s&#39; % (
&lt;SMALL&gt;681  &lt;/SMALL&gt;          host, port, specials[SPECIAL_UNIQUE_ID], cookie[COOKIE_UID], filename)
&lt;SMALL&gt;682  &lt;/SMALL&gt;    except IOError, ex:
&lt;SMALL&gt;683  &lt;/SMALL&gt;      message = &#39;Couldn\&#39;t write file %s: %s&#39; % (filename, ex.message)
&lt;SMALL&gt;684  &lt;/SMALL&gt;      _Log(message)
&lt;SMALL&gt;685  &lt;/SMALL&gt;
&lt;SMALL&gt;686  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;687  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;688  &lt;/SMALL&gt;        &#39;/upload2.gtl&#39;, specials,
&lt;SMALL&gt;689  &lt;/SMALL&gt;        {&#39;url&#39;: url})
&lt;SMALL&gt;690  &lt;/SMALL&gt;
&lt;SMALL&gt;691  &lt;/SMALL&gt;  def _ExtractFileFromRequest(self):
&lt;SMALL&gt;692  &lt;/SMALL&gt;    &quot;&quot;&quot;Extracts the file from an upload request.
&lt;SMALL&gt;693  &lt;/SMALL&gt;
&lt;SMALL&gt;694  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;695  &lt;/SMALL&gt;      (filename, file_data)
&lt;SMALL&gt;696  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;697  &lt;/SMALL&gt;    form = cgi.FieldStorage(
&lt;SMALL&gt;698  &lt;/SMALL&gt;        fp=self.rfile,
&lt;SMALL&gt;699  &lt;/SMALL&gt;        headers=self.headers,
&lt;SMALL&gt;700  &lt;/SMALL&gt;        environ={&#39;REQUEST_METHOD&#39;: &#39;POST&#39;,
&lt;SMALL&gt;701  &lt;/SMALL&gt;                 &#39;CONTENT_TYPE&#39;: self.headers.getheader(&#39;content-type&#39;)})
&lt;SMALL&gt;702  &lt;/SMALL&gt;
&lt;SMALL&gt;703  &lt;/SMALL&gt;    upload_file = form[&#39;upload_file&#39;]
&lt;SMALL&gt;704  &lt;/SMALL&gt;    file_data = upload_file.file.read()
&lt;SMALL&gt;705  &lt;/SMALL&gt;    return (upload_file.filename, file_data)
&lt;SMALL&gt;706  &lt;/SMALL&gt;
&lt;SMALL&gt;707  &lt;/SMALL&gt;  def _MakeUserDirectory(self, uid):
&lt;SMALL&gt;708  &lt;/SMALL&gt;    &quot;&quot;&quot;Creates a separate directory for each user to avoid upload conflicts.
&lt;SMALL&gt;709  &lt;/SMALL&gt;
&lt;SMALL&gt;710  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;711  &lt;/SMALL&gt;      uid: The user to create a directory for.
&lt;SMALL&gt;712  &lt;/SMALL&gt;
&lt;SMALL&gt;713  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;714  &lt;/SMALL&gt;      The new directory path (/uid/).
&lt;SMALL&gt;715  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;716  &lt;/SMALL&gt;
&lt;SMALL&gt;717  &lt;/SMALL&gt;    directory = RESOURCE_PATH + os.sep + str(uid) + os.sep
&lt;SMALL&gt;718  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;719  &lt;/SMALL&gt;      print &#39;mkdir: &#39;, directory
&lt;SMALL&gt;720  &lt;/SMALL&gt;      os.mkdir(directory)
&lt;SMALL&gt;721  &lt;/SMALL&gt;      # throws an exception if directory already exists,
&lt;SMALL&gt;722  &lt;/SMALL&gt;      # however exception type varies by platform
&lt;SMALL&gt;723  &lt;/SMALL&gt;    except Exception:
&lt;SMALL&gt;724  &lt;/SMALL&gt;      pass  # just ignore it if it already exists
&lt;SMALL&gt;725  &lt;/SMALL&gt;    return directory
&lt;SMALL&gt;726  &lt;/SMALL&gt;
&lt;SMALL&gt;727  &lt;/SMALL&gt;  def _SendRedirect(self, url, unique_id):
&lt;SMALL&gt;728  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a 302 redirect.
&lt;SMALL&gt;729  &lt;/SMALL&gt;
&lt;SMALL&gt;730  &lt;/SMALL&gt;    Automatically adds the unique_id.
&lt;SMALL&gt;731  &lt;/SMALL&gt;
&lt;SMALL&gt;732  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;733  &lt;/SMALL&gt;      url: The location to redirect to which must start with &#39;/&#39;.
&lt;SMALL&gt;734  &lt;/SMALL&gt;      unique_id: The unique id to include in the url.
&lt;SMALL&gt;735  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;736  &lt;/SMALL&gt;    if not url:
&lt;SMALL&gt;737  &lt;/SMALL&gt;      url = &#39;/&#39;
&lt;SMALL&gt;738  &lt;/SMALL&gt;    url = &#39;/&#39; + unique_id + url
&lt;SMALL&gt;739  &lt;/SMALL&gt;    self.send_response(302)
&lt;SMALL&gt;740  &lt;/SMALL&gt;    self.send_header(&#39;Location&#39;, url)
&lt;SMALL&gt;741  &lt;/SMALL&gt;    self.send_header(&#39;Pragma&#39;, &#39;no-cache&#39;)
&lt;SMALL&gt;742  &lt;/SMALL&gt;    self.send_header(&#39;Content-type&#39;, &#39;text/html&#39;)
&lt;SMALL&gt;743  &lt;/SMALL&gt;    self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;744  &lt;/SMALL&gt;    self.end_headers()
&lt;SMALL&gt;745  &lt;/SMALL&gt;    self.wfile.write(
&lt;SMALL&gt;746  &lt;/SMALL&gt;        &#39;&#39;&#39;&amp;lt;!DOCTYPE HTML PUBLIC &#39;-//W3C//DTD HTML//EN&#39;&amp;gt;
&lt;SMALL&gt;747  &lt;/SMALL&gt;        &amp;lt;html&amp;gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt;748  &lt;/SMALL&gt;        &amp;lt;title&amp;gt;302 Redirect&amp;lt;/title&amp;gt;
&lt;SMALL&gt;749  &lt;/SMALL&gt;        Redirected &amp;lt;a href=&quot;%s&quot;&amp;gt;here&amp;lt;/a&amp;gt;
&lt;SMALL&gt;750  &lt;/SMALL&gt;        &amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&#39;&#39;&#39;
&lt;SMALL&gt;751  &lt;/SMALL&gt;        % (url,))
&lt;SMALL&gt;752  &lt;/SMALL&gt;
&lt;SMALL&gt;753  &lt;/SMALL&gt;  def _GetHandlerFunction(self, path):
&lt;SMALL&gt;754  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;755  &lt;/SMALL&gt;      return getattr(GruyereRequestHandler, &#39;_Do&#39; + path[1:].capitalize())
&lt;SMALL&gt;756  &lt;/SMALL&gt;    except AttributeError:
&lt;SMALL&gt;757  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;758  &lt;/SMALL&gt;
&lt;SMALL&gt;759  &lt;/SMALL&gt;  def do_POST(self):  # part of BaseHTTPRequestHandler interface
&lt;SMALL&gt;760  &lt;/SMALL&gt;    self.DoGetOrPost()
&lt;SMALL&gt;761  &lt;/SMALL&gt;
&lt;SMALL&gt;762  &lt;/SMALL&gt;  def do_GET(self):  # part of BaseHTTPRequestHandler interface
&lt;SMALL&gt;763  &lt;/SMALL&gt;    self.DoGetOrPost()
&lt;SMALL&gt;764  &lt;/SMALL&gt;
&lt;SMALL&gt;765  &lt;/SMALL&gt;  def DoGetOrPost(self):
&lt;SMALL&gt;766  &lt;/SMALL&gt;    &quot;&quot;&quot;Validate an http get or post request and call HandleRequest.&quot;&quot;&quot;
&lt;SMALL&gt;767  &lt;/SMALL&gt;
&lt;SMALL&gt;768  &lt;/SMALL&gt;    url = urlparse(self.path)
&lt;SMALL&gt;769  &lt;/SMALL&gt;    path = url[2]
&lt;SMALL&gt;770  &lt;/SMALL&gt;    query = url[4]
&lt;SMALL&gt;771  &lt;/SMALL&gt;
&lt;SMALL&gt;772  &lt;/SMALL&gt;    # Normally, Gruyere only accepts connections to/from localhost. If you
&lt;SMALL&gt;773  &lt;/SMALL&gt;    # would like to allow access from other ip addresses, add the addresses
&lt;SMALL&gt;774  &lt;/SMALL&gt;    # of the other machines to allowed_ips and change insecure_mode to True
&lt;SMALL&gt;775  &lt;/SMALL&gt;    # above. This makes the application more vulnerable to a real attack so
&lt;SMALL&gt;776  &lt;/SMALL&gt;    # you should only add ips of machines you completely control and make
&lt;SMALL&gt;777  &lt;/SMALL&gt;    # sure that you are not using them to access any other web pages while
&lt;SMALL&gt;778  &lt;/SMALL&gt;    # you are using Gruyere.
&lt;SMALL&gt;779  &lt;/SMALL&gt;
&lt;SMALL&gt;780  &lt;/SMALL&gt;    allowed_ips = [&#39;127.0.0.1&#39;]
&lt;SMALL&gt;781  &lt;/SMALL&gt;
&lt;SMALL&gt;782  &lt;/SMALL&gt;    # WARNING! DO NOT CHANGE THE FOLLOWING SECTION OF CODE!
&lt;SMALL&gt;783  &lt;/SMALL&gt;
&lt;SMALL&gt;784  &lt;/SMALL&gt;    # This application is very exploitable. See main for details. What we&#39;re
&lt;SMALL&gt;785  &lt;/SMALL&gt;    # doing here is (2) and (3) on the previous list:
&lt;SMALL&gt;786  &lt;/SMALL&gt;    #   (2) If a request is received from any IP other than localhost, quit.
&lt;SMALL&gt;787  &lt;/SMALL&gt;    # An external attacker could still mount an attack on this IP by putting
&lt;SMALL&gt;788  &lt;/SMALL&gt;    # an attack on an external web page, e.g., a web page that redirects to
&lt;SMALL&gt;789  &lt;/SMALL&gt;    # a vulnerable url on 127.0.0.1 (which is why we use a random number).
&lt;SMALL&gt;790  &lt;/SMALL&gt;    #   (3) Inject a random identifier as the first part of the path and
&lt;SMALL&gt;791  &lt;/SMALL&gt;    # quit if a request is received without this identifier (except for an
&lt;SMALL&gt;792  &lt;/SMALL&gt;    # empty path which redirects and /favicon.ico).
&lt;SMALL&gt;793  &lt;/SMALL&gt;
&lt;SMALL&gt;794  &lt;/SMALL&gt;    request_ip = self.client_address[0]                      # DO NOT CHANGE
&lt;SMALL&gt;795  &lt;/SMALL&gt;    if request_ip not in allowed_ips:                        # DO NOT CHANGE
&lt;SMALL&gt;796  &lt;/SMALL&gt;      print &amp;gt;&amp;gt;sys.stderr, (                                  # DO NOT CHANGE
&lt;SMALL&gt;797  &lt;/SMALL&gt;          &#39;DANGER! Request from bad ip: &#39; + request_ip)      # DO NOT CHANGE
&lt;SMALL&gt;798  &lt;/SMALL&gt;      _Exit(&#39;bad_ip&#39;)                                        # DO NOT CHANGE
&lt;SMALL&gt;799  &lt;/SMALL&gt;
&lt;SMALL&gt;800  &lt;/SMALL&gt;    if (server_unique_id not in path                         # DO NOT CHANGE
&lt;SMALL&gt;801  &lt;/SMALL&gt;        and path != &#39;/favicon.ico&#39;):                         # DO NOT CHANGE
&lt;SMALL&gt;802  &lt;/SMALL&gt;      if path == &#39;&#39; or path == &#39;/&#39;:                          # DO NOT CHANGE
&lt;SMALL&gt;803  &lt;/SMALL&gt;        self._SendRedirect(&#39;/&#39;, server_unique_id)            # DO NOT CHANGE
&lt;SMALL&gt;804  &lt;/SMALL&gt;        return                                               # DO NOT CHANGE
&lt;SMALL&gt;805  &lt;/SMALL&gt;      else:                                                  # DO NOT CHANGE
&lt;SMALL&gt;806  &lt;/SMALL&gt;        print &amp;gt;&amp;gt;sys.stderr, (                                # DO NOT CHANGE
&lt;SMALL&gt;807  &lt;/SMALL&gt;            &#39;DANGER! Request without unique id: &#39; + path)    # DO NOT CHANGE
&lt;SMALL&gt;808  &lt;/SMALL&gt;        _Exit(&#39;bad_id&#39;)                                      # DO NOT CHANGE
&lt;SMALL&gt;809  &lt;/SMALL&gt;
&lt;SMALL&gt;810  &lt;/SMALL&gt;    path = path.replace(&#39;/&#39; + server_unique_id, &#39;&#39;, 1)       # DO NOT CHANGE
&lt;SMALL&gt;811  &lt;/SMALL&gt;
&lt;SMALL&gt;812  &lt;/SMALL&gt;    # END WARNING!
&lt;SMALL&gt;813  &lt;/SMALL&gt;
&lt;SMALL&gt;814  &lt;/SMALL&gt;    self.HandleRequest(path, query, server_unique_id)
&lt;SMALL&gt;815  &lt;/SMALL&gt;
&lt;SMALL&gt;816  &lt;/SMALL&gt;  def HandleRequest(self, path, query, unique_id):
&lt;SMALL&gt;817  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles an http request.
&lt;SMALL&gt;818  &lt;/SMALL&gt;
&lt;SMALL&gt;819  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;820  &lt;/SMALL&gt;      path: The path part of the url, with leading slash.
&lt;SMALL&gt;821  &lt;/SMALL&gt;      query: The query part of the url, without leading question mark.
&lt;SMALL&gt;822  &lt;/SMALL&gt;      unique_id: The unique id from the url.
&lt;SMALL&gt;823  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;824  &lt;/SMALL&gt;
&lt;SMALL&gt;825  &lt;/SMALL&gt;    path = urllib.unquote(path)
&lt;SMALL&gt;826  &lt;/SMALL&gt;
&lt;SMALL&gt;827  &lt;/SMALL&gt;    if not path:
&lt;SMALL&gt;828  &lt;/SMALL&gt;      self._SendRedirect(&#39;/&#39;, server_unique_id)
&lt;SMALL&gt;829  &lt;/SMALL&gt;      return
&lt;SMALL&gt;830  &lt;/SMALL&gt;    params = cgi.parse_qs(query)  # url.query
&lt;SMALL&gt;831  &lt;/SMALL&gt;    specials = {}
&lt;SMALL&gt;832  &lt;/SMALL&gt;    cookie = self._GetCookie(&#39;GRUYERE&#39;)
&lt;SMALL&gt;833  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;834  &lt;/SMALL&gt;    specials[SPECIAL_COOKIE] = cookie
&lt;SMALL&gt;835  &lt;/SMALL&gt;    specials[SPECIAL_DB] = database
&lt;SMALL&gt;836  &lt;/SMALL&gt;    specials[SPECIAL_PROFILE] = database.get(cookie.get(COOKIE_UID))
&lt;SMALL&gt;837  &lt;/SMALL&gt;    specials[SPECIAL_PARAMS] = params
&lt;SMALL&gt;838  &lt;/SMALL&gt;    specials[SPECIAL_UNIQUE_ID] = unique_id
&lt;SMALL&gt;839  &lt;/SMALL&gt;
&lt;SMALL&gt;840  &lt;/SMALL&gt;    if path in self._PROTECTED_URLS and not cookie[COOKIE_ADMIN]:
&lt;SMALL&gt;841  &lt;/SMALL&gt;      self._SendError(&#39;Invalid request&#39;, cookie, specials, params)
&lt;SMALL&gt;842  &lt;/SMALL&gt;      return
&lt;SMALL&gt;843  &lt;/SMALL&gt;
&lt;SMALL&gt;844  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;845  &lt;/SMALL&gt;      handler = self._GetHandlerFunction(path)
&lt;SMALL&gt;846  &lt;/SMALL&gt;      if callable(handler):
&lt;SMALL&gt;847  &lt;/SMALL&gt;        (handler)(self, cookie, specials, params)
&lt;SMALL&gt;848  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;849  &lt;/SMALL&gt;        try:
&lt;SMALL&gt;850  &lt;/SMALL&gt;          self._SendFileResponse(path, cookie, specials, params)
&lt;SMALL&gt;851  &lt;/SMALL&gt;        except IOError:
&lt;SMALL&gt;852  &lt;/SMALL&gt;          self._DoBadUrl(path, cookie, specials, params)
&lt;SMALL&gt;853  &lt;/SMALL&gt;    except KeyboardInterrupt:
&lt;SMALL&gt;854  &lt;/SMALL&gt;      _Exit(&#39;KeyboardInterrupt&#39;)
&lt;SMALL&gt;855  &lt;/SMALL&gt;
&lt;SMALL&gt;856  &lt;/SMALL&gt;
&lt;SMALL&gt;857  &lt;/SMALL&gt;def _Log(message):
&lt;SMALL&gt;858  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, message
&lt;SMALL&gt;859  &lt;/SMALL&gt;
&lt;SMALL&gt;860  &lt;/SMALL&gt;
&lt;SMALL&gt;861  &lt;/SMALL&gt;if __name__ == &#39;__main__&#39;:
&lt;SMALL&gt;862  &lt;/SMALL&gt;  main()
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/gtl.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (348 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/gtl.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?gtl.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: c955e5f883c8e7ef5f56d5ad3d0a4d02
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 15231

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (15231 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;gtl.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere Template Language, part of Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import cgi
&lt;SMALL&gt; 23  &lt;/SMALL&gt;import logging
&lt;SMALL&gt; 24  &lt;/SMALL&gt;import operator
&lt;SMALL&gt; 25  &lt;/SMALL&gt;import os
&lt;SMALL&gt; 26  &lt;/SMALL&gt;import pprint
&lt;SMALL&gt; 27  &lt;/SMALL&gt;import sys
&lt;SMALL&gt; 28  &lt;/SMALL&gt;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;# our modules
&lt;SMALL&gt; 30  &lt;/SMALL&gt;import gruyere
&lt;SMALL&gt; 31  &lt;/SMALL&gt;import sanitize
&lt;SMALL&gt; 32  &lt;/SMALL&gt;
&lt;SMALL&gt; 33  &lt;/SMALL&gt;
&lt;SMALL&gt; 34  &lt;/SMALL&gt;def ExpandTemplate(template, specials, params, name=&#39;&#39;):
&lt;SMALL&gt; 35  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a template.
&lt;SMALL&gt; 36  &lt;/SMALL&gt;
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    template: a string template.
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    specials: a dict of special values.
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    params: a dict of parameter values.
&lt;SMALL&gt; 41  &lt;/SMALL&gt;    name: the name of the _this object.
&lt;SMALL&gt; 42  &lt;/SMALL&gt;
&lt;SMALL&gt; 43  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    the expanded template.
&lt;SMALL&gt; 45  &lt;/SMALL&gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;  The template language includes these block structures:
&lt;SMALL&gt; 47  &lt;/SMALL&gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;    [[include:&amp;lt;filename&amp;gt;]] ...[[/include:&amp;lt;filename&amp;gt;]]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;      Insert the file or if the file cannot be opened insert the contents of
&lt;SMALL&gt; 50  &lt;/SMALL&gt;      the block. The path should use / as a separator regardless of what
&lt;SMALL&gt; 51  &lt;/SMALL&gt;      the underlying operating system is.
&lt;SMALL&gt; 52  &lt;/SMALL&gt;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;    [[for:&amp;lt;variable&amp;gt;]] ... [[/for:&amp;lt;variable&amp;gt;]]
&lt;SMALL&gt; 54  &lt;/SMALL&gt;      Iterate over the variable (which should be a mapping or sequence) and
&lt;SMALL&gt; 55  &lt;/SMALL&gt;      insert the block once for each value. Inside the loop _key is bound to
&lt;SMALL&gt; 56  &lt;/SMALL&gt;      the key value for the iteration.
&lt;SMALL&gt; 57  &lt;/SMALL&gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;    [[if:&amp;lt;variable&amp;gt;]] ... [[/if:&amp;lt;variable&amp;gt;]]
&lt;SMALL&gt; 59  &lt;/SMALL&gt;      Expand the contents of the block if the variable is not &#39;false&#39;.  There
&lt;SMALL&gt; 60  &lt;/SMALL&gt;      is no else; use [[if:!&amp;lt;variable&amp;gt;]] instead.
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;    Note that in each case the end tags must match the begin tags with a
&lt;SMALL&gt; 63  &lt;/SMALL&gt;    leading slash. This prevents mismatched tags and makes it easier to parse.
&lt;SMALL&gt; 64  &lt;/SMALL&gt;
&lt;SMALL&gt; 65  &lt;/SMALL&gt;  The variable syntax is:
&lt;SMALL&gt; 66  &lt;/SMALL&gt;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;    {{&amp;lt;field&amp;gt;[.&amp;lt;field&amp;gt;]*[:&amp;lt;escaper&amp;gt;]}}
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;  where &amp;lt;field&amp;gt; is:
&lt;SMALL&gt; 70  &lt;/SMALL&gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;    a key to extract from a mapping
&lt;SMALL&gt; 72  &lt;/SMALL&gt;    a number to extract from a sequence
&lt;SMALL&gt; 73  &lt;/SMALL&gt;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  Variable names that start with &#39;_&#39; are special values:
&lt;SMALL&gt; 75  &lt;/SMALL&gt;    _key = iteration key (inside loops)
&lt;SMALL&gt; 76  &lt;/SMALL&gt;    _this = iteration value (inside loop)
&lt;SMALL&gt; 77  &lt;/SMALL&gt;    _db = the database
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    _cookie = the user&#39;s cookie
&lt;SMALL&gt; 79  &lt;/SMALL&gt;    _profile = the user&#39;s profile ~ _db.*(_cookie.user)
&lt;SMALL&gt; 80  &lt;/SMALL&gt;
&lt;SMALL&gt; 81  &lt;/SMALL&gt;  If a field name starts with &#39;*&#39; it refers to a dereferenced parameter (orx
&lt;SMALL&gt; 82  &lt;/SMALL&gt;  *_this). For example, _db.*uid retrieves the entry from _db matching the
&lt;SMALL&gt; 83  &lt;/SMALL&gt;  uid parameter.
&lt;SMALL&gt; 84  &lt;/SMALL&gt;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;  The comment syntax is:
&lt;SMALL&gt; 86  &lt;/SMALL&gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;    {{#&amp;lt;comment&amp;gt;}}
&lt;SMALL&gt; 88  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 89  &lt;/SMALL&gt;  t = _ExpandBlocks(template, specials, params, name)
&lt;SMALL&gt; 90  &lt;/SMALL&gt;  t = _ExpandVariables(t, specials, params, name)
&lt;SMALL&gt; 91  &lt;/SMALL&gt;  return t
&lt;SMALL&gt; 92  &lt;/SMALL&gt;
&lt;SMALL&gt; 93  &lt;/SMALL&gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;BLOCK_OPEN = &#39;[[&#39;
&lt;SMALL&gt; 95  &lt;/SMALL&gt;END_BLOCK_OPEN = &#39;[[/&#39;
&lt;SMALL&gt; 96  &lt;/SMALL&gt;BLOCK_CLOSE = &#39;]]&#39;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;
&lt;SMALL&gt; 98  &lt;/SMALL&gt;
&lt;SMALL&gt; 99  &lt;/SMALL&gt;def _ExpandBlocks(template, specials, params, name):
&lt;SMALL&gt;100  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands all the blocks in a template.&quot;&quot;&quot;
&lt;SMALL&gt;101  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;102  &lt;/SMALL&gt;  rest = template
&lt;SMALL&gt;103  &lt;/SMALL&gt;  while rest:
&lt;SMALL&gt;104  &lt;/SMALL&gt;    tag, before_tag, after_tag = _FindTag(rest, BLOCK_OPEN, BLOCK_CLOSE)
&lt;SMALL&gt;105  &lt;/SMALL&gt;    if tag is None:
&lt;SMALL&gt;106  &lt;/SMALL&gt;      break
&lt;SMALL&gt;107  &lt;/SMALL&gt;    end_tag = END_BLOCK_OPEN + tag + BLOCK_CLOSE
&lt;SMALL&gt;108  &lt;/SMALL&gt;    before_end = rest.find(end_tag, after_tag)
&lt;SMALL&gt;109  &lt;/SMALL&gt;    if before_end &amp;lt; 0:
&lt;SMALL&gt;110  &lt;/SMALL&gt;      break
&lt;SMALL&gt;111  &lt;/SMALL&gt;    after_end = before_end + len(end_tag)
&lt;SMALL&gt;112  &lt;/SMALL&gt;
&lt;SMALL&gt;113  &lt;/SMALL&gt;    result.append(rest[:before_tag])
&lt;SMALL&gt;114  &lt;/SMALL&gt;    block = rest[after_tag:before_end]
&lt;SMALL&gt;115  &lt;/SMALL&gt;    result.append(_ExpandBlock(tag, block, specials, params, name))
&lt;SMALL&gt;116  &lt;/SMALL&gt;    rest = rest[after_end:]
&lt;SMALL&gt;117  &lt;/SMALL&gt;  return &#39;&#39;.join(result) + rest
&lt;SMALL&gt;118  &lt;/SMALL&gt;
&lt;SMALL&gt;119  &lt;/SMALL&gt;
&lt;SMALL&gt;120  &lt;/SMALL&gt;VAR_OPEN = &#39;{{&#39;
&lt;SMALL&gt;121  &lt;/SMALL&gt;VAR_CLOSE = &#39;}}&#39;
&lt;SMALL&gt;122  &lt;/SMALL&gt;
&lt;SMALL&gt;123  &lt;/SMALL&gt;
&lt;SMALL&gt;124  &lt;/SMALL&gt;def _ExpandVariables(template, specials, params, name):
&lt;SMALL&gt;125  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands all the variables in a template.&quot;&quot;&quot;
&lt;SMALL&gt;126  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;127  &lt;/SMALL&gt;  rest = template
&lt;SMALL&gt;128  &lt;/SMALL&gt;  while rest:
&lt;SMALL&gt;129  &lt;/SMALL&gt;    tag, before_tag, after_tag = _FindTag(rest, VAR_OPEN, VAR_CLOSE)
&lt;SMALL&gt;130  &lt;/SMALL&gt;    if tag is None:
&lt;SMALL&gt;131  &lt;/SMALL&gt;      break
&lt;SMALL&gt;132  &lt;/SMALL&gt;    result.append(rest[:before_tag])
&lt;SMALL&gt;133  &lt;/SMALL&gt;    result.append(str(_ExpandVariable(tag, specials, params, name)))
&lt;SMALL&gt;134  &lt;/SMALL&gt;    rest = rest[after_tag:]
&lt;SMALL&gt;135  &lt;/SMALL&gt;  return &#39;&#39;.join(result) + rest
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;SMALL&gt;137  &lt;/SMALL&gt;
&lt;SMALL&gt;138  &lt;/SMALL&gt;FOR_TAG = &#39;for&#39;
&lt;SMALL&gt;139  &lt;/SMALL&gt;IF_TAG = &#39;if&#39;
&lt;SMALL&gt;140  &lt;/SMALL&gt;INCLUDE_TAG = &#39;include&#39;
&lt;SMALL&gt;141  &lt;/SMALL&gt;
&lt;SMALL&gt;142  &lt;/SMALL&gt;
&lt;SMALL&gt;143  &lt;/SMALL&gt;def _ExpandBlock(tag, template, specials, params, name):
&lt;SMALL&gt;144  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a single template block.&quot;&quot;&quot;
&lt;SMALL&gt;145  &lt;/SMALL&gt;
&lt;SMALL&gt;146  &lt;/SMALL&gt;  tag_type, block_var = tag.split(&#39;:&#39;, 1)
&lt;SMALL&gt;147  &lt;/SMALL&gt;  if tag_type == INCLUDE_TAG:
&lt;SMALL&gt;148  &lt;/SMALL&gt;    return _ExpandInclude(tag, block_var, template, specials, params, name)
&lt;SMALL&gt;149  &lt;/SMALL&gt;  elif tag_type == IF_TAG:
&lt;SMALL&gt;150  &lt;/SMALL&gt;    block_data = _ExpandVariable(block_var, specials, params, name)
&lt;SMALL&gt;151  &lt;/SMALL&gt;    if block_data:
&lt;SMALL&gt;152  &lt;/SMALL&gt;      return ExpandTemplate(template, specials, params, name)
&lt;SMALL&gt;153  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;154  &lt;/SMALL&gt;  elif tag_type == FOR_TAG:
&lt;SMALL&gt;155  &lt;/SMALL&gt;    block_data = _ExpandVariable(block_var, specials, params, name)
&lt;SMALL&gt;156  &lt;/SMALL&gt;    return _ExpandFor(tag, template, specials, block_data)
&lt;SMALL&gt;157  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;158  &lt;/SMALL&gt;    _Log(&#39;Error: Invalid block: %s&#39; % (tag,))
&lt;SMALL&gt;159  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;160  &lt;/SMALL&gt;
&lt;SMALL&gt;161  &lt;/SMALL&gt;
&lt;SMALL&gt;162  &lt;/SMALL&gt;def _ExpandInclude(_, filename, template, specials, params, name):
&lt;SMALL&gt;163  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands an include block (or insert the template on an error).&quot;&quot;&quot;
&lt;SMALL&gt;164  &lt;/SMALL&gt;  result = &#39;&#39;
&lt;SMALL&gt;165  &lt;/SMALL&gt;  # replace /s with local file system equivalent
&lt;SMALL&gt;166  &lt;/SMALL&gt;  fname = os.sep + filename.replace(&#39;/&#39;, os.sep)
&lt;SMALL&gt;167  &lt;/SMALL&gt;  f = None
&lt;SMALL&gt;168  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;169  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;170  &lt;/SMALL&gt;      f = gruyere._Open(gruyere.RESOURCE_PATH, fname)
&lt;SMALL&gt;171  &lt;/SMALL&gt;      result = f.read()
&lt;SMALL&gt;172  &lt;/SMALL&gt;    except IOError:
&lt;SMALL&gt;173  &lt;/SMALL&gt;      _Log(&#39;Error: missing filename: %s&#39; % (filename,))
&lt;SMALL&gt;174  &lt;/SMALL&gt;      result = template
&lt;SMALL&gt;175  &lt;/SMALL&gt;  finally:
&lt;SMALL&gt;176  &lt;/SMALL&gt;    if f: f.close()
&lt;SMALL&gt;177  &lt;/SMALL&gt;  return ExpandTemplate(result, specials, params, name)
&lt;SMALL&gt;178  &lt;/SMALL&gt;
&lt;SMALL&gt;179  &lt;/SMALL&gt;
&lt;SMALL&gt;180  &lt;/SMALL&gt;def _ExpandFor(tag, template, specials, block_data):
&lt;SMALL&gt;181  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a for block iterating over the block_data.&quot;&quot;&quot;
&lt;SMALL&gt;182  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;183  &lt;/SMALL&gt;  if operator.isMappingType(block_data):
&lt;SMALL&gt;184  &lt;/SMALL&gt;    for v in block_data:
&lt;SMALL&gt;185  &lt;/SMALL&gt;      result.append(ExpandTemplate(template, specials, block_data[v], v))
&lt;SMALL&gt;186  &lt;/SMALL&gt;  elif operator.isSequenceType(block_data):
&lt;SMALL&gt;187  &lt;/SMALL&gt;    for i in xrange(len(block_data)):
&lt;SMALL&gt;188  &lt;/SMALL&gt;      result.append(ExpandTemplate(template, specials, block_data[i], str(i)))
&lt;SMALL&gt;189  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;190  &lt;/SMALL&gt;    _Log(&#39;Error: Invalid type: %s&#39; % (tag,))
&lt;SMALL&gt;191  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;192  &lt;/SMALL&gt;  return &#39;&#39;.join(result)
&lt;SMALL&gt;193  &lt;/SMALL&gt;
&lt;SMALL&gt;194  &lt;/SMALL&gt;
&lt;SMALL&gt;195  &lt;/SMALL&gt;def _ExpandVariable(var, specials, params, name, default=&#39;&#39;):
&lt;SMALL&gt;196  &lt;/SMALL&gt;  &quot;&quot;&quot;Gets a variable value.&quot;&quot;&quot;
&lt;SMALL&gt;197  &lt;/SMALL&gt;  if var.startswith(&#39;#&#39;):  # this is a comment.
&lt;SMALL&gt;198  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;199  &lt;/SMALL&gt;
&lt;SMALL&gt;200  &lt;/SMALL&gt;  # Strip out leading ! which negates value
&lt;SMALL&gt;201  &lt;/SMALL&gt;  inverted = var.startswith(&#39;!&#39;)
&lt;SMALL&gt;202  &lt;/SMALL&gt;  if inverted:
&lt;SMALL&gt;203  &lt;/SMALL&gt;    var = var[1:]
&lt;SMALL&gt;204  &lt;/SMALL&gt;
&lt;SMALL&gt;205  &lt;/SMALL&gt;  # Strip out trailing :&amp;lt;escaper&amp;gt;
&lt;SMALL&gt;206  &lt;/SMALL&gt;  escaper_name = None
&lt;SMALL&gt;207  &lt;/SMALL&gt;  if var.find(&#39;:&#39;) &amp;gt;= 0:
&lt;SMALL&gt;208  &lt;/SMALL&gt;    (var, escaper_name) = var.split(&#39;:&#39;, 1)
&lt;SMALL&gt;209  &lt;/SMALL&gt;
&lt;SMALL&gt;210  &lt;/SMALL&gt;  value = _ExpandValue(var, specials, params, name, default)
&lt;SMALL&gt;211  &lt;/SMALL&gt;  if inverted:
&lt;SMALL&gt;212  &lt;/SMALL&gt;    value = not value
&lt;SMALL&gt;213  &lt;/SMALL&gt;
&lt;SMALL&gt;214  &lt;/SMALL&gt;  if escaper_name == &#39;text&#39;:
&lt;SMALL&gt;215  &lt;/SMALL&gt;    value = cgi.escape(str(value))
&lt;SMALL&gt;216  &lt;/SMALL&gt;  elif escaper_name == &#39;html&#39;:
&lt;SMALL&gt;217  &lt;/SMALL&gt;    value = sanitize.SanitizeHtml(str(value))
&lt;SMALL&gt;218  &lt;/SMALL&gt;  elif escaper_name == &#39;pprint&#39;:  # for debugging
&lt;SMALL&gt;219  &lt;/SMALL&gt;    value = &#39;&amp;lt;pre&amp;gt;&#39; + cgi.escape(pprint.pformat(value)) + &#39;&amp;lt;/pre&amp;gt;&#39;
&lt;SMALL&gt;220  &lt;/SMALL&gt;
&lt;SMALL&gt;221  &lt;/SMALL&gt;  if value is None:
&lt;SMALL&gt;222  &lt;/SMALL&gt;    value = &#39;&#39;
&lt;SMALL&gt;223  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;224  &lt;/SMALL&gt;
&lt;SMALL&gt;225  &lt;/SMALL&gt;
&lt;SMALL&gt;226  &lt;/SMALL&gt;def _ExpandValue(var, specials, params, name, default):
&lt;SMALL&gt;227  &lt;/SMALL&gt;  &quot;&quot;&quot;Expand one value.
&lt;SMALL&gt;228  &lt;/SMALL&gt;
&lt;SMALL&gt;229  &lt;/SMALL&gt;  This expands the &amp;lt;field&amp;gt;.&amp;lt;field&amp;gt;...&amp;lt;field&amp;gt; part of the variable
&lt;SMALL&gt;230  &lt;/SMALL&gt;  expansion. A field may be of the form *&amp;lt;param&amp;gt; to use the value
&lt;SMALL&gt;231  &lt;/SMALL&gt;  of a parameter as the field name.
&lt;SMALL&gt;232  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;233  &lt;/SMALL&gt;  if var == &#39;_key&#39;:
&lt;SMALL&gt;234  &lt;/SMALL&gt;    return name
&lt;SMALL&gt;235  &lt;/SMALL&gt;  elif var == &#39;_this&#39;:
&lt;SMALL&gt;236  &lt;/SMALL&gt;    return params
&lt;SMALL&gt;237  &lt;/SMALL&gt;  if var.startswith(&#39;_&#39;):
&lt;SMALL&gt;238  &lt;/SMALL&gt;    value = specials
&lt;SMALL&gt;239  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;240  &lt;/SMALL&gt;    value = params
&lt;SMALL&gt;241  &lt;/SMALL&gt;
&lt;SMALL&gt;242  &lt;/SMALL&gt;  for v in var.split(&#39;.&#39;):
&lt;SMALL&gt;243  &lt;/SMALL&gt;    if v == &#39;*_this&#39;:
&lt;SMALL&gt;244  &lt;/SMALL&gt;      v = params
&lt;SMALL&gt;245  &lt;/SMALL&gt;    if v.startswith(&#39;*&#39;):
&lt;SMALL&gt;246  &lt;/SMALL&gt;      v = _GetValue(specials[&#39;_params&#39;], v[1:])
&lt;SMALL&gt;247  &lt;/SMALL&gt;      if operator.isSequenceType(v):
&lt;SMALL&gt;248  &lt;/SMALL&gt;        v = v[0]  # reduce repeated url param to single value
&lt;SMALL&gt;249  &lt;/SMALL&gt;    value = _GetValue(value, str(v), default)
&lt;SMALL&gt;250  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;251  &lt;/SMALL&gt;
&lt;SMALL&gt;252  &lt;/SMALL&gt;
&lt;SMALL&gt;253  &lt;/SMALL&gt;def _GetValue(collection, index, default=&#39;&#39;):
&lt;SMALL&gt;254  &lt;/SMALL&gt;  &quot;&quot;&quot;Gets a single indexed value out of a collection.
&lt;SMALL&gt;255  &lt;/SMALL&gt;
&lt;SMALL&gt;256  &lt;/SMALL&gt;  The index is either a key in a mapping or a numeric index into
&lt;SMALL&gt;257  &lt;/SMALL&gt;  a sequence.
&lt;SMALL&gt;258  &lt;/SMALL&gt;
&lt;SMALL&gt;259  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;260  &lt;/SMALL&gt;    value
&lt;SMALL&gt;261  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;262  &lt;/SMALL&gt;  if operator.isMappingType(collection) and index in collection:
&lt;SMALL&gt;263  &lt;/SMALL&gt;    value = collection[index]
&lt;SMALL&gt;264  &lt;/SMALL&gt;  elif (operator.isSequenceType(collection) and index.isdigit() and
&lt;SMALL&gt;265  &lt;/SMALL&gt;        int(index) &amp;lt; len(collection)):
&lt;SMALL&gt;266  &lt;/SMALL&gt;    value = collection[int(index)]
&lt;SMALL&gt;267  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;268  &lt;/SMALL&gt;    value = default
&lt;SMALL&gt;269  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;270  &lt;/SMALL&gt;
&lt;SMALL&gt;271  &lt;/SMALL&gt;
&lt;SMALL&gt;272  &lt;/SMALL&gt;def _Cond(test, if_true, if_false):
&lt;SMALL&gt;273  &lt;/SMALL&gt;  &quot;&quot;&quot;Substitute for &#39;if_true if test else if_false&#39; in Python 2.4.&quot;&quot;&quot;
&lt;SMALL&gt;274  &lt;/SMALL&gt;  if test:
&lt;SMALL&gt;275  &lt;/SMALL&gt;    return if_true
&lt;SMALL&gt;276  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;277  &lt;/SMALL&gt;    return if_false
&lt;SMALL&gt;278  &lt;/SMALL&gt;
&lt;SMALL&gt;279  &lt;/SMALL&gt;
&lt;SMALL&gt;280  &lt;/SMALL&gt;def _FindTag(template, open_marker, close_marker):
&lt;SMALL&gt;281  &lt;/SMALL&gt;  &quot;&quot;&quot;Finds a single tag.
&lt;SMALL&gt;282  &lt;/SMALL&gt;
&lt;SMALL&gt;283  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;284  &lt;/SMALL&gt;    template: the template to search.
&lt;SMALL&gt;285  &lt;/SMALL&gt;    open_marker: the start of the tag (e.g., &#39;{{&#39;).
&lt;SMALL&gt;286  &lt;/SMALL&gt;    close_marker: the end of the tag (e.g., &#39;}}&#39;).
&lt;SMALL&gt;287  &lt;/SMALL&gt;
&lt;SMALL&gt;288  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;289  &lt;/SMALL&gt;    (tag, pos1, pos2) where the tag has the open and close markers
&lt;SMALL&gt;290  &lt;/SMALL&gt;    stripped off and pos1 is the start of the tag and pos2 is the end of
&lt;SMALL&gt;291  &lt;/SMALL&gt;    the tag. Returns (None, None, None) if there is no tag found.
&lt;SMALL&gt;292  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;293  &lt;/SMALL&gt;  open_pos = template.find(open_marker)
&lt;SMALL&gt;294  &lt;/SMALL&gt;  close_pos = template.find(close_marker, open_pos)
&lt;SMALL&gt;295  &lt;/SMALL&gt;  if open_pos &amp;lt; 0 or close_pos &amp;lt; 0 or open_pos &amp;gt; close_pos:
&lt;SMALL&gt;296  &lt;/SMALL&gt;    return (None, None, None)
&lt;SMALL&gt;297  &lt;/SMALL&gt;  return (template[open_pos + len(open_marker):close_pos],
&lt;SMALL&gt;298  &lt;/SMALL&gt;          open_pos,
&lt;SMALL&gt;299  &lt;/SMALL&gt;          close_pos + len(close_marker))
&lt;SMALL&gt;300  &lt;/SMALL&gt;
&lt;SMALL&gt;301  &lt;/SMALL&gt;
&lt;SMALL&gt;302  &lt;/SMALL&gt;def _Log(message):
&lt;SMALL&gt;303  &lt;/SMALL&gt;  logging.warning(&#39;%s&#39;, message)
&lt;SMALL&gt;304  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, message
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/dump.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e4d1e30a8ceca7ff5f654c59da406ace
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1337

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1337 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/dump.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Debug Dump&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;&amp;lt;table&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_cookie:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_cookie:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_profile:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_profile:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_db:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_db:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (386 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/editprofile.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1d60ea05e529be938ae661eb148168e9
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 7482

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (7482 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/editprofile.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Profile&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;div&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;&amp;lt;h2&amp;gt;Gruyere: Profile&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt; 17  &lt;/SMALL&gt;  &amp;lt;h3&amp;gt;Add a new account or edit an existing account.&amp;lt;/h3&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt; 19  &lt;/SMALL&gt;[[if:!_cookie.is_admin]]
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;h3&amp;gt;Edit your profile.&amp;lt;/h3&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;[[/if:!_cookie.is_admin]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;[[if:_message]]
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;div class=&#39;message&#39;&amp;gt;{{_message}}&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;[[/if:_message]]
&lt;SMALL&gt; 25  &lt;/SMALL&gt;
&lt;SMALL&gt; 26  &lt;/SMALL&gt;&amp;lt;form method=&#39;get&#39; action=&#39;/{{_unique_id}}/saveprofile&#39;&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;&amp;lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;update&#39;&amp;gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;&amp;lt;table&amp;gt;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 30  &lt;/SMALL&gt;    User id:
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 32  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt; 33  &lt;/SMALL&gt;  [[if:uid]]
&lt;SMALL&gt; 34  &lt;/SMALL&gt;    &amp;lt;input type=&#39;hidden&#39; name=&#39;uid&#39; value=&#39;{{uid.0}}&#39;&amp;gt;
&lt;SMALL&gt; 35  &lt;/SMALL&gt;    {{uid.0}}
&lt;SMALL&gt; 36  &lt;/SMALL&gt;  [[/if:uid]]
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  [[if:!uid]]
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    &amp;lt;input type=&#39;hidden&#39; name=&#39;uid&#39; value=&#39;{{_cookie.uid}}&#39;&amp;gt;
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    {{_cookie.uid}}
&lt;SMALL&gt; 40  &lt;/SMALL&gt;  [[/if:!uid]]
&lt;SMALL&gt; 41  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt; 42  &lt;/SMALL&gt;[[if:!_cookie.is_admin]]
&lt;SMALL&gt; 43  &lt;/SMALL&gt;  [[if:_cookie.uid]]
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    {{_cookie.uid}}
&lt;SMALL&gt; 45  &lt;/SMALL&gt;  [[/if:_cookie.uid]]
&lt;SMALL&gt; 46  &lt;/SMALL&gt;  [[if:!_cookie.uid]]
&lt;SMALL&gt; 47  &lt;/SMALL&gt;      &amp;amp;lt;not logged in&amp;amp;gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;  [[/if:!_cookie.uid]]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;[[/if:!_cookie.is_admin]]
&lt;SMALL&gt; 50  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;    User name:
&lt;SMALL&gt; 53  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.name:text}}[[/if:uid]][[if:!uid]]{{_profile.name:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;      name=&#39;name&#39; maxlength=&#39;16&#39;&amp;gt;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;    OLD Password:
&lt;SMALL&gt; 60  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 61  &lt;/SMALL&gt;    &amp;lt;input type=&#39;password&#39; name=&#39;oldpw&#39;&amp;gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 64  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 65  &lt;/SMALL&gt;    NEW Password:
&lt;SMALL&gt; 66  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;    &amp;lt;input type=&#39;password&#39; name=&#39;pw&#39;&amp;gt;
&lt;SMALL&gt; 68  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;&amp;lt;span style=&quot;color:red&quot;&amp;gt;&amp;lt;b&amp;gt;WARNING: Gruyere is not secure.&amp;lt;br&amp;gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;    Do not use a password that you use for any real service.&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 70  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;    Icon:
&lt;SMALL&gt; 73  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.icon:text}}[[/if:uid]][[if:!uid]]{{_profile.icon:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 76  &lt;/SMALL&gt;      value=&#39;{{_profile.icon:text}}&#39;
&lt;SMALL&gt; 77  &lt;/SMALL&gt;      name=&#39;icon&#39;&amp;gt;
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    (32x32 image, URL to image location)
&lt;SMALL&gt; 79  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 80  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 81  &lt;/SMALL&gt;    Homepage:
&lt;SMALL&gt; 82  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 83  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39; size=&#39;50&#39;
&lt;SMALL&gt; 84  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.web_site:text}}[[/if:uid]][[if:!uid]]{{_profile.web_site:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;      name=&#39;web_site&#39;&amp;gt;
&lt;SMALL&gt; 86  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 88  &lt;/SMALL&gt;    Profile Color:
&lt;SMALL&gt; 89  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 90  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 91  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.color:text}}[[/if:uid]][[if:!uid]]{{_profile.color:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 92  &lt;/SMALL&gt;      name=&#39;color&#39;&amp;gt;
&lt;SMALL&gt; 93  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 95  &lt;/SMALL&gt;    Private Snippet:
&lt;SMALL&gt; 96  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;    &amp;lt;textarea name=&#39;private_snippet&#39; rows=&#39;10&#39; style=&#39;width:100%&#39;&amp;gt;[[if:uid]]{{_db.*uid.private_snippet}}[[/if:uid]][[if:!uid]]{{_profile.private_snippet}}[[/if:!uid]]&amp;lt;/textarea&amp;gt;
&lt;SMALL&gt; 98  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 99  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt;100  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;101  &lt;/SMALL&gt;    Is admin:
&lt;SMALL&gt;102  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;103  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;104  &lt;/SMALL&gt;      [[if:uid]][[if:_db.*uid.is_admin]]checked[[/if:_db.*uid.is_admin]][[/if:uid]]
&lt;SMALL&gt;105  &lt;/SMALL&gt;      [[if:!uid]][[if:_profile.is_admin]]checked[[/if:_profile.is_admin]][[/if:!uid]]
&lt;SMALL&gt;106  &lt;/SMALL&gt;      name=&#39;is_admin&#39; value=&#39;True&#39;&amp;gt;Yes
&lt;SMALL&gt;107  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;108  &lt;/SMALL&gt;      [[if:uid]][[if:!_db.*uid.is_admin]]checked[[/if:!_db.*uid.is_admin]][[/if:uid]]
&lt;SMALL&gt;109  &lt;/SMALL&gt;      [[if:!uid]][[if:!_profile.is_admin]]checked[[/if:!_profile.is_admin]][[/if:!uid]]
&lt;SMALL&gt;110  &lt;/SMALL&gt;      name=&#39;is_admin&#39; value=&#39;False&#39;&amp;gt;No
&lt;SMALL&gt;111  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;112  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;113  &lt;/SMALL&gt;    Is author:
&lt;SMALL&gt;114  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;115  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;116  &lt;/SMALL&gt;      [[if:uid]][[if:_db.*uid.is_author]]checked[[/if:_db.*uid.is_author]][[/if:uid]]
&lt;SMALL&gt;117  &lt;/SMALL&gt;      [[if:!uid]][[if:_profile.is_author]]checked[[/if:_profile.is_author]][[/if:!uid]]
&lt;SMALL&gt;118  &lt;/SMALL&gt;      name=&#39;is_author&#39; value=&#39;True&#39;&amp;gt;Yes
&lt;SMALL&gt;119  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;120  &lt;/SMALL&gt;      [[if:uid]][[if:!_db.*uid.is_author]]checked[[/if:!_db.*uid.is_author]][[/if:uid]]
&lt;SMALL&gt;121  &lt;/SMALL&gt;      [[if:!uid]][[if:!_profile.is_author]]checked[[/if:!_profile.is_author]][[/if:!uid]]
&lt;SMALL&gt;122  &lt;/SMALL&gt;      name=&#39;is_author&#39; value=&#39;False&#39;&amp;gt;No
&lt;SMALL&gt;123  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;124  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt;125  &lt;/SMALL&gt;
&lt;SMALL&gt;126  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td align=&#39;left&#39;&amp;gt;
&lt;SMALL&gt;127  &lt;/SMALL&gt;    &amp;lt;input type=&#39;submit&#39; value=&#39;Update&#39;&amp;gt;
&lt;SMALL&gt;128  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;129  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt;130  &lt;/SMALL&gt;&amp;lt;/form&amp;gt;
&lt;SMALL&gt;131  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt;132  &lt;/SMALL&gt;
&lt;SMALL&gt;133  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt;134  &lt;/SMALL&gt;
&lt;SMALL&gt;135  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/error.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (374 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/error.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/error.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 5370f567b6b301a17108b2fc16b0be71
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 975

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (975 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/error.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Error&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;[[if:_message]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div class=&#39;message&#39;&amp;gt;{{_message}}&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;[[/if:_message]]
&lt;SMALL&gt; 15  &lt;/SMALL&gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/feed.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/feed.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/feed.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 9c8677b65512748760eacd4a5970f9b2
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 1769

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1769 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/feed.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;{{# Copyright 2017 Google Inc. }}
&lt;SMALL&gt;  2  &lt;/SMALL&gt;_feed((
&lt;SMALL&gt;  3  &lt;/SMALL&gt;{{# with a uid parameter, get one user&#39;s snippets
&lt;SMALL&gt;  4  &lt;/SMALL&gt;    returns [name, snippet, ...]
&lt;SMALL&gt;  5  &lt;/SMALL&gt;The first entry is the user&#39;s name and the remaining entries are
&lt;SMALL&gt;  6  &lt;/SMALL&gt;the user&#39;s snippets, in order from most recent to least recent.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;}}
&lt;SMALL&gt;  8  &lt;/SMALL&gt;[[if:uid]]
&lt;SMALL&gt;  9  &lt;/SMALL&gt;[
&lt;SMALL&gt; 10  &lt;/SMALL&gt;&quot;[[if:_db.*uid]]{{_db.*uid.name}}[[/if:_db.*uid]][[if:!_db.*uid]]{{uid.0}}[[/if:!_db.*uid]]&quot;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;[[if:_db.*uid.snippets.0]][[for:_db.*uid.snippets]]
&lt;SMALL&gt; 12  &lt;/SMALL&gt;,&quot;{{_this:html}}&quot;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;[[/for:_db.*uid.snippets]][[/if:_db.*uid.snippets.0]]
&lt;SMALL&gt; 14  &lt;/SMALL&gt;]
&lt;SMALL&gt; 15  &lt;/SMALL&gt;[[/if:uid]]
&lt;SMALL&gt; 16  &lt;/SMALL&gt;{{# without a uid parameter, get one snippet from each user 
&lt;SMALL&gt; 17  &lt;/SMALL&gt;    returns {&#39;private_snippet&#39;:snippet, user:snippet, ...}
&lt;SMALL&gt; 18  &lt;/SMALL&gt;The first entry is the logged in user&#39;s private snippet.
&lt;SMALL&gt; 19  &lt;/SMALL&gt;The rest of the entries are all the other users&#39; most recent snippet.
&lt;SMALL&gt; 20  &lt;/SMALL&gt;}}
&lt;SMALL&gt; 21  &lt;/SMALL&gt;[[if:!uid]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;{
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&quot;private_snippet&quot;:
&lt;SMALL&gt; 24  &lt;/SMALL&gt;  &quot;{{_profile.private_snippet:html}}&quot;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;[[for:_db]]
&lt;SMALL&gt; 26  &lt;/SMALL&gt;[[if:is_author]][[if:snippets.0]],&quot;{{_key}}&quot;:
&lt;SMALL&gt; 27  &lt;/SMALL&gt;  &quot;{{snippets.0:html}}&quot;[[/if:snippets.0]][[/if:is_author]][[/for:_db]]
&lt;SMALL&gt; 28  &lt;/SMALL&gt;}
&lt;SMALL&gt; 29  &lt;/SMALL&gt;[[/if:!uid]]
&lt;SMALL&gt; 30  &lt;/SMALL&gt;))
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/home.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/home.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/home.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 454e99f94e863b5a127a5f88a6bccf29
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3533

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3533 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/home.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Home&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;script src=&quot;/{{_unique_id}}/lib.js&quot; text=&quot;text/javascript&quot;&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;&amp;lt;/script&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;&amp;lt;h2 class=&#39;has-refresh&#39;&amp;gt;Gruyere: Home&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;div class=&#39;refresh&#39;&amp;gt;&amp;lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;{{_unique_id}}&quot;)&#39; href=&#39;#&#39;&amp;gt;Refresh&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;table width=&#39;100%&#39;&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;[[if:_profile.private_snippet]]
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;      Private&amp;amp;nbsp;snippet&amp;amp;nbsp;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 26  &lt;/SMALL&gt;      &amp;lt;a class=&#39;button&#39; id=&#39;show&#39; onclick=&#39;_showHide(&quot;show&quot;, &quot;hide&quot;)&#39; href=&#39;#&#39;&amp;gt;Show &amp;amp;#9658;&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;      &amp;lt;span id=&#39;hide&#39; style=&#39;display: none;&#39;&amp;gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;      &amp;lt;a class=&#39;button&#39; onclick=&#39;_showHide(&quot;show&quot;, &quot;hide&quot;)&#39; href=&#39;#&#39;&amp;gt;Hide &amp;amp;#9668;&amp;lt;/a&amp;gt; &amp;amp;nbsp;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;      &amp;lt;span id=&#39;private_snippet&#39;&amp;gt;{{_profile.private_snippet:html}}&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 30  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 32  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td colspan=&#39;3&#39;&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 33  &lt;/SMALL&gt;[[/if:_profile.private_snippet]]
&lt;SMALL&gt; 34  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td colspan=&#39;3&#39;&amp;gt;&amp;lt;b&amp;gt;Most recent snippets:&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 35  &lt;/SMALL&gt;[[for:_db]]
&lt;SMALL&gt; 36  &lt;/SMALL&gt;[[if:is_author]][[if:snippets.0]]
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 39  &lt;/SMALL&gt;     [[if:icon]]&amp;lt;img alt=&#39;&#39; height=&#39;32&#39; width=&#39;32&#39; src=&#39;{{icon:text}}&#39;&amp;gt;[[/if:icon]]
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 41  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 42  &lt;/SMALL&gt;      &amp;lt;b&amp;gt;&amp;lt;span style=&#39;color:{{color:text}}&#39;&amp;gt;[[if:name]]{{name:text}}[[/if:name]][[if:!name]]{{_key}}[[/if:!name]]&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;
&lt;SMALL&gt; 43  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    &amp;lt;td width=&#39;100%&#39;&amp;gt;&amp;lt;span id=&#39;{{_key}}&#39;&amp;gt;{{snippets.0:html}}&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;          &amp;lt;a href=&#39;/{{_unique_id}}/snippets.gtl?uid={{_key}}&#39;&amp;gt;All snippets&amp;lt;/a&amp;gt;&amp;amp;nbsp;
&lt;SMALL&gt; 47  &lt;/SMALL&gt;      &amp;lt;a href=&#39;{{web_site:text}}&#39;&amp;gt;Homepage&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 49  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;[[/if:snippets.0]][[/if:is_author]]
&lt;SMALL&gt; 53  &lt;/SMALL&gt;[[/for:_db]]
&lt;SMALL&gt; 54  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/manage.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (376 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/manage.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/manage.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 75d92dd608c87fa22869f17184f9e78b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1499

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1499 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/manage.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Profile&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;h2&amp;gt;Gruyere: Manage the server&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;&amp;lt;form method=&#39;get&#39; action=&#39;/{{_unique_id}}/editprofile.gtl&#39;&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;p&amp;gt;Edit a user&#39;s profile:
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;input type=&#39;text&#39; name=&#39;uid&#39;&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;    &amp;lt;input type=&#39;submit&#39; value=&#39;Edit&#39;&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;&amp;lt;/form&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;&amp;lt;p&amp;gt;&amp;lt;a href=&#39;/{{_unique_id}}/reset&#39;&amp;gt;Reset the server&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;&amp;lt;p&amp;gt;&amp;lt;a href=&#39;/{{_unique_id}}/quitserver&#39;&amp;gt;Quit the server&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/menubar.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (378 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/menubar.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/menubar.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 03aeee793d5591ca311e44ce0fc71d52
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1889

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1889 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/menubar.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;{{# Copyright 2017 Google Inc. }}
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;div class=&#39;menu&#39;&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;  &amp;lt;span id=&#39;menu-left&#39;&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;    &amp;lt;a href=&#39;/{{_unique_id}}/&#39;&amp;gt;Home&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;      [[if:_cookie.uid]]
&lt;SMALL&gt;  6  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/snippets.gtl&#39;&amp;gt;My&amp;amp;nbsp;Snippets&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/newsnippet.gtl&#39;&amp;gt;New&amp;amp;nbsp;Snippet&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/upload.gtl&#39;&amp;gt;Upload&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;      [[/if:_cookie.uid]]
&lt;SMALL&gt; 10  &lt;/SMALL&gt;  &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;  &amp;lt;span id=&#39;menu-right&#39;&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;      [[if:_cookie.uid]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;      &amp;lt;span class=&#39;menu-user&#39;&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;        {{_profile.name:text}} &amp;amp;lt;{{_cookie.uid}}&amp;amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;      &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;      [[if:_cookie.is_admin]]
&lt;SMALL&gt; 17  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/manage.gtl&#39;&amp;gt;Manage this server&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;      [[/if:_cookie.is_admin]]
&lt;SMALL&gt; 19  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/editprofile.gtl&#39;&amp;gt;Profile&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/logout&#39;&amp;gt;Sign out&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;      [[/if:_cookie.uid]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;      [[if:!_cookie.uid]]
&lt;SMALL&gt; 23  &lt;/SMALL&gt;      &amp;lt;a href=&#39;/{{_unique_id}}/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;      [[/if:!_cookie.uid]]
&lt;SMALL&gt; 26  &lt;/SMALL&gt;  &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/sanitize.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (358 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/sanitize.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?sanitize.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 9dd5b1c65862d4f29f531d8a7622300e
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 4996

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (4996 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;sanitize.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;HTML sanitizer for Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import re
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;def SanitizeHtml(s):
&lt;SMALL&gt; 26  &lt;/SMALL&gt;  &quot;&quot;&quot;Makes html safe for embedding in a document.
&lt;SMALL&gt; 27  &lt;/SMALL&gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;  Filters the html to exclude all but a small subset of html by
&lt;SMALL&gt; 29  &lt;/SMALL&gt;  removing script tags/attributes.
&lt;SMALL&gt; 30  &lt;/SMALL&gt;
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 32  &lt;/SMALL&gt;    s: some html to sanitize.
&lt;SMALL&gt; 33  &lt;/SMALL&gt;
&lt;SMALL&gt; 34  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 35  &lt;/SMALL&gt;    The html with all unsafe html removed.
&lt;SMALL&gt; 36  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  processed = &#39;&#39;
&lt;SMALL&gt; 38  &lt;/SMALL&gt;  while s:
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    start = s.find(&#39;&amp;lt;&#39;)
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    if start &amp;gt;= 0:
&lt;SMALL&gt; 41  &lt;/SMALL&gt;      end = s.find(&#39;&amp;gt;&#39;, start)
&lt;SMALL&gt; 42  &lt;/SMALL&gt;      if end &amp;gt;= 0:
&lt;SMALL&gt; 43  &lt;/SMALL&gt;        before = s[:start]
&lt;SMALL&gt; 44  &lt;/SMALL&gt;        tag = s[start:end+1]
&lt;SMALL&gt; 45  &lt;/SMALL&gt;        after = s[end+1:]
&lt;SMALL&gt; 46  &lt;/SMALL&gt;      else:
&lt;SMALL&gt; 47  &lt;/SMALL&gt;        before = s[:start]
&lt;SMALL&gt; 48  &lt;/SMALL&gt;        tag = s[start:]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;        after = &#39;&#39;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;    else:
&lt;SMALL&gt; 51  &lt;/SMALL&gt;      before = s
&lt;SMALL&gt; 52  &lt;/SMALL&gt;      tag = &#39;&#39;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;      after = &#39;&#39;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;    processed += before + _SanitizeTag(tag)
&lt;SMALL&gt; 56  &lt;/SMALL&gt;    s = after
&lt;SMALL&gt; 57  &lt;/SMALL&gt;  return processed
&lt;SMALL&gt; 58  &lt;/SMALL&gt;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;
&lt;SMALL&gt; 60  &lt;/SMALL&gt;TAG_RE = re.compile(r&#39;&amp;lt;(.*?)(\s|&amp;gt;)&#39;)  # matches the start of an html tag
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;def _SanitizeTag(t):
&lt;SMALL&gt; 64  &lt;/SMALL&gt;  &quot;&quot;&quot;Sanitizes a single html tag.
&lt;SMALL&gt; 65  &lt;/SMALL&gt;
&lt;SMALL&gt; 66  &lt;/SMALL&gt;  This does both a &#39;whitelist&#39; for
&lt;SMALL&gt; 67  &lt;/SMALL&gt;  the allowed tags and a &#39;blacklist&#39; for the disallowed attributes.
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 70  &lt;/SMALL&gt;    t: a tag to sanitize.
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 73  &lt;/SMALL&gt;    a safe tag.
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;  allowed_tags = [
&lt;SMALL&gt; 76  &lt;/SMALL&gt;      &#39;a&#39;, &#39;b&#39;, &#39;big&#39;, &#39;br&#39;, &#39;center&#39;, &#39;code&#39;, &#39;em&#39;, &#39;h1&#39;, &#39;h2&#39;, &#39;h3&#39;,
&lt;SMALL&gt; 77  &lt;/SMALL&gt;      &#39;h4&#39;, &#39;h5&#39;, &#39;h6&#39;, &#39;hr&#39;, &#39;i&#39;, &#39;img&#39;, &#39;li&#39;, &#39;ol&#39;, &#39;p&#39;, &#39;s&#39;, &#39;small&#39;,
&lt;SMALL&gt; 78  &lt;/SMALL&gt;      &#39;span&#39;, &#39;strong&#39;, &#39;table&#39;, &#39;td&#39;, &#39;tr&#39;, &#39;u&#39;, &#39;ul&#39;,
&lt;SMALL&gt; 79  &lt;/SMALL&gt;  ]
&lt;SMALL&gt; 80  &lt;/SMALL&gt;  disallowed_attributes = [
&lt;SMALL&gt; 81  &lt;/SMALL&gt;      &#39;onblur&#39;, &#39;onchange&#39;, &#39;onclick&#39;, &#39;ondblclick&#39;, &#39;onfocus&#39;,
&lt;SMALL&gt; 82  &lt;/SMALL&gt;      &#39;onkeydown&#39;, &#39;onkeypress&#39;, &#39;onkeyup&#39;, &#39;onload&#39;, &#39;onmousedown&#39;,
&lt;SMALL&gt; 83  &lt;/SMALL&gt;      &#39;onmousemove&#39;, &#39;onmouseout&#39;, &#39;onmouseup&#39;, &#39;onreset&#39;,
&lt;SMALL&gt; 84  &lt;/SMALL&gt;      &#39;onselect&#39;, &#39;onsubmit&#39;, &#39;onunload&#39;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;  ]
&lt;SMALL&gt; 86  &lt;/SMALL&gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;  # Extract the tag name and make sure it&#39;s allowed.
&lt;SMALL&gt; 88  &lt;/SMALL&gt;  if t.startswith(&#39;&amp;lt;/&#39;):
&lt;SMALL&gt; 89  &lt;/SMALL&gt;    return t
&lt;SMALL&gt; 90  &lt;/SMALL&gt;  m = TAG_RE.match(t)
&lt;SMALL&gt; 91  &lt;/SMALL&gt;  if m is None:
&lt;SMALL&gt; 92  &lt;/SMALL&gt;    return t
&lt;SMALL&gt; 93  &lt;/SMALL&gt;  tag_name = m.group(1)
&lt;SMALL&gt; 94  &lt;/SMALL&gt;  if tag_name not in allowed_tags:
&lt;SMALL&gt; 95  &lt;/SMALL&gt;    t = t[:m.start(1)] + &#39;blocked&#39; + t[m.end(1):]
&lt;SMALL&gt; 96  &lt;/SMALL&gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;  # This is a bit heavy handed but we want to be sure we don&#39;t
&lt;SMALL&gt; 98  &lt;/SMALL&gt;  # allow any to get through.
&lt;SMALL&gt; 99  &lt;/SMALL&gt;  for a in disallowed_attributes:
&lt;SMALL&gt;100  &lt;/SMALL&gt;    t = t.replace(a, &#39;blocked&#39;)
&lt;SMALL&gt;101  &lt;/SMALL&gt;  return t
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 12a118c39683a405007f41af38c3cef8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 13686

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: ffee62320f5f7cefeffd0f80699246d8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 37564

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1407b1742a076b846f7e30b01fc4cf60
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 29253

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 4f63cf082e004e6cac6bc4ca207ce19e
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 24149

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 35f51fbbbb4fdbac8f6d4b6a16367b2c
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 25303

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/start</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (280 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/start HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (354 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
Set-Cookie: GRUYERE_ID=582835734666354056417651491707595504272; Path=/
X-Cloud-Trace-Context: 67d04bd02f8536859132b553f36e14a6
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 681
Expires: Sun, 15 May 2022 13:19:57 GMT

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (681 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
    
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Start Gruyere&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Start Gruyere&lt;/H1&gt;
    Your Gruyere instance id is 582835734666354056417651491707595504272.

    &lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;

    &lt;br&gt;&lt;br&gt;By using Gruyere you agree to the
    &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;terms of service&lt;/A&gt;.

    &lt;H2&gt;&lt;A HREF=&quot;/582835734666354056417651491707595504272&quot;&gt;Agree &amp;amp; Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/codeindex.html</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (351 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/codeindex.html HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (308 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 47bbc44854c132230b9b6b9bd6d93dcd
Content-Encoding: gzip
Server: Google Frontend
Content-Length: 582
Date: Sun, 15 May 2022 13:20:02 GMT
Expires: Sun, 15 May 2022 13:30:02 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: text/html
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (582 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;STYLE&gt;
a {color:black; text-decoration:none}
a:visited{color:#6600cc;}
a:focus, a:hover {color:#003399; text-decoration: underline;}
a:active{color:#cc33cc;}
big {color: #660066; }
&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;TT&gt;
&lt;B&gt;&lt;BIG&gt;&lt;BIG&gt;Gruyere&lt;BR&gt;Code&lt;/BIG&gt;&lt;/BIG&gt;&lt;/B&gt;&lt;BR&gt;&lt;BR&gt;
&lt;A href=&quot;/code/gruyere.py&quot; target=&quot;codepage&quot;&gt;gruyere.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/data.py&quot; target=&quot;codepage&quot;&gt;data.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/sanitize.py&quot; target=&quot;codepage&quot;&gt;sanitize.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/gtl.py&quot; target=&quot;codepage&quot;&gt;gtl.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/secret.txt&quot; target=&quot;codepage&quot;&gt;secret.txt&lt;/A&gt;&lt;BR&gt;
&lt;BR&gt;
resources/&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/base.css&quot; target=&quot;codepage&quot;&gt;base.css&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/dump.gtl&quot; target=&quot;codepage&quot;&gt;dump.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/editprofile.gtl&quot; target=&quot;codepage&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/error.gtl&quot; target=&quot;codepage&quot;&gt;error.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/feed.gtl&quot; target=&quot;codepage&quot;&gt;feed.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/home.gtl&quot; target=&quot;codepage&quot;&gt;home.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/lib.js&quot; target=&quot;codepage&quot;&gt;lib.js&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/login.gtl&quot; target=&quot;codepage&quot;&gt;login.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/manage.gtl&quot; target=&quot;codepage&quot;&gt;manage.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/menubar.gtl&quot; target=&quot;codepage&quot;&gt;menubar.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/newaccount.gtl&quot; target=&quot;codepage&quot;&gt;newaccount.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/newsnippet.gtl&quot; target=&quot;codepage&quot;&gt;newsnippet.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/showprofile.gtl&quot; target=&quot;codepage&quot;&gt;showprofile.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/snippets.gtl&quot; target=&quot;codepage&quot;&gt;snippets.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/upload.gtl&quot; target=&quot;codepage&quot;&gt;upload.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/upload2.gtl&quot; target=&quot;codepage&quot;&gt;upload2.gtl&lt;/A&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;I&gt;&lt;A href=&quot;/gruyere-code.zip&quot; target=&quot;_top&quot;&gt;Download zip file&lt;/A&gt;&lt;/I&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;A href=&quot;/&quot; target=&quot;_top&quot;&gt;&amp;lt;&amp;lt; back to codelab&lt;/A&gt;
&lt;/TT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking">WSTG-v42-CLNT-09</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>X-Frame-Options header is not included in the HTTP response to protect against &#39;ClickJacking&#39; attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (502 bytes)</summary>
				
				<pre><code>POST http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl
Content-Length: 25
Cookie: GRUYERE=; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (25 bytes)</summary>
				
				<pre><code>upload_file=test_file.txt</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
X-Cloud-Trace-Context: 64b5600ff225fbd4e5fec8fa3344b8d5
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 224

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (224 bytes)</summary>
				
				<pre><code>
        &lt;HTML&gt;&lt;BODY&gt;
        &lt;H1 style=&quot;color:red&quot;&gt;Gruyere System Alert&lt;/H1&gt;
        &lt;TT style=&quot;font-size: 150%&quot;&gt;
        Exception: &#39;unicode&#39; object has no attribute &#39;filename&#39;
        &lt;/TT&gt;
        
        &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Frame-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Most modern Web browsers support the X-Frame-Options HTTP header. Ensure it&#39;s set on all web pages returned by your site (if you expect the page to be framed only by pages on your server (e.g. it&#39;s part of a FRAMESET) then you&#39;ll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy&#39;s &quot;frame-ancestors&quot; directive. </p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				
				
				  
				 
				
				
				
				
				<li id="alerts--risk-1-confidence-2">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">Low</span>, <span>Confidence</span>=<span
							class="confidence-level">Medium</span> <span>(111)</span>
					</h3>
					<ol>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">https://google-gruyere.appspot.com</span> <span>(18)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-5">Incomplete or No Cache-control Header Set</a> <span>(6)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (331 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 33537749b2028b9bf13c22aa26ba5f2c
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 11506
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 68642faca77c3cd21d49dee4da457602
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 13686
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 29322522d1b968a3e70b385ad2b8830b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 37564
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e436405686e8a47d09262828f9fddc8
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 29253
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1e89a569badcde4c8a34bb748c9e52ab
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 24149
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses">WSTG-v42-ATHN-06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The cache-control header has not been set properly or is missing, allowing the browser and proxies to cache content.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e1de65e8de11ab80b5e5f9f018599f64
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 25303
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>Cache-Control</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>no-cache</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Whenever possible ensure the cache-control HTTP header is set with no-cache, no-store, must-revalidate.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-7">X-Content-Type-Options Header Missing</a> <span>(12)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (331 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 33537749b2028b9bf13c22aa26ba5f2c
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 11506
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 68642faca77c3cd21d49dee4da457602
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 13686
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 29322522d1b968a3e70b385ad2b8830b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 37564
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e436405686e8a47d09262828f9fddc8
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 29253
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1e89a569badcde4c8a34bb748c9e52ab
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 24149
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e1de65e8de11ab80b5e5f9f018599f64
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 25303
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/cheese_b.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/cheese_b.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (457 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 4edac98117ae19823eb515a2e4212cfc
Server: Google Frontend
Content-Length: 682
Date: Sun, 15 May 2022 13:20:05 GMT
Expires: Sun, 15 May 2022 13:30:05 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (682 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs        IDAT81QGA
DE&quot;	F Q(DPPHDUH$DED&quot;3YT3&gt;H2zSZ] 6SP&amp;D&quot;dFcV[|Y+T*VI:`Xh8nf$i8w~_R[hVVDj5/xL` Avl6dFz+$Px&lt;JR2vt:MB{IR&lt;qrh(X&#39;	n|n3nhW.h4_nGBK&#39;Nx&lt;h`Q+&gt;W_@p\.?IDBXt\\:PTb&#39;IH$:N )zNlp8`h7v_aaNcZBB/9u{:pD3\:    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/cheese_bw.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (347 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/cheese_bw.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (457 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 0eb8a39796202b3e3ab67031883537cc
Server: Google Frontend
Content-Length: 740
Date: Sun, 15 May 2022 13:20:05 GMT
Expires: Sun, 15 May 2022 13:30:05 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (740 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs    6u  ZIDAT8qa,xmPSVVXLYI,,f%hJ,D)C(X(d
Y`S_wwv}9|yf2_c:5,+JVKVzvKRl6mfg2:lf#HD{{{X,tXv;,EG*JzO pjh
O@&lt;O2|zz
 c+.Kjt:v=Zje?f
V+`x|G&gt; H7rJLj5lB!&lt;&gt;&gt;a/c(Jc0j^,3Ib 
F&quot;Rc
L$}##u/*h40*	brd2-,f9Lpfjn~n
u&amp;0r!)F*-p8&lt;[3|ArLryPKj_70w@0~0Ht:&#39;0{b&#39;D&quot;q&gt;5?C;DG`0?V	{ M@    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/cheese_w.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/cheese_w.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (457 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 5bf5c2ef5498d53fe8622179d5874914
Server: Google Frontend
Content-Length: 727
Date: Sun, 15 May 2022 13:20:05 GMT
Expires: Sun, 15 May 2022 13:30:05 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (727 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8*   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs       MIDAT8Ioa}3XZYX 6\AC!
b)TXHechB{kqq^NH$@ xb1I&amp;5j
n;f3m2j%&gt;Tnn%~2x?fc4gY(G^rOOOSRQ#R|&gt;Q*~_XV8BqqTbH|&gt;P(x0BF@0Z-BlRN 5`vbOC|&quot;VUZ,)&lt;D&quot;Q&quot;@{d2to^,pn=[t4`p&lt;f;WPe\@b5^qJV*
rr\&amp;eY
B{C1@zjh4p\0P#}q%4^o$AjT*Euuu0; +
W!()h4Bx(Oa .vR0CL.I&lt;&quot;`0X/ !    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/codelab.css</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (345 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/codelab.css HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (480 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 1c23aa635c35140bfd895f6fdcbc8e31
Content-Encoding: gzip
Server: Google Frontend
Content-Length: 740
Date: Sun, 15 May 2022 13:20:04 GMT
Expires: Sun, 15 May 2022 13:30:04 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: text/css
Age: 1
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (740 bytes)</summary>
				
				<pre><code>body { padding: 0px }
body, th, td, form {
  font-family: Verdana, Arial, Helvetica, sans-serif;
  font-size: 12px;
}
h1, h2, h3, h4, h5 { color: #660066; font-weight: 600; text-align: left; }
h1 { font-size: 18px; }
h2 { font-size: 16px; border-top: 1px solid #e5ecf9; padding-top: 6px; margin-top: 1px}
h3 { font-size: 14px; }
h4 { font-size: 12px; }
h5 { font-size: 11px; }

.banner { border-bottom: 1px solid #e5ecf9; }
hr { border: 1px solid #e5ecf9; }
img { border: none; }

code {
  color: #660000;
  font-size: 110%;
}

pre {
  margin-left: 14px;
  font-family: Courier New, Courier, mono;
  font-size: 110%;
  color: #660000;
  background-color: #e5ecf9;
  border: 1px solid #e5ecf9;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding-left: 1em;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  overflow: auto;
}
pre p {margin: 0em}

@media print {
  code, pre {color: black; }
  pre {
    background-color: white;
    border: 1px solid black;
  }
}

table     { border: 0;border-collapse: collapse; }
th        { padding-right: 4px; padding-left: 4px; }
td        { padding-right: 4px; padding-left: 4px; vertical-align: top; text-align: left; }
td.right  { text-align: right; }
td.center { text-align: center; }
td.centered { vertical-align: middle; text-align: center; }

a { color: #2244ff; text-decoration: none}
a:visited { color: #cc33cc; }
a:focus, a:hover { color: #0000ff; text-decoration: underline; }
a:active { color: #cc33cc; }

div.column2 {
  margin-bottom: 0px;
  background-color: white;
}

div.column1 {
  width: 250px;
  float: right;
  background-color: #E5ECF9;
  padding: 5px;
  padding-left: 4px;
  margin: 0;
  margin-right: 5px;
  margin-left: 15px;
}

li.L1 { margin-left: -20px; padding-top: 6px; }
li.L2 { margin-left: -24px; }
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/gruyere-78.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (348 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/gruyere-78.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (458 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: f712b6c0c29a724740fc08c21b0e7729
Server: Google Frontend
Content-Length: 2527
Date: Sun, 15 May 2022 13:20:05 GMT
Expires: Sun, 15 May 2022 13:30:05 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2527 bytes)</summary>
				
				<pre><code>PNG

   IHDR   N   N   J   gAMA  a   sRGB     cHRM  z&amp;         u0  `  :  pQ&lt;  	]IDATxmUEYne!CDPD}@S}( !B$
E	E${WM707w{s{k{y&lt;l 7-hG;qp/~7kWmh@L5u~l)x~dGwwO|R@:_m0xa;P	8y0VstdoN7LcT]oy2ssX3BPSm	L[g*uaeU;sCE+Hc nvgiyuJV8P^eGc:7&#39;i)T&#39;:r-aT/0Me^Pq C9&gt;#M&lt;-(TEurfN7%&gt;|5=:Q[,*s% /K/Qu2N;5Xq)9^&quot;r2[3KlMT.ipyrn |5G1+{~4%&#39;FO*W0lCwq,J J)fd\M}&quot;oWP+$F)lT{	i_A(11MM8O(JOoGHd/{
&lt;NAR,;q02#bd7`f[dtM5uWx!ySVK19&lt;|=p]\P&gt;Gfk$f%T=6Xe&quot;9v1IcWM`|ipWWGD|N,k@57. `	~~#GK/%_6J_3+&lt;nBf*edB?9csDHyk@Jv	1&lt;&#39;|M\:Pj`l:WT]+:6r-yCN4IoX~L*oRb13wR`2;,o&quot; &gt;=1jg&amp;tf$M&gt;N%NV&#39;j&quot;DNg9G$M)|6rq	&amp;&amp;XI
6MU%y&gt;B&quot;g\NPF@r6F_.Rp&quot;\Jik`2]!J,&quot;VTA1jklHK)P:T`d0-gk)3\@ngS2\zdhan.@]&#39;.D1?C77gt;U2\`]1*!~1J
$7)]44&#39;vY?o&#39;EKHKq5#j6Uuax1@*PU{&#39;nfjJS~bZOQ6hU!-ZPUM8@g$BV/W\%NWCL)Uc!mJKe8U0_UbfO8gdDhxTo*kKj11F0*l&quot;&lt;2nR%8GmPjKrrmoayAnYd&quot;&gt;:`aj. }dnY@EK35N:m	j.ALgS)K;kbj)~6qOoZiAcc3O.xgAdBIm*D9&amp;}W,p`mFAj8(GlpdTT1!IRdJVKig!TM8TMq7~aSKPRDYc6mwo|+RGEn$[s|xt
L7ozma&gt;8)z y*yr3IN
]tP8;YO zU*FszWkz#&#39;\g@*Sx&gt;euv |w.MjWyP)RQpe a8s!YLOJhj+qE$#.2Uu=H`AMy[y_W9~1q&quot;;|{QvZ6p;hQxq,~f\Jv(	2ZzT~[5PU-    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/static/gruyere.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (345 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/static/gruyere.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (459 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: a0497e77e904e6508e1fc99b0d84026f
Server: Google Frontend
Content-Length: 40079
Date: Sun, 15 May 2022 13:20:04 GMT
Expires: Sun, 15 May 2022 13:30:04 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (40079 bytes)</summary>
				
				<pre><code>PNG

   IHDR    Z      sRGB    gAMA  a    cHRM  z&amp;         u0  `  :  pQ&lt;  IDATx^iEz&gt;us]]mkw;S  (X
KAeP,@(

((d&#39;32sGfFfF;?+txOD}yy@ @ @ @d;wSI{	sgxN  @$nzlxiyg&lt;5\ee1{ceN~	@ @ @ &lt;w(6Eh5H&lt;&gt;:^&amp;tIp
  &lt;xk%	9n&#39;%UUU#RNKQT&amp;@*OgVQP/YE*_fE&#39;/}&#39;YAB(Wgj;&gt;:]iPl^];%z]VZzZ;.wKml&amp;]4y{No7@)GB/)-DY;+y&gt;$_yV+v^ufcSg[d$&lt;?mImSkfW4qiJR(Awukigr[+Sk#_Z8+o\Kp	/&amp;2I?{wG9+9S;w&#39;S3ONo&lt;N76#rs: ]OmJ%Iv]ZEx]QCq&amp;M1oG  t?v361Y+;_w;[vzy e~kMm|sVu~t(EZ}$je\.it0N;{GzIj2T?+\9p~onhwwn&gt;tnw=AG^=5^unMs3CYu?=[=:e	}uG{&#39;4_LSQ:q;)&gt;qGX{(VgD7/Nmq$  H7]If1sllustdw9s3#O|t=X4C;{&gt;X{N\,OB&#39;_$;),,S&lt;;QMlI&#39;&gt;=yH     nlZk_vy;(to|upFv|$mxnM,3Y?|?&lt;&amp;tZM$Mzwum&gt;}&amp;0aS	IVs%;]e^bI|&lt;{=PlM&amp;|r IdPy:/	*lXb_TD__tlm:?ffn&gt;f:{u,~j}t4u}62+oxxvEe6gX%jw]e_S%kjQ&quot;lpc?=tA&amp;}|f-\&#39;lGLmyP &lt;,~=//.&#39;&#39;~sCxweHvwq+/jiS7qwiYsMA3=}Y=U&#39;78qr]9|_u\e{;,X({8n3GLj&#39;hOif.IUJV%_g.|?Xag9L\|xo}Fc0M;}^v#tnys;;oTO?[N:?7tV-5GozcSq;nr=mq&gt;=qWd]R!?G?R2|i{Q	tl*FGDwg&#39;Zi7hHnK^5g&lt;w# ^]OTOAO7[LhzcOOrf&#39;ZOi0/|[k\Y;8(&lt;`L[wN|eQUo*w,IT+y\\SC.M&gt;,rlO=o&gt;^cnWkimadRH2UA]~w*&lt;2`=J&#39;itMnqL)UyK{&#39;gpw?wvRlcxp}t*;&amp;C0?Yg|ON#GRt;xt?&amp;):S|)g1O:	u0m0]&gt;dDH(LS&quot;TyVArGf||&amp;7y|k}]0YNUW;+jK!c}&#39;5&#39;cwKb	Nvv/^W&gt;[UurLO3|=T,Pp&lt;w# ^	&#39;uR&lt;(WqD#Q	+BIGks
&amp;Mp{;p;7?o)y{
T/&#39;3odES`WPC]Zcz@Cw:R_/\ekM}?q Q0	uIlVc7T]RVRQdyC1%~3-fKGMm|GO\{&gt;P5g	w~8o}4OG&gt;^n$o3kX&amp;ir&#39;K6RQu4Lmy\?S_Ow{?cH6~S[&amp;6\-&gt;K
uk*_^#J^1sNt|B&#39;4^q~8.~f5M}hx*oX8AYUa_t_\	vL!{#w?T)&gt;UO_lz|$IRN4a^&#39;cz}7~w9:&gt;hwNm{+{w8N5|!rz&gt;~	BR^kG.3&#39;Mj&amp;_o)r_~4/pqHtIe.&#39;M*g?y#Qw&quot;UQ5qV`o:b/0o
ew	3@xR ,KnnoiU/[_0 qBiE~&amp;YSf4y:?\y;y/|)U=wD+hA|1as[SjOCTNA&quot; aVY	mGW&lt;4o	/yJ$[x~N~VKf5~z`SOPzN7ag&gt;|u=no.D=]]nVSPEW,Yf_WUQ\Nw\2&#39;5i2Vz)_]&amp;ir\D;
!&amp;?&gt;?&amp;b$MKzoyli?Wx$8IVk&quot;YaK`{V}Cgk7ykKiNSwNEY5?^0U1n0\wro#&lt;Kz/] / O1Dr(w5%f)O MhNg_,&amp;O^f*)rX~$%O.c|N_i~4fV;b.!]pO{rRZUl:OJ~%NE}`58d6NkQwO;|EX2	3xc!aSgU ~__T{hDy}a* tLG/-57S	.O[?rROR sz_d;_JKG\	K&lt;tZZ7(D,^1&gt;(s(?9A9b	kU(P({&gt;,{9}/uu$Mz5ib(KO83xk5.)doEj&amp;pN?0PNP0.h{xMzL(1we*_s&amp;3:gy3}V%OA2K,%X#(i-+}Ax}k)h(!{:~k3u,&#39;yiBgTHQ$
3/Y/	*lXb_TDIl-xBl){q|&#39;Hz}~v^#$JX	EhyK#gB9v]r&gt;hp=#_7ot}`.wql3#Z{g&amp;tb%JGK(i$Sx&lt;	VWhqN9&quot;in^&gt;\9C|sg._0&#39;
mZ&lt;H !UE	qKz4F![fxId@V\v&#39;i/MD9&amp;!9uNV{Mt:v9Pu{zZmOS9[W?&lt;GHzudl^W)3/,oiXc_&amp;[W&gt;ss^A,[tvhR.U&#39;o{&gt;9;0W{9&amp;E1S&lt;^3r3Ku(;[qVIAN*_dEEs}M8ppiZsQgr77D]voMC$4}kd-b~|)4?__=M&lt;QZ&#39;R183Yn~Bmmb;q&amp;Al$E4A^$	LgkQ3r/yK_iswZ7xiOneD?eJ/ U.&#39;_&gt;(|?&lt;(TBe%UUUwJ{=s&amp;~YzN].:o%o2%Mg6Jtt&gt;~YzgRSkYvB[tHC4_9bI\3/P&amp;JT={	2Q_Bq4&amp;29fStIgc:{pa_BvhC?W?(H!mN=zo/Z0I7\Nv!sxAqqhNqdO2}I61z&gt;Z5t[o{8O3m$6&lt;}&amp;QWmgvNg]e&amp;+==L,P?@KnFu?p?_W;Drb%=%Ls(|JO?Bn)*_fb#}&lt;&quot;
+GrEg}sDI[:}%J*3G?=^?`R&#39;j=x?L&amp;	R
KM`{=2@|eO-v4S]nnVqql&quot;KS&gt;)dJmAB~iB[jVMk*_,L=Q]}(PL*OVUwQ{_|?&lt;6-)_%_o)?&quot;f? O	vTH+t9Lk%*_|3~&gt;E+r&#39;^2*{vg.PqG. @f	\QzZcHc_7nf!2l.#4aH#! eO/!)B6uivsMWTvl      %&amp;pG&gt;1z&#39;Mi?}%/      i}U@kruE&#39;      &quot;lHP$M(st:D5aUW?R|%/t::X9G -p|*eHJF4!3tBS;Nls&lt;jBZQ,52:uBIsrc-&gt;m9f$  JI2&quot;dJYFr&amp;$wRMn?qt9	jEufhs::s?   d8|!S}i&amp;C5]2Y;v5pk[ntTmJTOWB&#39;^h=YRKCAu,B@ @@#IX2(dVxs;5~kG=A:MG)&gt;,=KN{NV!wS?I5zuO44
(xM0 @	@M#6(a_S2+9Ik:ka &amp;&gt;ZNtSQC6nm;&quot;HxG (B&amp;GwA4&lt;QCtG_wUPh,tD7YPB(jH4LBXG$4XzL&lt;G@ @ h
22sF
o=\Y!JiC7.Uk^|TH;&gt;|(tCD5&lt;r46M\wG?LO~\	eY-7vBt-C6M&lt;n?s^W M&lt;&quot;n   ZfdP	oVn)tSo?L54bNRGw7&lt;5/@1]m1NG;txDv4qN-\w#0F8%ZHqImnmfO_&lt;%Vsj&amp;U5{Uz`2?f/[]]TJ5?n[=_8giq:;ia@ bN@&amp;rS	 }kvc{OoG&#39;TMU!?Ts{7uW[KCf&amp;|]x==[S[,mm8	iWR{7}\C_xcQZI&amp;~1e&amp;;#~N&quot;3VqI9bK@ ~Q% Kd K&gt;{oo4F2(Nzihn?z=(He}}&gt;UWvSu=nBWl9I$M*U[;x4C]DG)_t/?|&amp;vF.~e$jCl?nQZ?L~$J^au[w8N?o3tX._]{RcyueTCOpS~Fo_4i]5?eQ&amp;yHw=wVzV	a[}m&gt;nP&amp;a%8s?[rL4kn?N&amp;6Y-eyF8PiNh*g_2#&#39;7==Q/rK GK{]967i~ko{	}KjO=s&quot;uV()$HBiVkRx^opE.	C?dnZ;?fxy}74POa7oss&amp;kl(ML MB3K/Mn-jM),s)RBa ]iHpCo_6LEw\as;{C&gt;&#39;;/&quot;X&quot;N ~W~&gt;	R$d69/H-u/24hbe	i1Kzv5Yy8b/v4?p#(G;gU(*&gt;g$Uat/	S&#39;TO.^oUy_.J(^[U}jBj=jcOnny:^*Ie~lmus,=68|*3Si bpo`2Qw^{a3wNE&amp;gx5aEG|oaz&quot;_zH2VZ	]pq;8V^wqu6Q97wZf,3	th	@-4`oxu:yhV!GO]@dPw{&quot;[=`M!S{3^&lt;@f2zY:|\kt&gt;zi-u=@0*Iu5:s\7rM`E&gt;Cm]k}
o+kz7o:7`&gt;KWk-&#39;0d9t\hM{ikh-TO-o//xUxaf|~^sBa.4_~*Lj$Qs\9Jouxsxww	%3I*4uk\&amp;%C94)[tVKV*y+
/Nzx+0gVdagG)qYu(Kkbe$A  &amp;vK81=to:T2K6g^Y3=W]KthCz-#}{O&gt;q&gt;NJLi
15~1hJASoyCB]I2yk;LN5&lt;fsmjb=nu\{CfT2iw7J&amp;_hLV5[ZF]WJ3o7*@c&amp;-+6\O/ogr/xMJ6KeAxK.xVS#r`5mFA?P6S4$\C,gU34) i/&#39;t|- [LTi{|KQyMT7Ih?p$ _Oy+5d(4xIs&amp;dP1x&amp;}2d9F4j&gt;eI._&amp;.t5wVyozp^{M^%t\Kut[n&#39;][_)7IMHk{:F&gt;}zmTOkDBT~\O`
?^X[FT2D#M	L3yw*)3FM50p,AVVPeD0I&lt;fp7J( q	v/1}c/H$!] _ADkOQzh4q1%_n{Fm?t2+9|&gt;q[G_t fc@BAqCf_KU,_l?GVb6U}]x,&amp;IV~kb&amp;~=,?n}UwN)st#m?&amp;/&amp;`kgxkdqTC4V{WUwLxuajsg|LB~;;^R?\~OSp,4qV&amp;I]	(cn&amp;SUm41O&lt;S/ki&quot;ELRFP&gt;4Ljwir.e_;rz=0cufxJ2	i&quot;ToW8KW9f^7xuCb1^lK[Mn)H!(jk2O%ov-eVr~Xo.?&gt;&gt;J[HEYZSTCQgR^zmZ
e7&gt;_?pCPHe7&gt;W|;}N*VN9N-6#]4&amp;nLVabX4L=L&quot;[df
U4+	ai)v&amp;r8#5;7DKhee{@2~_/	FjS}$Bf7g-&#39;/(/wM9z0g(%CS&quot;.p/SmUwOY7{4B[tnH_X&amp;aO#K[GhoZQz}2ORCN8f[ZjWgiV;J52cKlK:lNn{ZCTx}uY]zt!bGNt-yeTs{K6y3gR?_uM/./i60;&gt;MX(r`B^~`ykYGjP	qG4O=eKlFSj,
B
5-200b&amp;`qlN,sJqSdPV\1p`Z:v|?2~3x]qF(`f|-&amp;mqbpu~r4ih9Ecg.W.k8&lt;!Q$l-g&gt;5Z3SLoy[^~&gt;#?o;5,Buq;gO`e_V5/hB%&amp;
buh
au	]D7p$AL&#39;^Vjb}?jLScYlZ3X^!9 p*~,o@B`#&amp;I} @n^3f@
o,io;r[
iU7q&amp;irK9_zLt3!]&#39;sv&amp;
q	&amp;ID:pLK-g\DG,	w:s(=cKZy%RFg?_S0pF]._[v#go|ioWo:G+QxGx@-ELs&quot;Us:T{Y?%_~F^~:8@i=%2+9|=[)b7&#39;.Wj)K9_+_|/wM=E|929oyMW	j&lt;}-g;Del{K~!3}&#39;_p]N~!z]c	_,\/Hy|WdsXz{XS|	 ?%$=&quot;*V!&#39; @u2+9|&amp;OWsm=oRHL}{`|PK?b2
t\IU&amp;t4ih&amp;EsAgKtji`GwS[?vNK
m4BQZ6VyYvm|8fx]4 b|)S|lK4	g@j@M8YS#?:%lbY@	l._.mj&gt;o&amp;kORCdk7KGVA#(;iB4wRF#By[!$MR3!   ;494&amp;Bf7g\DIxi2?!,;Uuk};	bns_SF#Bw&gt;.9b=xMb$B   4P&lt;,HlJ
o2Cj&gt;4yh^
;JDI-];Vllq+PGb)j.eM]Z&#39;jQ[#Hj^4@ RIjoYUupb(fE7`_&amp;4zzh/N7.&gt;cB&amp;vF5+&gt;Um5x|v&lt;xv!MR9Q  i&quot;Hd8~dYv%151bM%=-][;mo~tOK+\jBZQ,5UmZ[5v1Jg:rjXj45,^}	@ @ V5t][6&quot;Sd$(b$n6&amp;Xkj-4cJ{tQ|F2j&gt;S|r^=Ym|d\Bmj&gt;E?MlC$DdIOqY|V#sf`?eo]!&lt;n$/vK#xXZMGiid@ @ @ B!fY$Mxn$   (6&amp;tk|TiH7   #@[T EVonlpM`	EF  `	&amp;N7W&amp;k]H      }0V`!in  J`0Qp&amp;IQ&gt; @l,YNbmI&amp;+t_9jeg4%L_Kq     2F}+UV{&amp;;DIZJ]s:A @ @ ~T&amp;CjHh:kO_&gt;OR`SXeC%Hfs  w,el,K	Z:3&amp;p^~x&#39;(q5p{%[~u(unK97,4Se#C	 @xv2Rf3tdX:Igoi4)lo:kO$8~;\l~}e#_&gt;#4pq&gt;NZ,MRaq@ @ m2*`&#39;qPa`&#39;;+$+xx.]xW~o|&#39;V~V~J	Q1y@4Oj7r.=N|_    ;
8b4upn{}zA,N5^KsZXL9@3V-d	INk=/nT7;oN&amp;gz~(R.A4$/6]KmRR+P&#39;\S(JQ   V#Bf0fGty5KT6Wgf?b1F!Kb-u#T_OA!!V-m3h8t2ws|d77aQ)[W*rE\ct	]    A	5rM$M&lt;c[t8bBCdbg-4P9J&amp;n%;4CeFqdI.1Is	0&gt;&gt;*MR	tV.Pl0a(j  $52*,tzA^+#ib`xS_:;[dk25yd^VQrt7-7(]&quot;aIX&amp;\vWx_#%v4gTkNa5JTdC6  X(,nTlfJ&#39;,MD#L4R5
1Yg^,5&gt;
zHkKX
!M(Vm:;#8&quot;d1AsUZ+j7[(  O?me2p]jk1b:-b^mNV?jX8&amp;3Yg`&amp;i3zZ9@5z=49)=QxXX:RD  -e6&#39;T5),r=}|#?z4NTq&quot;  J`2[POc\kO8Ux6   m?S	+y4C&lt;k,d  tuXsz  ]-1I!X&lt;i  C`cse&amp;tdbMdF  H{S6GxxnC5A  X	dmy0X&lt;x      K`S)1lN1l	     &amp;	@ @ @ JF@55H       P2i[zB       @5[@ @ @ F&lt;`!@ @ @ @ MbKyq-  &#39;L@   7tOZ  @`Ntb:    0i     #&amp;1      4  Ay=Gl]Mg@ @ @ @D?/    &amp;tb*&amp;@ @ @ D:I&#39;V     PJj8		  @`0&amp;t@ @ @ bD a1tZ     OaH   yMIf^Q+  (%(y;H      Y#P~+tv&#39;^   &quot;4ydnC+XF=      $P4_9reqkb&lt;  @	~QAQnTi.   O :in&amp;     &amp;$  H(b@ @ @@    In4   		  @@f@)   @@    In2   		  @@f@)   @@   @vISm~M/n]]qiE~l   Lu*h$/$h_[[}iEbJV&gt;ekZzI$g|m/J_p)[i!M M. `NGsV\+}^$M+;	I$&#39; d}umm8i7B]9KWkBsgYz,~,^   I#oO}&amp;)^`Nz%_YDdILVFuiX]~74JKqUL6sufcCt  I$/~fi&quot;T:4=[hX9J5Go4qN`9iR.n1jL{Ge  $ &amp;[.aY?KpEDD	iBw3.Ms&amp;dUZn@{Ch&#39;.&gt;3&amp;/4Wo./Wx9   J9!\R	?7!4vkm7.&#39;In4-ep1icl&gt;GwYv-  JvZe:[bM
y{4- %)WAf (;q#$FM4\*
rJN&gt;W}u&gt;
   # \ M$&#39;tL3.&amp;hD)*Lx9i/&amp;cPk
iUDN 0Ac0KcQnUW:}MFh%Y^8W{ !`A+1&amp;&gt;&quot;ok%\zX)&quot;5s`G.kYLaK_3  lk-Y5MpZ[*r3pabv	      &amp;P`+t|Ew41XkBY1L  &amp;^1QI&amp;j{iR#QA @ RD}N&gt;&gt;@5)e5CP&gt;wt=	%  $@!B[w`+	_C&quot;n	I(K  &quot;	)L%R     y&amp;&amp;      1&quot; i   		  @@f@)   @_tw.NJx@ @ @ MR%M4d|k5TK(*    )&amp;&amp;(BCd@cA @ B $)anR   IIPI?$h  @)	@$JXd
Z    )&amp; iw(EW=Z6!_9  !$ib5#V$-,eeH&quot;?  	kEu.&lt;jj:[Lk
n Q&#39;.&amp;Vg     .%$&lt; M? n&lt;     WW&quot;V%\^,myY     )&#39;K/#JH-JLt.F   IPY+Ebkl:Z@ @ E MI9d
59A-J#ZjG  @	@&amp;$&amp;\J	T	2@ @x&amp;~VbJm:I-aC@ @# i&quot;mf2d@a  +H9i&gt;N.9tqo,  }.D^J(  @xWmK22&gt;AW8 C $=	(&lt;TFX HiBn
NN@ @ JB D$MK:ZI    $ i&quot;&amp;5;    E4tW\:TW!^@ @ x&amp;f3btaxN2j	@ @ 2&amp;4q$X)CW  D@ D&amp;%:X 8@ A D5!.KrViN*7`On@*@0i
*    f&amp;KwW.|ZV@ @ 4q+M$u	y2  84qAKqR     @&gt;B__ty`0q d@	 B@:R  #ei&quot;Z&quot;:&quot;t Ja~C:YAqOA JH D2ja(3&gt;P   &gt;&amp;QNjF @*dSewNI
Z  &quot;=i81gLE/
Ksq @eLapDAe @	dO%F8, T4Axf{3`r   |&amp;%p8.  &#39;%i3Y:T:XE\[ HLIa lbnUVvp@ @ dIfs5zegF  ?2#MkK)g\@ RA ;65%)j\@ O 39e)#|\@ F D&lt;}EzC)dNK)Wb{u.g*yvcd (	H)Y84Ad
O{B$I*o+]&amp;yl&quot;s\}^^R{s#C@y&gt; E t/i6~$NiR&lt;C 1&quot;iz;es:u	S*&gt;IQ4zMQw4	1&lt;F,F8ToT)S-/&amp;%&amp; &quot;,H&amp;Ys7RCxiR&#39;:^RE $TZpXW	@HUR&gt;4&quot;Ii~(D2\lOhUX8NrkMZ9fmr}&gt;nQlAvB9DD{oc/}&quot;H4	q\&lt;M#eigw,cul:&amp;/GN`QgJ&#39;&amp;nA,!48hKb	dOzY^&quot;a?iGdt;$gY]m&amp;J$8[o+-^pbR&amp;&gt;6wE4C OmQQN/im|=3&amp;/dHrvx-ZxZ#[gpQJn&quot;rXBUs=&lt;4$2(Mg/M&quot;PV)STaKi/lO,m~bh=V[{/&#39;`H48ICH^jO6p0N)!H{=-&quot;,lR f5&lt;+^T&gt;C#+K&quot;^Q4Vj}^,CxNX3XDr[Q$MduYJzXC1
L02PzB+$ i\&amp;&lt;D^HWS}jkMC4b=&lt;i&quot;5=AJ	IFWH $ 8HB&amp;&amp;R{B+ak(lfBbD&amp;.lmc9	
&amp;i&quot;&#39;zB+$ i\@Hi&quot; qj#M1}c6&amp;8-tyg&amp;+&amp;l/,&gt;&quot;n24kIFWH $G&#39;B$P4)n_O/rmB Mm}UR&quot;WL	I,
@XibtTnR^9c-Yw%#(;tS5}IT*=JkRhib6ji&quot;SNWX*,zG:45)YO_=NK: .6i&amp;m4)k&#39;.^%7^+4]!C#!tHp~I8WTK&gt;2/MBG&quot;Vuq[Q4/NbEfz7#]ErxRz-cG32W/6]txT0V	&#39;{/0@ MBX$irvEJ,r\[&quot;:)+
Oi&quot;BIOyi 6I5k,v@@@H`LQ4o[Jf\6&#39;?i&quot;
F6G$i].(~C&#39;	nxt}tY87&amp; IisC&quot;:b~moX-Fa}{MDs/G(MHvjP44)!y{w
OfpmKnLG\x8	!/p+&amp;BP%@WpBG&lt;7v4b\AiR\!G M.c/MQoY&#39;hLU&#39;5\*E&gt;z
kp9OE\#s5q +I duI-&#39;F-4	u-sAA-^&amp;[|F`&lt;&amp;
 WL{XZe&amp;l|_0H@y	dOPf3mfdm2E! $@	xz ~HbZ YP   g&amp;4, M&lt;|o @	d@`&amp;C+&lt;oG ;,HDG&lt;&#39;,e,NH,LJD
WI	V&gt;KrYn(.
  4AI4?a*n l4.A$l4R)B#p?W @9dC`*}$S M~P HH[$,MJA94)Zo:.  dD6^NhS$t@ @ I!M`N9eK @dG`N|9I@ ]-M0P,t|	   L&amp;9q	 H,LIc 4!3Yb3@ @ 2&amp;M&gt;2o]b6&#39;FYpQ 4`h	\&amp;P!    	dL8q:&quot;@ dPq
`$ $44U2Y    )M84W 44qr`pHxD%A @2+MgG+K@ @ dU8:NYKp*{=ih) M aGbmv~@ @ 2,M&#39;xlS9qrD!(b_q

@ JM l-?N4P(NS9e_0
v o-AGr  Y%yihPG&amp;
5~r
A eZHk$Fl	  ~@NDHH*dKO4Rf   j&amp;L8 $;J/J P&lt;2 @ &amp;cBbuIi9;&#39;w{xL;{J=P  	gwN|8RV	-|++WBf 41bgu%32!5%5 4VFQ],	SXd}@ RG DHuK%&lt;OI d H[wYbUuRdg  )&quot; iCLAq%nu( Bo	  q&quot; i25d8%(nG.A @@ +)g&quot;?Q8P!   |&amp;&quot;eOnMI`GR~RN $ 4Q&lt;KUS9(.5  y&amp;r[}K%}r%l   ?&amp;~LN6V&gt;$=/
  MHw@i#v-VKkYmE.Nyh d I ;mML%4R	9p**qDH4O+*
Su\^Z.r9zaEMqiKOau5IQRI&#39;s[U8{pu(	giI]P9M$CO	{o)Wrx.r&gt;,Xp@&lt;	D`_
CERH&quot;(&gt;J4
)p}b4]Cc&#39; &amp;uQKjOu)tMQ$*Jh2BY	IBo&amp;/&#39;~21|fT[b8`QkgW}04)D
	8CGV~JalDpRLiIo)r@f	8I-:K.IuZ^HV0iiGN M JQNTs@!C!MS!DH70Xk^h2b?Q_TwX}
$libqZe*nI|q&gt;}cu.FXmB0l 8bKYbcUo?:994fd1fjL6)SV&amp;Q.&amp;)dAM $Izt8A q:9psH
&gt;[D!@uN+Cdc!MJbOD$YbHa(Tzg?Pa DN$TM(&amp;9N0c&quot;&amp;uD[^gEbD&lt;}$DJ@ka.!G
x54+$bU}RhDU&gt;n]	  gN+t2;cM[nkbW^sXV6gi1o
KJR@Y8kB_~d&amp;@BDpHt_$G+p|$T4I~ ,_ MRKpW%
FBBIq,	r^{k X8ttq4IaMI:.Zm-he44,DBdE4XHHfY&amp;x	A @ 
 MbC #Hp p% i
i&gt;    44ojFxM0 @&amp;?Gy*)B6@ A8$PH4mHt9@ &quot;&amp;xL	X&amp;&amp;p= @	$@W@@||Sci#I@ @ 	FK,1(*	 H(:GrLG!#@@&amp;&amp;)$`&amp;dyNv.I &quot;HTY{FkII I $$]Qw9t D4IaNt)-A&quot;P
H(HHK\xa  4IaNL)4-]U 8&amp;&amp;$`7I&amp;e*~	@0/HA@fsW&quot; HHHG*q@ x&amp;59$
  &amp;#  6ILR@ k	#Y=&amp;	\&amp;h8d 	I	qIFg2K $9oq:V$yr
@ @@q4C0 4Ia
8lh5hNj+b!A V!M M2A@A%.5?[@  M`uU+9=p$  ~	@@d@|*wA~ 4a@#tB8$LB @1 M M2DiZ&#39;nI$kaQ12H,wtW&#39;%  &#39; ii9n%._&#39;&amp; )HHSR
ar7QO 44()PB{M/I x4aYP~MS-(;d  %&amp; iiiDsZ,]%IDlV[HMN:M[%0oX\.IY7Cs@ 	d\4TOLjr.Ku9D+Vzt|{:Q|~(,o
d  $ iI~M8}4a&#39;/40JRq47&amp;&quot;/GI*&#39;a
5RA H D+.5:PW^+B&amp;u9VlRIw.{t4+&gt;7e@ O D&amp;a#Wc-i&amp;M|*&quot;n&amp;^n4i&amp;ANv~8?yV	w
?fw2y%&#39;7UJ#k2YK8NbI`O2j Pz&amp;4F6vN5~kEf!V]ip.(A3QIOsR\G	q(`^&quot;8KCr	DdJ ;eZKE	$M JJ?  &#39; i7M6Iw04)
:hHD0A30W%[e&gt;vik	9l4\NR
$U&amp;4|W:jNXusc&amp;hR+Z[z,=4&quot;  !McIl&amp;L13s(4_!b1MCv@NA rGi4syz:*$U%2v4@R@	@7&lt;(NNbBC5&gt;)K~yibZ\0z
Q%0xS$`KI!5	B-kv2   &amp;i&amp;GYf,)M[#f(JKfm*Sw%#M9	&amp;b) MD0&amp;  +&amp;`D_&quot;-,[+9PWwSx4N+DH^=\+  p@fr93XE{R6!$q_#%1A(O{7aHJB&amp;BqT@ E &amp;;Vm&amp;)Y:yYl$0OV^cjtHc	(:qbhZe2PKwm\@ &amp; ib)Hf&amp;MQ/z5)A;q.(^&quot;5c=Jg$&quot;M,QzM#nw9v	?
 @@&amp;V&gt;`M90&amp;U{puX@-|$De7U/U\VpdV96khA @ $&amp;],/&quot;;xw@ @ I Mt-Y MWA @  M2qSi MWA @  M2q!MRA }@ 2A $@ @ B @ @ @ F Mbt3gQO   		  @@fD@Q2  $ 		  @@f$E     HH   4Nd  H
HH   4HE=A @ @ :&amp;&amp;      1&quot; iE     &amp;&amp;      1&quot; i=z  @t M M@ @ @ bD $F7#:A @ @ ) M|HV.os]}k=~k]7sQ2yV]{	5K+*Q\Xfmm}*G&gt;&lt;|C&quot;jTDJ60pV.G#0 &#39;J&amp;r]Y7&amp;iuF	Y&amp; Ljjqer:$VE&quot;M+jC+%u9WLIuRt|FR+{1VC[YM$7|GV M&lt;omS!}J	f,&quot;i?5yvT&lt;:T[gdTUitKd#ee56`,k[ufuN(&lt;Y(=3=D|_w-&lt;VBM8WXX^LVx
@1T:jt/m@2JH2F:S,CnsH+^QN!VV|X_PQgwS|8%Gn?#57h_^&#39;tF\+^a:sS^5@.$EmEEWxP*sCR4&quot;# M#$6c-(D?2H&quot;~tQNek^a&amp;M@lKp4g2t@[LtQ00i4U.&quot;UW(oib4=5
3T9kS~yep&amp;FsLgu]GuZivf?R}{.1&amp; i}m%guH	2cs.M=vmHjhpmk/J|&#39;2kWWW_WO8:{v!akI@g~^SJE((N_V*C\0K3W;
}4dv-NxvKAX;&quot;-ejID4;T5QZJEd(Xk&amp;B&amp;5PeReC}&quot;)H.A0&lt;Vwe9pw\\@@pN&gt;j%&amp;6fvn/WiQ\Xv_{ZX%8H	@x :DEeyvF&amp;Y(qBG:09K$1wcppyyP6}[WkW W7rM7N&lt;=rG!M~4~@X50c(s^J,M[g&#39;vX%e-\sEX(&#39;A&lt;&quot;Mu~HEj_?u.&lt;jj:\z*KW5qtTxD	Sx:JJ}HLh4Zx%?iTbBO^]jibD+V4&gt;s=&amp;/E9Q/A?VgBIY-SR,MX&lt;lq2q$ytLArlxpq&lt;O};Z\q7o(CZs&lt;os4!u&amp;@}&amp;tjUs7~rC&amp;tw0S3(P[zPHb&amp;LdFI4q
0vwrq~9l:FPVla-$uuwksY~&gt;CoTQfLBo&amp;I$9 &amp;+njh&#39;ytql!?kThu&lt;]^&amp;lO(aM ZS&#39;8S=N)4K^!OLmXiaQvfcVdD2^R|}w*r+iR(%&gt;&quot;-&amp;NEyn|b&gt;;p2QmVQ&#39;^Ohw[n~$@QFLA~&amp;O
Xm*E?G F^rGjfh`*4fMfjEdptQ+^!&lt;W
K71`iva=G/[u&#39;G3):W(s77J@	QS^E(I&amp;&lt;&amp;l4yn*9@^Mc;W)U&amp;.#n{Ocu4?\
E~f--BsxK&amp;r8{|-weK3rE3s0r&gt;5D vS )&#39;FAW(5w#QD4Cz-2t?`[zqiM_CCI]8lHI+pSp-=U&#39;|%xpR$Fqv4H.-JK	HK4!%t5qq&#39;&amp;)c`&lt;].H&lt;~O%Ed\s(P]L/8@kR5pO	e	N$~@ @ @@K\= /M4&quot;
]?@ @ 2@ j]B4qp@d;z\d  H7.)&gt;N,4HH  H5`^c0$1/h &#39;&quot;	i]Yp?ga|&amp;~_[b1mUe\DXCj5-XX[   uQ(N#M4avbauY&amp;B&quot;I\\@	XUT5a%+PuP9T]^EkI]t796]I)iaj2E&gt;uQs$A_.LI1!`yM=}#r@)&#39;xMbK-|bJk$,I&amp;#dG echR.MQlW&#39;J.q]Y(ZX1&amp;(=n	}L&amp;KCA,zFOq{6?|i3gQB}r;FRT1j$tN3q@LGu*&#39;}\$#v_qe_=(SK5h4Y35`VS=j6L7x&amp;jnv\g&lt;&#39;lRI`M]k4q$Vne S6I&#39;hVcZ9iUD&lt;$G2uIajI&amp;&amp;P! 3yAm&gt;4X?0:[&amp;qJ$b*Y7{f?^r!M:JA~o\ H?[=2\)70T#(5Pr:2^Ih#dL5mP5AI|&amp;MlN:0j 5U~mEo7cvibYlw8gP}j5-
}$2~#Db4#9&gt;@{;Y$`ud*Hg&amp;z|IS%qBh4H&gt;vIiB @4K)X&gt;#9~0DxMD6w)HnGj)|$@xIr M$oYy0ErNu=U#ux_&amp;SD\k*M
Tkdo\&quot;%PF	&amp;2a+~s9%D[Hl&amp;?9k^XIb$Vas0/i7?Qp1mX]:|&#39;yeiBaF8n[)	&#39;MN&lt; P:2D[	I&amp;OqN!O	wRgI9]at
;&amp;M0!#y(h%-M5^mth)!&amp; DE-=yP&quot;G&#39;q*bD[(5ND&#39;^\&amp;]I.&#39;
3Y2sy8D[m&quot;XK=RZ`^:{.E22 a4U41s5 C%^ybr$s7X}XZx&amp;t,+Im^U}:1(v$pyXp#w51-u&#39;7sdR&#39;tljk!,#2bBG^-A	xXv%y@O#&amp;L_z!6U2u{
_#	 Pfe4)s	g=&amp;&amp;r^17 P~e4)&#39;6g93Cr&quot;4B#6K;  K$MJ6&amp;	@ @ 2B&amp;@   \j#A @ @ q}@ @ @@#K=@ @ @54kSA=!@ @ @ 2^@+	 8F	&lt;x      zB,[c_E   8l	z$   V8G
akN4@ @\0Xt  liX.   6R&#39;UEe@ @ RL$MNA@@ @ bE [`z   6_,&amp;+   #HXHH   &amp;wRiRe(  x#a]=		  @@4Aw  )s:%_Bi     `&quot;P9HtG   4Aw  p&amp;%4Aw  aK@ @ @&amp;Mt@;   X&#39;%S&#39;&amp;      &quot;ibqjsXHtG   18N MA @ @ 	{L@;   8qRaC&amp;.w=G?nWee%UUU6ttW|&amp;x*TQf$   R(qd|MI7  ;KI;)MT]i]    &amp;, %&quot;W4u	IcD=  $@I`iHH  (&amp;f]i,u  DD ju@WKLi=`#(@ @ bH@N(dq8&#39;YR*y,aA@ @ @ &quot;wb_4HD%C~%X&lt;9  ~&#39;R2D,tIIm|T=ZyUVOn]7R{MAT|1
 krW!C_J%&#39;N(nS&amp;qwMEXa4!R][,.mWQ1N3%(J|0~d=OzTF7S8yP;Q$6O[gY\w3)YTmYyZBHvEUpY*LH;l P&amp;&gt;q(E(2s=4Q&quot;&quot;^?i{b4Z_orI&quot;^#biB}K2=&#39;:Y27&lt;P 	i:g@1JB_TLMW2E
/~4an[KI8i7WmIb.]Onz^,;pX{F9
$|4Z7A)i4dSoc&amp;0_*nic
5U0K};QL)5YoGI`|[Cq:U1cB&#39;{F:cxu(EtiR68D&quot; Mxa&amp;+N&amp;t,S&#39;4@VM-Udvp ]h&gt;r$CdjSc|!M&lt;/GH(ISN{gY_S&lt;f3(M)aNE\G*tb9sI&amp;,0%M$I	&amp;&amp;4G;19:@Mp&gt;	^&quot;U_mN9tj+r#)jNj4\Q&#39;]h7RsvaUfOD&lt;?LqwSy:Y!bd{9OQQ(rcF8lR&gt;cZCk&amp;F`NS29J~=3{YB2a&amp;n8&amp;&quot;ir6oEKpr$~u%Lg
9N41(tR&quot;&amp;!L6;d)DoWdda%gcbM(a,xM.#dD5)4K3$ibKYegq6o	PS&quot;7J8%kbiMoa#f`$DGtQ-a{Mq3__wFx^3C^w]F*tCXz)I#2=@l&amp;!Y)M%9LRHk;Y5SgKOCi!q-JBZD:,m[a[dUIH!MRf8	@x/t!CFcS9	
z+3y-U|XS1- 2)j`t5X?&lt;co0e&amp;t&lt;473`:UXz1&lt;DmP&gt; 4qX@/%M)gN4.V41TzMSBHb`_1b&quot;h+bll}Mn1-CI2HNhA*Fhg$9,t	+i%X[v2J&#39; iR4D$81E&amp;&#39;#%RfmsE&lt;M
)Sv-ivGZY/]X.d`&lt;r%D=Q0ee M&amp;XYi$,H,fVi6xMMV|K$/{.{9ndQ/~lBUY&amp;iI$rN.-uW)o]?\Xo
WGD1NPkT-$R]hA [/.q	SXq)8e    +}9$%N	&#39;iLTA5
IL:&#39; iR@/%	8lcy&lt;B6h @ MB#[(&lt;/\z  # iiKf}
3{ct&quot;8*	4,{PZ%#te(S&amp; _&amp;^A *&gt;Vf^AN  I $*$y-K|Zo PF&amp;&amp; &gt;IM I/\@  M0G$%F##*JlbnMK+Vw_nY`rF@  Mba XX]}ISoLFb(4U&#39;I&amp;w(@A D&amp;&amp;.&amp;fK5)=`u&amp;2 jkb	I.! iRasl${DZ$LL  C $&quot;A}_Q@&#39;-5)piX2y8&lt;3E!&gt;nsfJ#&lt;w5rs7m{3ROh?hiqm2gs I 4z&lt;hU&amp;Wka3Y_TsK9&lt;39dJkj&gt;VM;Fr$e[t%Qr+(I:3=7~%N9iU&lt;  Y&#39; iXX&amp;q^Tnb~KiiA?WWSsZrm5&#39;K}bFmv&quot;@l37p84-20DmtX}SR&amp;q	9$@	@d&amp;W&amp;|36A`&amp;5/vs0Xc:U9^L_eI1!FgJ~R{&gt;W2kM	x$A N $= 4	Lo&amp;lm`0EW8+\&gt;xd`qLB&gt;BD&amp;tk{pG= M&amp;Moyy=mG#	 u&amp;Y.+M[`)q-FDB@brbUcL]q:VG6&#39;4	al4gXOh`X_e.p1=&amp;0?&#39;%M\&gt;&amp;to1tpLIyIPc  &amp;	_N,S+]Na`!`a-T$nWC|$,&amp;}Ixk-j4S^mth}M15fk1
Qa 	@49Q9Dx0~j~Wst-K-dL)u8L|uXKF(ut8&lt;Kes 44I@I|*DT4!#w&#39;SA3^,L?c#p Uk&quot;_ecr&#39;7sCPe594Jrg2}&gt;6ZY  i!5 c7
5.*`d%\u(5HR/i+lV}6G?qia6uH9VGiQ,@@$n%_DJu3_2]&amp;Z qNISD  /&amp;A	x*:tFA7%&gt;+PryL &amp;P@  i r\~l9Sb{P1HHuV$CMnej&amp;C	y@ 	@@@&amp;O`
rE
n&quot; &quot; i,2e! {\XK)@ F lbPq`&#39; &amp;&amp; 4R	F!`N@ B$ i,xPTB	O8-,IhGA M M@7X,H24 oN% i&quot;/M\7  &amp;  v12W!?@	@6K1h\6&amp;x4@ &quot; ii	@kr@  M|%t#aH&lt;  44&amp;OnF 5&amp;Rk&#39;	xM\ DG |44nPF  &amp;:@@)  		&amp; ib\|8%  o~F&quot;`- WAf w&amp;&amp;  #H4  !4	bB(*&amp;i2qpfMhFA  M M@ iu T4	bR(_u*|ud@I:}	 %od &amp;. =o3@d^ P&amp;2!R
f1v# ii	We{F$H(H&lt; DF6t084	h|SQpdu@ M M@ 8f`\F $YZ_A{MRi  		&#39;6H{ l6&quot;Q,d Ip3d  Q44dqVG=| F (nt\ C %BHY&lt;g{p. @k@qxXWj)\&amp;x&quot;@ $ ii!t$q&gt;*RE82E $:p_u} Pv&amp;&amp; OQH:j &lt;   P4HpR5&amp;*NwP HHg(F.E)  0&amp;a%*R&#39;kz)@	@@@d%$ If)YLIbK&quot;(@ 		DB@&amp;$+eu	BLb 6HH1I6~E? 		DE@m-O`(FO	 HRD7&amp;/K_`RIg	uMEmA # iiN}%   HhRt%&#39;o_	RST@ :I&amp;F]Hh@aW&lt; (@}*#(@ 5&quot;}svUVV^RUU5|nMGw5-h*H jF!E2Bb*:@ &quot;t		H9!	$XDJ#}&lt;~/  4)fE9lpiUhW)g@ B JIe@	%BN);(T @ 4k%&#39;8&lt;Bm.Pb  1! i,aF 	$ 44A@$| 	@g0 A)D	z @@@@xJnHB@ @ $&lt;#4A @  M M@ J%EV9/  B&amp;Q% `&#39;Mvoz   I&amp;&amp;      1&quot; i   		  @@f@)   @@    In2   		  @@f@)   @@  	 FcY(&amp;{  @mTHH  ^|	0Rie#  K v7lo*@@  D.VQN MBz   	Q&lt;Y 4Jb		 @P%@I@4	@&amp;f|BKA @@H~vj^0lDI4I  (F{}jcq`BLHH  ibJUaJ%L@:4~ c/6   FY5dQ8YLHpqBA RB&quot;
@nr/G:Z+	iR)@ Li{c//`z@  8aK0q6@DQ}O&#39; i @FHuV`N!InF&gt;h&amp;@Dd&amp;qEF$9ii   `&amp; K7aYdcc
i!	@ @@&#39; h M0$  HxydMQ&#39;)h4    qdA&gt;&lt;&#39;Nw!M0$  xm^I&#39;&gt;)m&quot;RT[HI   y.&lt;Ic)#&amp;7UaI	@ @ @ JF`$BHseg    @ BR$M`@ @ @ @dH~!)I_SO    @y	(:   @LMU    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://google-gruyere.appspot.com</span> <span>(93)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-2">Absence of Anti-CSRF Tokens</a> <span>(7)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;action&quot; &quot;color&quot; &quot;icon&quot; &quot;name&quot; &quot;oldpw&quot; &quot;pw&quot; &quot;web_site&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (470 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 70e7ced65dacb53c46f9e0842534c6aa
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3921

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3921 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Profile&lt;/h2&gt;
&lt;/div&gt;

&lt;div class=&#39;content&#39;&gt;


  &lt;h3&gt;Edit your profile.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;update&#39;&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;td&gt;
    User id:
  &lt;/td&gt;&lt;td&gt;


  
    ZAP
  
  

  &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;ZAP&#39;
      name=&#39;name&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    OLD Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;oldpw&#39;&gt;
  &lt;/td&gt;&lt;td&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    NEW Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Icon:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      value=&#39;&#39;
      name=&#39;icon&#39;&gt;
    (32x32 image, URL to image location)
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Homepage:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; size=&#39;50&#39;
      value=&#39;&#39;
      name=&#39;web_site&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Profile Color:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      name=&#39;color&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Private Snippet:
  &lt;/td&gt;&lt;td&gt;
    &lt;textarea name=&#39;private_snippet&#39; rows=&#39;10&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;left&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Update&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;pw&quot; &quot;uid&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: e3793f9f6caa9b67d4002560e4ee444a
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/login&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;action&quot; &quot;is_author&quot; &quot;pw&quot; &quot;uid&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 184dff1f0053e9050e8c7e5812c1986f
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (469 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 4de0db8f7c0a480fd6330de37dbf7b80
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3076

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3076 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: New Snippet&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: New Snippet&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Add a new snippet.&lt;/h3&gt;



&lt;div style=&#39;width:600&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/newsnippet2&#39;&gt;
&lt;textarea name=&#39;snippet&#39; rows=&#39;5&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;br&gt;
&lt;table summary=&#39;&#39; style=&#39;width:100%&#39;&gt;
&lt;tr&gt;
&lt;td align=&#39;left&#39; valign=&#39;top&#39;&gt;
  &lt;i&gt;Limited HTML is now supported in snippets (e.g., &amp;lt;b&amp;gt;, &amp;lt;i&amp;gt;,
  etc.)!&lt;/i&gt;
&lt;/td&gt;
&lt;td align=&#39;right&#39; valign=&#39;top&#39;&gt;
  &lt;input type=&#39;submit&#39; value=&#39;Submit&#39;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/newsnippet2&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;upload_file&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (465 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 1cce769952da3342423c11528e88b66f
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 2930

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2930 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Upload&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Upload&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Select a file to upload to your account.&lt;/h3&gt;



&lt;div&gt;
&lt;form method=&#39;post&#39; enctype=&#39;multipart/form-data&#39; action=&#39;/425450881661954264328804432207969818728/upload2&#39;&gt;
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;
    &lt;input type=&#39;file&#39; name=&#39;upload_file&#39; size=&#39;50&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td align=&#39;center&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Upload&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;post&#39; enctype=&#39;multipart/form-data&#39; action=&#39;/425450881661954264328804432207969818728/upload2&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;pw&quot; &quot;uid&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: ba1fc60270053cca97a7e64e9599e081
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/login&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery">WSTG-v42-SESS-05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>No Anti-CSRF tokens were found in a HTML submission form.</p>

<p>A cross-site request forgery is an attack that involves forcing a victim to send an HTTP request to a target destination without their knowledge or intent in order to perform an action as the victim. The underlying cause is application functionality using predictable URL/form actions in a repeatable way. The nature of the attack is that CSRF exploits the trust that a web site has for a user. By contrast, cross-site scripting (XSS) exploits the trust that a user has for a web site. Like XSS, CSRF attacks are not necessarily cross-site, but they can be. Cross-site request forgery is also known as CSRF, XSRF, one-click attack, session riding, confused deputy, and sea surf.</p>

<p>CSRF attacks are effective in a number of situations, including:</p>

<p>    * The victim has an active session on the target site.</p>

<p>    * The victim is authenticated via HTTP auth on the target site.</p>

<p>    * The victim is on the same local network as the target site.</p>

<p>CSRF has primarily been used to perform an action against a target site using the victim&#39;s privileges, but recent techniques have been discovered to disclose information by gaining access to the response. The risk of information disclosure is dramatically increased when the target site is vulnerable to XSS, because XSS can be used as a platform for CSRF, allowing the attack to operate within the bounds of the same-origin policy.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>No known Anti-CSRF token [anticsrf, CSRFToken, __RequestVerificationToken, csrfmiddlewaretoken, authenticity_token, OWASP_CSRFTOKEN, anoncsrf, csrf_token, _csrf, _csrfSecret, __csrf_magic, CSRF, _token, _csrf_token] was found in the following HTML form: [Form 1: &quot;action&quot; &quot;is_author&quot; &quot;pw&quot; &quot;uid&quot; ].</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: d0514363ce7ebcfc496a81ce54a0b1c8
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/saveprofile&#39;&gt;</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Phase: Architecture and Design</p>

<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.</p>

<p>For example, use anti-CSRF packages such as the OWASP CSRFGuard.</p>

<p>Phase: Implementation</p>

<p>Ensure that your application is free of cross-site scripting issues, because most CSRF defenses can be bypassed using attacker-controlled script.</p>

<p>Phase: Architecture and Design</p>

<p>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation.</p>

<p>Note that this can be bypassed using XSS.</p>

<p>Use the ESAPI Session Management control.</p>

<p>This control includes a component for CSRF.</p>

<p>Do not use the GET method for any request that triggers a state change.</p>

<p>Phase: Implementation</p>

<p>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-3">Cookie No HttpOnly Flag</a> <span>(5)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the HttpOnly flag, which means that the cookie can be accessed by JavaScript. If a malicious script can be run on this page then the cookie will be accessible and can be transmitted to another site. If this is a session cookie then session hijacking may be possible.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: dd487feea4901d73f1fdcf2a14bf1c0b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 3841
Expires: Sun, 15 May 2022 13:19:59 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3841 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the HttpOnly flag is set for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the HttpOnly flag, which means that the cookie can be accessed by JavaScript. If a malicious script can be run on this page then the cookie will be accessible and can be transmitted to another site. If this is a session cookie then session hijacking may be possible.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (461 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (358 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: 124dddb8eb00011c2d0006596fec2e05
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 3484
Expires: Sun, 15 May 2022 13:20:02 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;





  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the HttpOnly flag is set for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the HttpOnly flag, which means that the cookie can be accessed by JavaScript. If a malicious script can be run on this page then the cookie will be accessible and can be transmitted to another site. If this is a session cookie then session hijacking may be possible.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: cb805a8a9a771a6bd9832957669cc3a8
Date: Sun, 15 May 2022 13:20:06 GMT
Server: Google Frontend
Content-Length: 3839
Expires: Sun, 15 May 2022 13:20:06 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3839 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;



  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the HttpOnly flag is set for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the HttpOnly flag, which means that the cookie can be accessed by JavaScript. If a malicious script can be run on this page then the cookie will be accessible and can be transmitted to another site. If this is a session cookie then session hijacking may be possible.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: 51f9d1fd2e5c757a866155237d8d93ca
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2224
Expires: Sun, 15 May 2022 13:20:05 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2224 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;Account created.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the HttpOnly flag is set for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/start</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the HttpOnly flag, which means that the cookie can be accessed by JavaScript. If a malicious script can be run on this page then the cookie will be accessible and can be transmitted to another site. If this is a session cookie then session hijacking may be possible.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (280 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/start HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (354 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
Set-Cookie: GRUYERE_ID=582835734666354056417651491707595504272; Path=/
X-Cloud-Trace-Context: 67d04bd02f8536859132b553f36e14a6
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 681
Expires: Sun, 15 May 2022 13:19:57 GMT

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (681 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
    
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Start Gruyere&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Start Gruyere&lt;/H1&gt;
    Your Gruyere instance id is 582835734666354056417651491707595504272.

    &lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;

    &lt;br&gt;&lt;br&gt;By using Gruyere you agree to the
    &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;terms of service&lt;/A&gt;.

    &lt;H2&gt;&lt;A HREF=&quot;/582835734666354056417651491707595504272&quot;&gt;Agree &amp;amp; Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE_ID</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE_ID</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the HttpOnly flag is set for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-4">Cookie without SameSite Attribute</a> <span>(5)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a &#39;cross-site&#39; request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: dd487feea4901d73f1fdcf2a14bf1c0b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 3841
Expires: Sun, 15 May 2022 13:19:59 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3841 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the SameSite attribute is set to either &#39;lax&#39; or ideally &#39;strict&#39; for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a &#39;cross-site&#39; request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (461 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (358 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: 124dddb8eb00011c2d0006596fec2e05
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 3484
Expires: Sun, 15 May 2022 13:20:02 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;





  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the SameSite attribute is set to either &#39;lax&#39; or ideally &#39;strict&#39; for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a &#39;cross-site&#39; request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: cb805a8a9a771a6bd9832957669cc3a8
Date: Sun, 15 May 2022 13:20:06 GMT
Server: Google Frontend
Content-Length: 3839
Expires: Sun, 15 May 2022 13:20:06 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3839 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;



  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the SameSite attribute is set to either &#39;lax&#39; or ideally &#39;strict&#39; for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a &#39;cross-site&#39; request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: 51f9d1fd2e5c757a866155237d8d93ca
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2224
Expires: Sun, 15 May 2022 13:20:05 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2224 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;Account created.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the SameSite attribute is set to either &#39;lax&#39; or ideally &#39;strict&#39; for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/start</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes">WSTG-v42-SESS-02</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP_2017_A05</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a &#39;cross-site&#39; request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>
 </td>
	</tr>
	
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (280 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/start HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (354 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
Set-Cookie: GRUYERE_ID=582835734666354056417651491707595504272; Path=/
X-Cloud-Trace-Context: 67d04bd02f8536859132b553f36e14a6
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 681
Expires: Sun, 15 May 2022 13:19:57 GMT

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (681 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
    
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Start Gruyere&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Start Gruyere&lt;/H1&gt;
    Your Gruyere instance id is 582835734666354056417651491707595504272.

    &lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;

    &lt;br&gt;&lt;br&gt;By using Gruyere you agree to the
    &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;terms of service&lt;/A&gt;.

    &lt;H2&gt;&lt;A HREF=&quot;/582835734666354056417651491707595504272&quot;&gt;Agree &amp;amp; Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>GRUYERE_ID</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>Set-Cookie: GRUYERE_ID</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the SameSite attribute is set to either &#39;lax&#39; or ideally &#39;strict&#39; for all cookies.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-7">X-Content-Type-Options Header Missing</a> <span>(76)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (326 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/0
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 53e16cb763327c4aeefb0327df227823
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 11506

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/0</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/0 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 2bf866ff90342d65770070d5a4eb9ddd
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 6a4e66c74416cfe7c9528ad85fd5281e
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 668f64f9674f1dbde503682e8d232584
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 0341d764bf5b70e56645f9647cce4716
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 8961ddfca96219f3bec32c8932505eeb
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (260 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 9d6b02680aa0dbd5b771773c9522f5f6
Date: Sun, 15 May 2022 13:19:54 GMT
Server: Google Frontend
Content-Length: 3484

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (470 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 70e7ced65dacb53c46f9e0842534c6aa
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3921

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3921 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Profile&lt;/h2&gt;
&lt;/div&gt;

&lt;div class=&#39;content&#39;&gt;


  &lt;h3&gt;Edit your profile.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;update&#39;&gt;
&lt;table&gt;
  &lt;tr&gt;&lt;td&gt;
    User id:
  &lt;/td&gt;&lt;td&gt;


  
    ZAP
  
  

  &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;ZAP&#39;
      name=&#39;name&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    OLD Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;oldpw&#39;&gt;
  &lt;/td&gt;&lt;td&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    NEW Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Icon:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      value=&#39;&#39;
      name=&#39;icon&#39;&gt;
    (32x32 image, URL to image location)
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Homepage:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; size=&#39;50&#39;
      value=&#39;&#39;
      name=&#39;web_site&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Profile Color:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39;
      value=&#39;&#39;
      name=&#39;color&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Private Snippet:
  &lt;/td&gt;&lt;td&gt;
    &lt;textarea name=&#39;private_snippet&#39; rows=&#39;10&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;left&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Update&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/lib.js</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (411 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/lib.js HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (256 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Content-type: application/javascript
Cache-control: public, max-age=7200
X-XSS-Protection: 0
X-Cloud-Trace-Context: 919cfbe3fa7aad0e80e87d986e106a20
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 1962

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1962 bytes)</summary>
				
				<pre><code>/* Copyright 2017 Google Inc. */
/**
 * Swaps the display settings of two elements. Before calling, exactly one
 * of the two elements should have style=&quot;display:none&quot; and it shows the one
 * that is hidden and hides the one that is shown.
 */
function _showHide(id1, id2) {
  var x1 = document.getElementById(id1);
  var x2 = document.getElementById(id2);
  var shown = x1.style.display != &#39;&#39;;
  x1.style.display = shown ? &#39;&#39; : &#39;none&#39;;
  x2.style.display = shown ? &#39;none&#39; : &#39;&#39;;
};

/**
 * Refreshes the current page by loading the url and then passing the
 * json response object to the callback.
 */
function _refresh(url, callback) {
  var httpRequest = window.XMLHttpRequest ? new XMLHttpRequest()
      : new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
  httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState == 4) {
      _feed = callback;
      eval(&#39;(&#39; + httpRequest.responseText + &#39;)&#39;);
      httpRequest = null;
    }
  }
  httpRequest.open(&quot;GET&quot;, url, true);
  httpRequest.send(null);
};

/**
 * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}
 */
function _finishRefreshHome(response) {
  for (var uid in response) {
    var element = document.getElementById(uid);
    if (element) {
      element.innerHTML = response[uid];
    }
  }
};

function _refreshHome(uniqueId) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl&quot;, _finishRefreshHome);
};

/**
 * Processes refresh response [name, snippet, ...]
 */
function _finishRefreshSnippets(response) {
  var n = response.length;
  var element = document.getElementById(&#39;user_name&#39;);
  if (n &amp;&amp; element) {
    element.innerHTML = response[0];
  }

  // The snippet divs are numbered 0, 1, ...
  for (var i = 1; i &lt; n; ++i) {
    var element = document.getElementById(i - 1);
    if (element) {
      element.innerHTML = response[i];
    }
  }
};

function _refreshSnippets(uniqueId, uid) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl?uid=&quot; + uid, _finishRefreshSnippets);
};
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: e3793f9f6caa9b67d4002560e4ee444a
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: dd487feea4901d73f1fdcf2a14bf1c0b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 3841
Expires: Sun, 15 May 2022 13:19:59 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3841 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (461 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/logout HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (358 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: 124dddb8eb00011c2d0006596fec2e05
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 3484
Expires: Sun, 15 May 2022 13:20:02 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3484 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;





  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 184dff1f0053e9050e8c7e5812c1986f
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (469 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newsnippet.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 4de0db8f7c0a480fd6330de37dbf7b80
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 3076

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3076 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: New Snippet&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: New Snippet&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Add a new snippet.&lt;/h3&gt;



&lt;div style=&#39;width:600&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/425450881661954264328804432207969818728/newsnippet2&#39;&gt;
&lt;textarea name=&#39;snippet&#39; rows=&#39;5&#39; style=&#39;width:100%&#39;&gt;&lt;/textarea&gt;
&lt;br&gt;
&lt;table summary=&#39;&#39; style=&#39;width:100%&#39;&gt;
&lt;tr&gt;
&lt;td align=&#39;left&#39; valign=&#39;top&#39;&gt;
  &lt;i&gt;Limited HTML is now supported in snippets (e.g., &amp;lt;b&amp;gt;, &amp;lt;i&amp;gt;,
  etc.)!&lt;/i&gt;
&lt;/td&gt;
&lt;td align=&#39;right&#39; valign=&#39;top&#39;&gt;
  &lt;input type=&#39;submit&#39; value=&#39;Submit&#39;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 6bed895368159adc47a6df092a41df8b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 2228

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2228 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;User already exists.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=update&amp;color=%23ffffff&amp;icon=ZAP&amp;name=ZAP&amp;oldpw=ZAP&amp;private_snippet&amp;pw=ZAP&amp;web_site=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (535 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/saveprofile?action=update&amp;color=%23ffffff&amp;icon=ZAP&amp;name=ZAP&amp;oldpw=ZAP&amp;private_snippet&amp;pw=ZAP&amp;web_site=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/editprofile.gtl
Cookie: GRUYERE=; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 2840796b2b5d70497cf8ae6f1af24a19
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2228

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2228 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;User does not exist.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (467 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: febb86a8a988547400791fa0cb7dcd19
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 2960

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2960 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;


  My Snippets
  

&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;ZAP&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;




  
  
    
      No snippets.
    
    
  
  &lt;br&gt;
  &lt;a href=&#39;&#39;&gt;My site&lt;/a&gt;

&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=brie</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (426 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=brie HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: f270e52f74d08d8c475ecd2166585299
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 3059

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3059 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Brie
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;brie&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Brie&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (429 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 8910dace3bdd82f472971b16b4d0a902
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 3379

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/425450881661954264328804432207969818728/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Cheddar Mac
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;425450881661954264328804432207969818728&quot;, &quot;cheddar&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Gruyere is the cheesiest application on the web.
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(1 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;1&#39;&gt;
                I wonder if there are any security holes in this....
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Cheddar Mac&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (465 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP
Cookie: GRUYERE=26087470|ZAP||author; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 1cce769952da3342423c11528e88b66f
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 2930

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2930 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Upload&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Upload&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Select a file to upload to your account.&lt;/h3&gt;



&lt;div&gt;
&lt;form method=&#39;post&#39; enctype=&#39;multipart/form-data&#39; action=&#39;/425450881661954264328804432207969818728/upload2&#39;&gt;
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;
    &lt;input type=&#39;file&#39; name=&#39;upload_file&#39; size=&#39;50&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td align=&#39;center&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Upload&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e6ba2671e3bd4292a66de4ae2c337c7c
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (404 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 579c4b7c507aad673b70d834e309beac
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 3480

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3480 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;


  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/lib.js</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (411 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/lib.js HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (256 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Content-type: application/javascript
Cache-control: public, max-age=7200
X-XSS-Protection: 0
X-Cloud-Trace-Context: 9591902ef6e757c177772057c92e33bb
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 1962

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1962 bytes)</summary>
				
				<pre><code>/* Copyright 2017 Google Inc. */
/**
 * Swaps the display settings of two elements. Before calling, exactly one
 * of the two elements should have style=&quot;display:none&quot; and it shows the one
 * that is hidden and hides the one that is shown.
 */
function _showHide(id1, id2) {
  var x1 = document.getElementById(id1);
  var x2 = document.getElementById(id2);
  var shown = x1.style.display != &#39;&#39;;
  x1.style.display = shown ? &#39;&#39; : &#39;none&#39;;
  x2.style.display = shown ? &#39;none&#39; : &#39;&#39;;
};

/**
 * Refreshes the current page by loading the url and then passing the
 * json response object to the callback.
 */
function _refresh(url, callback) {
  var httpRequest = window.XMLHttpRequest ? new XMLHttpRequest()
      : new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
  httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState == 4) {
      _feed = callback;
      eval(&#39;(&#39; + httpRequest.responseText + &#39;)&#39;);
      httpRequest = null;
    }
  }
  httpRequest.open(&quot;GET&quot;, url, true);
  httpRequest.send(null);
};

/**
 * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}
 */
function _finishRefreshHome(response) {
  for (var uid in response) {
    var element = document.getElementById(uid);
    if (element) {
      element.innerHTML = response[uid];
    }
  }
};

function _refreshHome(uniqueId) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl&quot;, _finishRefreshHome);
};

/**
 * Processes refresh response [name, snippet, ...]
 */
function _finishRefreshSnippets(response) {
  var n = response.length;
  var element = document.getElementById(&#39;user_name&#39;);
  if (n &amp;&amp; element) {
    element.innerHTML = response[0];
  }

  // The snippet divs are numbered 0, 1, ...
  for (var i = 1; i &lt; n; ++i) {
    var element = document.getElementById(i - 1);
    if (element) {
      element.innerHTML = response[i];
    }
  }
};

function _refreshSnippets(uniqueId, uid) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl?uid=&quot; + uid, _finishRefreshSnippets);
};
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (410 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: ba1fc60270053cca97a7e64e9599e081
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2591

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2591 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Login&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2&gt;Gruyere: Login&lt;/h2&gt;
&lt;/div&gt;



&lt;div class=&#39;content&#39;&gt;
&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/login&#39;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: cb805a8a9a771a6bd9832957669cc3a8
Date: Sun, 15 May 2022 13:20:06 GMT
Server: Google Frontend
Content-Length: 3839
Expires: Sun, 15 May 2022 13:20:06 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3839 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;



  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (419 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: d0514363ce7ebcfc496a81ce54a0b1c8
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 2961

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2961 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Profile&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;h2&gt;Gruyere: Sign up&lt;/h2&gt;

&lt;div class=&#39;content&#39;&gt;
&lt;h3&gt;Sign up for a new account.&lt;/h3&gt;



&lt;form method=&#39;get&#39; action=&#39;/582835734666354056417651491707595504272/saveprofile&#39;&gt;
&lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;new&#39;&gt;

&lt;table&gt;&lt;tr&gt;&lt;td&gt;
    User name:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;text&#39; name=&#39;uid&#39; value=&#39;&#39; maxlength=&#39;16&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;
    Password:
  &lt;/td&gt;&lt;td&gt;
    &lt;input type=&#39;password&#39; name=&#39;pw&#39;&gt;
    &lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not use a password that you use for any real service.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;
&lt;/td&gt;&lt;/tr&gt;


&lt;input type=&#39;hidden&#39; name=&#39;is_author&#39; value=&#39;True&#39;&gt;

&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&#39;right&#39;&gt;
    &lt;input type=&#39;submit&#39; value=&#39;Create account&#39;&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: 51f9d1fd2e5c757a866155237d8d93ca
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2224
Expires: Sun, 15 May 2022 13:20:05 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2224 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;Account created.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=brie</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (426 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=brie HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: fee6d2c9dcd1d00daf4eb9e7d5df01bd
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3059

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3059 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Brie
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;582835734666354056417651491707595504272&quot;, &quot;brie&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Brie&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (429 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (249 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
X-XSS-Protection: 0
X-Cloud-Trace-Context: 5da7bb07707f883e8667ad3da9cc7f67
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3379

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Snippets&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;


&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39; id=&quot;user_name&quot;&gt;

  Cheddar Mac
  


&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39;
  onclick=&#39;_refreshSnippets(&quot;582835734666354056417651491707595504272&quot;, &quot;cheddar&quot;)&#39;
  href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;


  
  
    
    
      &lt;table&gt;
        &lt;tr&gt;&lt;td colspan=&#39;2&#39;&gt;&lt;b&gt;All snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(0 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;0&#39;&gt;
                Gruyere is the cheesiest application on the web.
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
          &lt;tr&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;script&gt;document.write(1 + 1)&lt;/script&gt;&amp;nbsp;&amp;nbsp;
            &lt;/td&gt;
            &lt;td valign=&#39;top&#39;&gt;
              &lt;div id=&#39;1&#39;&gt;
                I wonder if there are any security holes in this....
              &lt;/div&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        
      &lt;/table&gt;
      &lt;br&gt;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Cheddar Mac&#39;s site&lt;/a&gt;
    
  



&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/6</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/6 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 344d428643f4da8fbbfd1aff1d12c412
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/7</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/7 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 4e6c5c14e438dcb6759f7d5dd3ada038
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/8</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/8 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: b9a6b6375628b625c1250fb6dd228185
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/9</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (276 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/9 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 36c6d74188873d46a7ce354a667b0015
Date: Sun, 15 May 2022 13:19:56 GMT
Server: Google Frontend
Content-Length: 359

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (359 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Gruyere Error&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Gruyere Error&lt;/H1&gt;
    That instance does not exist.
    &lt;H2&gt;&lt;A href=&quot;/&quot;&gt;Home&lt;/A&gt;&lt;/H2&gt;
    &lt;H2&gt;&lt;A href=&quot;/start&quot;&gt;Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (335 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: ee2ca9212cb00a61114efb77fd34ba5c
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 354

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (354 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?data.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (343 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?data.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 88e89f3d74451368d5985974f107937f
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 367

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (367 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/data.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?gruyere.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?gruyere.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 0de4019c659d2662b808ecda2edb789a
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 370

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (370 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/gruyere.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?gtl.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (342 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?gtl.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 571e688fd2591dc2e9ce05e05d9fad8f
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 366

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (366 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/gtl.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resoources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (355 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resoources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 641b14c9d119e8ea3a771894b86123a3
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 354

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (354 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 16b791a2a5db25d5f428137c25114629
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/dump.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (361 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part3
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: f874a2c05d2324078816943e1489f4b9
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 385

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (385 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/editprofile.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/error.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (355 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/error.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part2
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1804803b8c13c237d5e462abbcf28443
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 379

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (379 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/error.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/feed.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/feed.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e08b20152c79be9d31f1a6bf7039e34
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/feed.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/home.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/home.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part2
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 8af31490b4264dcebe22d8c8dedab3f9
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 378

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (378 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/home.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/manage.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (356 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/manage.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part4
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 30344ae22ab4f6720974b03b8bfdab14
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 380

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (380 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/manage.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?resources/menubar.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (357 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?resources/menubar.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part4
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 56ca62732f6b18323ea608b5bcc467e3
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 381

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (381 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/resources/menubar.gtl&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/?sanitize.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (347 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/?sanitize.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: d26b19d1534070ac9ff43354a211cfe6
Date: Sun, 15 May 2022 13:20:00 GMT
Server: Google Frontend
Content-Length: 371

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (371 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;
   &quot;https://www.w3.org/TR/html4/frameset.dtd&quot;&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;FRAMESET cols=&quot;165,100%&quot;&gt;
  &lt;FRAME src=&quot;/static/codeindex.html&quot;&gt;
  &lt;FRAME name=&quot;codepage&quot; src=&quot;/code/sanitize.py&quot;&gt;
  &lt;NOFRAMES&gt;
    &lt;A href=&quot;/static/codeindex/html&quot;&gt;Code Index&lt;/A&gt;
  &lt;/NOFRAMES&gt;
&lt;/FRAMESET&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/data.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (350 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/data.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?data.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: d4831cd113a2da5270f73f7dc8fc3bea
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 4190

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (4190 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;data.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere - Default data for Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import copy
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;DEFAULT_DATA = {
&lt;SMALL&gt; 25  &lt;/SMALL&gt;    &#39;administrator&#39;: {
&lt;SMALL&gt; 26  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Admin&#39;,
&lt;SMALL&gt; 27  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;secret&#39;,
&lt;SMALL&gt; 28  &lt;/SMALL&gt;        &#39;is_author&#39;: False,
&lt;SMALL&gt; 29  &lt;/SMALL&gt;        &#39;is_admin&#39;: True,
&lt;SMALL&gt; 30  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;My password is secret. Get it?&#39;,
&lt;SMALL&gt; 31  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://www.google.com/contact/&#39;,
&lt;SMALL&gt; 32  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 33  &lt;/SMALL&gt;    &#39;cheddar&#39;: {
&lt;SMALL&gt; 34  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Cheddar Mac&#39;,
&lt;SMALL&gt; 35  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;orange&#39;,
&lt;SMALL&gt; 36  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 37  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 38  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;My SSN is &amp;lt;a href=&quot;https://www.google.com/&#39; +
&lt;SMALL&gt; 39  &lt;/SMALL&gt;                           &#39;search?q=078-05-1120&quot;&amp;gt;078-05-1120&amp;lt;/a&amp;gt;.&#39;,
&lt;SMALL&gt; 40  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://images.google.com/?q=cheddar+cheese&#39;,
&lt;SMALL&gt; 41  &lt;/SMALL&gt;        &#39;color&#39;: &#39;blue&#39;,
&lt;SMALL&gt; 42  &lt;/SMALL&gt;        &#39;snippets&#39;: [
&lt;SMALL&gt; 43  &lt;/SMALL&gt;            &#39;Gruyere is the cheesiest application on the web.&#39;,
&lt;SMALL&gt; 44  &lt;/SMALL&gt;            &#39;I wonder if there are any security holes in this....&#39;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;        ],
&lt;SMALL&gt; 46  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 47  &lt;/SMALL&gt;    &#39;sardo&#39;: {
&lt;SMALL&gt; 48  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Miss Sardo&#39;,
&lt;SMALL&gt; 49  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;odras&#39;,
&lt;SMALL&gt; 50  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 51  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 52  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;I hate my brother Romano.&#39;,
&lt;SMALL&gt; 53  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://www.google.com/search?q=&quot;pecorino+sardo&quot;&#39;,
&lt;SMALL&gt; 54  &lt;/SMALL&gt;        &#39;color&#39;: &#39;red&#39;,
&lt;SMALL&gt; 55  &lt;/SMALL&gt;        &#39;snippets&#39;: [],
&lt;SMALL&gt; 56  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 57  &lt;/SMALL&gt;    &#39;brie&#39;: {
&lt;SMALL&gt; 58  &lt;/SMALL&gt;        &#39;name&#39;: &#39;Brie&#39;,
&lt;SMALL&gt; 59  &lt;/SMALL&gt;        &#39;pw&#39;: &#39;briebrie&#39;,
&lt;SMALL&gt; 60  &lt;/SMALL&gt;        &#39;is_author&#39;: True,
&lt;SMALL&gt; 61  &lt;/SMALL&gt;        &#39;is_admin&#39;: False,
&lt;SMALL&gt; 62  &lt;/SMALL&gt;        &#39;private_snippet&#39;: &#39;I use the same password for all my accounts.&#39;,
&lt;SMALL&gt; 63  &lt;/SMALL&gt;        &#39;web_site&#39;: &#39;https://news.google.com/news/search?q=brie&#39;,
&lt;SMALL&gt; 64  &lt;/SMALL&gt;        &#39;color&#39;: &#39;red; text-decoration:underline&#39;,
&lt;SMALL&gt; 65  &lt;/SMALL&gt;        &#39;snippets&#39;: [
&lt;SMALL&gt; 66  &lt;/SMALL&gt;            &#39;Brie is the queen of the cheeses&amp;lt;span style=color:red&amp;gt;!!!&amp;lt;/span&amp;gt;&#39;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;        ],
&lt;SMALL&gt; 68  &lt;/SMALL&gt;    },
&lt;SMALL&gt; 69  &lt;/SMALL&gt;}
&lt;SMALL&gt; 70  &lt;/SMALL&gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;def DefaultData():
&lt;SMALL&gt; 73  &lt;/SMALL&gt;  &quot;&quot;&quot;Provides default data for Gruyere.&quot;&quot;&quot;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  return copy.deepcopy(DEFAULT_DATA)
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/gruyere.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (356 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/gruyere.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?gruyere.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: c13940c77049c813278bdd40366ee9d2
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 45208

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (45208 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;gruyere.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;#!/usr/bin/env python2.7
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere - a web application with holes.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  6  &lt;/SMALL&gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;This code is licensed under the
&lt;SMALL&gt;  8  &lt;/SMALL&gt;https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  9  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt; 10  &lt;/SMALL&gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt; 12  &lt;/SMALL&gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 14  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 15  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 16  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 17  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 18  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 19  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 20  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 25  &lt;/SMALL&gt;from BaseHTTPServer import BaseHTTPRequestHandler
&lt;SMALL&gt; 26  &lt;/SMALL&gt;from BaseHTTPServer import HTTPServer
&lt;SMALL&gt; 27  &lt;/SMALL&gt;import cgi
&lt;SMALL&gt; 28  &lt;/SMALL&gt;import cPickle
&lt;SMALL&gt; 29  &lt;/SMALL&gt;import os
&lt;SMALL&gt; 30  &lt;/SMALL&gt;import random
&lt;SMALL&gt; 31  &lt;/SMALL&gt;import sys
&lt;SMALL&gt; 32  &lt;/SMALL&gt;import threading
&lt;SMALL&gt; 33  &lt;/SMALL&gt;import urllib
&lt;SMALL&gt; 34  &lt;/SMALL&gt;from urlparse import urlparse
&lt;SMALL&gt; 35  &lt;/SMALL&gt;
&lt;SMALL&gt; 36  &lt;/SMALL&gt;try:
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  sys.dont_write_bytecode = True
&lt;SMALL&gt; 38  &lt;/SMALL&gt;except AttributeError:
&lt;SMALL&gt; 39  &lt;/SMALL&gt;  pass
&lt;SMALL&gt; 40  &lt;/SMALL&gt;
&lt;SMALL&gt; 41  &lt;/SMALL&gt;# our modules
&lt;SMALL&gt; 42  &lt;/SMALL&gt;import data
&lt;SMALL&gt; 43  &lt;/SMALL&gt;import gtl
&lt;SMALL&gt; 44  &lt;/SMALL&gt;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;DB_FILE = &#39;/stored-data.txt&#39;
&lt;SMALL&gt; 47  &lt;/SMALL&gt;SECRET_FILE = &#39;/secret.txt&#39;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;
&lt;SMALL&gt; 49  &lt;/SMALL&gt;INSTALL_PATH = &#39;.&#39;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;RESOURCE_PATH = &#39;resources&#39;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;SPECIAL_COOKIE = &#39;_cookie&#39;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;SPECIAL_PROFILE = &#39;_profile&#39;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;SPECIAL_DB = &#39;_db&#39;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;SPECIAL_PARAMS = &#39;_params&#39;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;SPECIAL_UNIQUE_ID = &#39;_unique_id&#39;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;COOKIE_UID = &#39;uid&#39;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;COOKIE_ADMIN = &#39;is_admin&#39;
&lt;SMALL&gt; 60  &lt;/SMALL&gt;COOKIE_AUTHOR = &#39;is_author&#39;
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;# Set to True to cause the server to exit after processing the current url.
&lt;SMALL&gt; 64  &lt;/SMALL&gt;quit_server = False
&lt;SMALL&gt; 65  &lt;/SMALL&gt;
&lt;SMALL&gt; 66  &lt;/SMALL&gt;# A global copy of the database so that _GetDatabase can access it.
&lt;SMALL&gt; 67  &lt;/SMALL&gt;stored_data = None
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;# The HTTPServer object.
&lt;SMALL&gt; 70  &lt;/SMALL&gt;http_server = None
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;# A secret value used to generate hashes to protect cookies from tampering.
&lt;SMALL&gt; 73  &lt;/SMALL&gt;cookie_secret = &#39;&#39;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;# File extensions of resource files that we recognize.
&lt;SMALL&gt; 76  &lt;/SMALL&gt;RESOURCE_CONTENT_TYPES = {
&lt;SMALL&gt; 77  &lt;/SMALL&gt;    &#39;.css&#39;: &#39;text/css&#39;,
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    &#39;.gif&#39;: &#39;image/gif&#39;,
&lt;SMALL&gt; 79  &lt;/SMALL&gt;    &#39;.htm&#39;: &#39;text/html&#39;,
&lt;SMALL&gt; 80  &lt;/SMALL&gt;    &#39;.html&#39;: &#39;text/html&#39;,
&lt;SMALL&gt; 81  &lt;/SMALL&gt;    &#39;.js&#39;: &#39;application/javascript&#39;,
&lt;SMALL&gt; 82  &lt;/SMALL&gt;    &#39;.jpeg&#39;: &#39;image/jpeg&#39;,
&lt;SMALL&gt; 83  &lt;/SMALL&gt;    &#39;.jpg&#39;: &#39;image/jpeg&#39;,
&lt;SMALL&gt; 84  &lt;/SMALL&gt;    &#39;.png&#39;: &#39;image/png&#39;,
&lt;SMALL&gt; 85  &lt;/SMALL&gt;    &#39;.ico&#39;: &#39;image/x-icon&#39;,
&lt;SMALL&gt; 86  &lt;/SMALL&gt;    &#39;.text&#39;: &#39;text/plain&#39;,
&lt;SMALL&gt; 87  &lt;/SMALL&gt;    &#39;.txt&#39;: &#39;text/plain&#39;,
&lt;SMALL&gt; 88  &lt;/SMALL&gt;}
&lt;SMALL&gt; 89  &lt;/SMALL&gt;
&lt;SMALL&gt; 90  &lt;/SMALL&gt;
&lt;SMALL&gt; 91  &lt;/SMALL&gt;def main():
&lt;SMALL&gt; 92  &lt;/SMALL&gt;  _SetWorkingDirectory()
&lt;SMALL&gt; 93  &lt;/SMALL&gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;  global quit_server
&lt;SMALL&gt; 95  &lt;/SMALL&gt;  quit_server = False
&lt;SMALL&gt; 96  &lt;/SMALL&gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;  # Normally, Gruyere only accepts connections to/from localhost. If you
&lt;SMALL&gt; 98  &lt;/SMALL&gt;  # would like to allow access from other ip addresses, you can change to
&lt;SMALL&gt; 99  &lt;/SMALL&gt;  # operate in a less secure mode. Set insecure_mode to True to serve on the
&lt;SMALL&gt;100  &lt;/SMALL&gt;  # hostname instead of localhost and add the addresses of the other machines
&lt;SMALL&gt;101  &lt;/SMALL&gt;  # to allowed_ips below.
&lt;SMALL&gt;102  &lt;/SMALL&gt;
&lt;SMALL&gt;103  &lt;/SMALL&gt;  insecure_mode = False
&lt;SMALL&gt;104  &lt;/SMALL&gt;
&lt;SMALL&gt;105  &lt;/SMALL&gt;  # WARNING! DO NOT CHANGE THE FOLLOWING SECTION OF CODE!
&lt;SMALL&gt;106  &lt;/SMALL&gt;
&lt;SMALL&gt;107  &lt;/SMALL&gt;  # This application is very exploitable. It takes several precautions to
&lt;SMALL&gt;108  &lt;/SMALL&gt;  # limit the risk from a real attacker:
&lt;SMALL&gt;109  &lt;/SMALL&gt;  #   (1) Serve requests on localhost so that it will not be accessible
&lt;SMALL&gt;110  &lt;/SMALL&gt;  # from other machines.
&lt;SMALL&gt;111  &lt;/SMALL&gt;  #   (2) If a request is received from any IP other than localhost, quit.
&lt;SMALL&gt;112  &lt;/SMALL&gt;  # (This protection is implemented in do_GET/do_POST.)
&lt;SMALL&gt;113  &lt;/SMALL&gt;  #   (3) Inject a random identifier as the first part of the path and
&lt;SMALL&gt;114  &lt;/SMALL&gt;  # quit if a request is received without this identifier (except for an
&lt;SMALL&gt;115  &lt;/SMALL&gt;  # empty path which redirects and /favicon.ico).
&lt;SMALL&gt;116  &lt;/SMALL&gt;  #   (4) Automatically exit after 2 hours (7200 seconds) to mitigate against
&lt;SMALL&gt;117  &lt;/SMALL&gt;  # accidentally leaving the server running.
&lt;SMALL&gt;118  &lt;/SMALL&gt;
&lt;SMALL&gt;119  &lt;/SMALL&gt;  quit_timer = threading.Timer(7200, lambda: _Exit(&#39;Timeout&#39;))   # DO NOT CHANGE
&lt;SMALL&gt;120  &lt;/SMALL&gt;  quit_timer.start()                                             # DO NOT CHANGE
&lt;SMALL&gt;121  &lt;/SMALL&gt;
&lt;SMALL&gt;122  &lt;/SMALL&gt;  if insecure_mode:                                              # DO NOT CHANGE
&lt;SMALL&gt;123  &lt;/SMALL&gt;    server_name = os.popen(&#39;hostname&#39;).read().replace(&#39;\n&#39;, &#39;&#39;)  # DO NOT CHANGE
&lt;SMALL&gt;124  &lt;/SMALL&gt;  else:                                                          # DO NOT CHANGE
&lt;SMALL&gt;125  &lt;/SMALL&gt;    server_name = &#39;127.0.0.1&#39;                                    # DO NOT CHANGE
&lt;SMALL&gt;126  &lt;/SMALL&gt;  server_port = 8008                                             # DO NOT CHANGE
&lt;SMALL&gt;127  &lt;/SMALL&gt;
&lt;SMALL&gt;128  &lt;/SMALL&gt;  # The unique id is created from a CSPRNG.
&lt;SMALL&gt;129  &lt;/SMALL&gt;  try:                                                           # DO NOT CHANGE
&lt;SMALL&gt;130  &lt;/SMALL&gt;    r = random.SystemRandom()                                    # DO NOT CHANGE
&lt;SMALL&gt;131  &lt;/SMALL&gt;  except NotImplementedError:                                    # DO NOT CHANGE
&lt;SMALL&gt;132  &lt;/SMALL&gt;    _Exit(&#39;Could not obtain a CSPRNG source&#39;)                    # DO NOT CHANGE
&lt;SMALL&gt;133  &lt;/SMALL&gt;
&lt;SMALL&gt;134  &lt;/SMALL&gt;  global server_unique_id                                        # DO NOT CHANGE
&lt;SMALL&gt;135  &lt;/SMALL&gt;  server_unique_id = str(r.randint(2**128, 2**(128+1)))          # DO NOT CHANGE
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;SMALL&gt;137  &lt;/SMALL&gt;  # END WARNING!
&lt;SMALL&gt;138  &lt;/SMALL&gt;
&lt;SMALL&gt;139  &lt;/SMALL&gt;  global http_server
&lt;SMALL&gt;140  &lt;/SMALL&gt;  http_server = HTTPServer((server_name, server_port),
&lt;SMALL&gt;141  &lt;/SMALL&gt;                           GruyereRequestHandler)
&lt;SMALL&gt;142  &lt;/SMALL&gt;
&lt;SMALL&gt;143  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;&#39;&#39;
&lt;SMALL&gt;144  &lt;/SMALL&gt;      Gruyere started...
&lt;SMALL&gt;145  &lt;/SMALL&gt;          http://%s:%d/
&lt;SMALL&gt;146  &lt;/SMALL&gt;          http://%s:%d/%s/&#39;&#39;&#39; % (
&lt;SMALL&gt;147  &lt;/SMALL&gt;              server_name, server_port, server_name, server_port,
&lt;SMALL&gt;148  &lt;/SMALL&gt;              server_unique_id)
&lt;SMALL&gt;149  &lt;/SMALL&gt;
&lt;SMALL&gt;150  &lt;/SMALL&gt;  global stored_data
&lt;SMALL&gt;151  &lt;/SMALL&gt;  stored_data = _LoadDatabase()
&lt;SMALL&gt;152  &lt;/SMALL&gt;
&lt;SMALL&gt;153  &lt;/SMALL&gt;  while not quit_server:
&lt;SMALL&gt;154  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;155  &lt;/SMALL&gt;      http_server.handle_request()
&lt;SMALL&gt;156  &lt;/SMALL&gt;      _SaveDatabase(stored_data)
&lt;SMALL&gt;157  &lt;/SMALL&gt;    except KeyboardInterrupt:
&lt;SMALL&gt;158  &lt;/SMALL&gt;      print &amp;gt;&amp;gt;sys.stderr, &#39;\nReceived KeyboardInterrupt&#39;
&lt;SMALL&gt;159  &lt;/SMALL&gt;      quit_server = True
&lt;SMALL&gt;160  &lt;/SMALL&gt;
&lt;SMALL&gt;161  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;\nClosing&#39;
&lt;SMALL&gt;162  &lt;/SMALL&gt;  http_server.socket.close()
&lt;SMALL&gt;163  &lt;/SMALL&gt;  _Exit(&#39;quit_server&#39;)
&lt;SMALL&gt;164  &lt;/SMALL&gt;
&lt;SMALL&gt;165  &lt;/SMALL&gt;
&lt;SMALL&gt;166  &lt;/SMALL&gt;def _Exit(reason):
&lt;SMALL&gt;167  &lt;/SMALL&gt;  # use os._exit instead of sys.exit because this can&#39;t be trapped
&lt;SMALL&gt;168  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, &#39;\nExit: &#39; + reason
&lt;SMALL&gt;169  &lt;/SMALL&gt;  os._exit(0)
&lt;SMALL&gt;170  &lt;/SMALL&gt;
&lt;SMALL&gt;171  &lt;/SMALL&gt;
&lt;SMALL&gt;172  &lt;/SMALL&gt;def _SetWorkingDirectory():
&lt;SMALL&gt;173  &lt;/SMALL&gt;  &quot;&quot;&quot;Set the working directory to the directory containing this file.&quot;&quot;&quot;
&lt;SMALL&gt;174  &lt;/SMALL&gt;  if sys.path[0]:
&lt;SMALL&gt;175  &lt;/SMALL&gt;    os.chdir(sys.path[0])
&lt;SMALL&gt;176  &lt;/SMALL&gt;
&lt;SMALL&gt;177  &lt;/SMALL&gt;
&lt;SMALL&gt;178  &lt;/SMALL&gt;def _LoadDatabase():
&lt;SMALL&gt;179  &lt;/SMALL&gt;  &quot;&quot;&quot;Load the database from stored-data.txt.
&lt;SMALL&gt;180  &lt;/SMALL&gt;
&lt;SMALL&gt;181  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;182  &lt;/SMALL&gt;    The loaded database.
&lt;SMALL&gt;183  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;184  &lt;/SMALL&gt;
&lt;SMALL&gt;185  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;186  &lt;/SMALL&gt;    f = _Open(INSTALL_PATH, DB_FILE)
&lt;SMALL&gt;187  &lt;/SMALL&gt;    stored_data = cPickle.load(f)
&lt;SMALL&gt;188  &lt;/SMALL&gt;    f.close()
&lt;SMALL&gt;189  &lt;/SMALL&gt;  except (IOError, ValueError):
&lt;SMALL&gt;190  &lt;/SMALL&gt;    _Log(&#39;Couldn\&#39;t load data; expected the first time Gruyere is run&#39;)
&lt;SMALL&gt;191  &lt;/SMALL&gt;    stored_data = None
&lt;SMALL&gt;192  &lt;/SMALL&gt;
&lt;SMALL&gt;193  &lt;/SMALL&gt;  f = _Open(INSTALL_PATH, SECRET_FILE)
&lt;SMALL&gt;194  &lt;/SMALL&gt;  global cookie_secret
&lt;SMALL&gt;195  &lt;/SMALL&gt;  cookie_secret = f.readline()
&lt;SMALL&gt;196  &lt;/SMALL&gt;  f.close()
&lt;SMALL&gt;197  &lt;/SMALL&gt;
&lt;SMALL&gt;198  &lt;/SMALL&gt;  return stored_data
&lt;SMALL&gt;199  &lt;/SMALL&gt;
&lt;SMALL&gt;200  &lt;/SMALL&gt;
&lt;SMALL&gt;201  &lt;/SMALL&gt;def _SaveDatabase(save_database):
&lt;SMALL&gt;202  &lt;/SMALL&gt;  &quot;&quot;&quot;Save the database to stored-data.txt.
&lt;SMALL&gt;203  &lt;/SMALL&gt;
&lt;SMALL&gt;204  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;205  &lt;/SMALL&gt;    save_database: the database to save.
&lt;SMALL&gt;206  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;207  &lt;/SMALL&gt;
&lt;SMALL&gt;208  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;209  &lt;/SMALL&gt;    f = _Open(INSTALL_PATH, DB_FILE, &#39;w&#39;)
&lt;SMALL&gt;210  &lt;/SMALL&gt;    cPickle.dump(save_database, f)
&lt;SMALL&gt;211  &lt;/SMALL&gt;    f.close()
&lt;SMALL&gt;212  &lt;/SMALL&gt;  except IOError:
&lt;SMALL&gt;213  &lt;/SMALL&gt;    _Log(&#39;Couldn\&#39;t save data&#39;)
&lt;SMALL&gt;214  &lt;/SMALL&gt;
&lt;SMALL&gt;215  &lt;/SMALL&gt;
&lt;SMALL&gt;216  &lt;/SMALL&gt;def _Open(location, filename, mode=&#39;rb&#39;):
&lt;SMALL&gt;217  &lt;/SMALL&gt;  &quot;&quot;&quot;Open a file from a specific location.
&lt;SMALL&gt;218  &lt;/SMALL&gt;
&lt;SMALL&gt;219  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;220  &lt;/SMALL&gt;    location: The directory containing the file.
&lt;SMALL&gt;221  &lt;/SMALL&gt;    filename: The name of the file.
&lt;SMALL&gt;222  &lt;/SMALL&gt;    mode: File mode for open().
&lt;SMALL&gt;223  &lt;/SMALL&gt;
&lt;SMALL&gt;224  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;225  &lt;/SMALL&gt;    A file object.
&lt;SMALL&gt;226  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;227  &lt;/SMALL&gt;  return open(location + filename, mode)
&lt;SMALL&gt;228  &lt;/SMALL&gt;
&lt;SMALL&gt;229  &lt;/SMALL&gt;
&lt;SMALL&gt;230  &lt;/SMALL&gt;class GruyereRequestHandler(BaseHTTPRequestHandler):
&lt;SMALL&gt;231  &lt;/SMALL&gt;  &quot;&quot;&quot;Handle a http request.&quot;&quot;&quot;
&lt;SMALL&gt;232  &lt;/SMALL&gt;
&lt;SMALL&gt;233  &lt;/SMALL&gt;  # An empty cookie
&lt;SMALL&gt;234  &lt;/SMALL&gt;  NULL_COOKIE = {COOKIE_UID: None, COOKIE_ADMIN: False, COOKIE_AUTHOR: False}
&lt;SMALL&gt;235  &lt;/SMALL&gt;
&lt;SMALL&gt;236  &lt;/SMALL&gt;  # Urls that can only be accessed by administrators.
&lt;SMALL&gt;237  &lt;/SMALL&gt;  _PROTECTED_URLS = [
&lt;SMALL&gt;238  &lt;/SMALL&gt;      &#39;/quit&#39;,
&lt;SMALL&gt;239  &lt;/SMALL&gt;      &#39;/reset&#39;
&lt;SMALL&gt;240  &lt;/SMALL&gt;  ]
&lt;SMALL&gt;241  &lt;/SMALL&gt;
&lt;SMALL&gt;242  &lt;/SMALL&gt;  def _GetDatabase(self):
&lt;SMALL&gt;243  &lt;/SMALL&gt;    &quot;&quot;&quot;Gets the database.&quot;&quot;&quot;
&lt;SMALL&gt;244  &lt;/SMALL&gt;    global stored_data
&lt;SMALL&gt;245  &lt;/SMALL&gt;    if not stored_data:
&lt;SMALL&gt;246  &lt;/SMALL&gt;      stored_data = data.DefaultData()
&lt;SMALL&gt;247  &lt;/SMALL&gt;    return stored_data
&lt;SMALL&gt;248  &lt;/SMALL&gt;
&lt;SMALL&gt;249  &lt;/SMALL&gt;  def _ResetDatabase(self):
&lt;SMALL&gt;250  &lt;/SMALL&gt;    &quot;&quot;&quot;Reset the database.&quot;&quot;&quot;
&lt;SMALL&gt;251  &lt;/SMALL&gt;    # global stored_data
&lt;SMALL&gt;252  &lt;/SMALL&gt;    stored_data = data.DefaultData()
&lt;SMALL&gt;253  &lt;/SMALL&gt;
&lt;SMALL&gt;254  &lt;/SMALL&gt;  def _DoLogin(self, cookie, specials, params):
&lt;SMALL&gt;255  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /login url: validates the user and creates a cookie.
&lt;SMALL&gt;256  &lt;/SMALL&gt;
&lt;SMALL&gt;257  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;258  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;259  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;260  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;261  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;262  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;263  &lt;/SMALL&gt;    message = &#39;&#39;
&lt;SMALL&gt;264  &lt;/SMALL&gt;    if &#39;uid&#39; in params and &#39;pw&#39; in params:
&lt;SMALL&gt;265  &lt;/SMALL&gt;      uid = self._GetParameter(params, &#39;uid&#39;)
&lt;SMALL&gt;266  &lt;/SMALL&gt;      if uid in database:
&lt;SMALL&gt;267  &lt;/SMALL&gt;        if database[uid][&#39;pw&#39;] == self._GetParameter(params, &#39;pw&#39;):
&lt;SMALL&gt;268  &lt;/SMALL&gt;          (cookie, new_cookie_text) = (
&lt;SMALL&gt;269  &lt;/SMALL&gt;              self._CreateCookie(&#39;GRUYERE&#39;, uid))
&lt;SMALL&gt;270  &lt;/SMALL&gt;          self._DoHome(cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;271  &lt;/SMALL&gt;          return
&lt;SMALL&gt;272  &lt;/SMALL&gt;      message = &#39;Invalid user name or password.&#39;
&lt;SMALL&gt;273  &lt;/SMALL&gt;    # not logged in
&lt;SMALL&gt;274  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;275  &lt;/SMALL&gt;    self._SendTemplateResponse(&#39;/login.gtl&#39;, specials, params)
&lt;SMALL&gt;276  &lt;/SMALL&gt;
&lt;SMALL&gt;277  &lt;/SMALL&gt;  def _DoLogout(self, cookie, specials, params):
&lt;SMALL&gt;278  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /logout url: clears the cookie.
&lt;SMALL&gt;279  &lt;/SMALL&gt;
&lt;SMALL&gt;280  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;281  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;282  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;283  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;284  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;285  &lt;/SMALL&gt;    (cookie, new_cookie_text) = (
&lt;SMALL&gt;286  &lt;/SMALL&gt;        self._CreateCookie(&#39;GRUYERE&#39;, None))
&lt;SMALL&gt;287  &lt;/SMALL&gt;    self._DoHome(cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;288  &lt;/SMALL&gt;
&lt;SMALL&gt;289  &lt;/SMALL&gt;  def _Do(self, cookie, specials, params):
&lt;SMALL&gt;290  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the home page (http://localhost/).
&lt;SMALL&gt;291  &lt;/SMALL&gt;
&lt;SMALL&gt;292  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;293  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;294  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;295  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;296  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;297  &lt;/SMALL&gt;    self._DoHome(cookie, specials, params)
&lt;SMALL&gt;298  &lt;/SMALL&gt;
&lt;SMALL&gt;299  &lt;/SMALL&gt;  def _DoHome(self, cookie, specials, params, new_cookie_text=None):
&lt;SMALL&gt;300  &lt;/SMALL&gt;    &quot;&quot;&quot;Renders the home page.
&lt;SMALL&gt;301  &lt;/SMALL&gt;
&lt;SMALL&gt;302  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;303  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;304  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;305  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;306  &lt;/SMALL&gt;      new_cookie_text: New cookie.
&lt;SMALL&gt;307  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;308  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;309  &lt;/SMALL&gt;    specials[SPECIAL_COOKIE] = cookie
&lt;SMALL&gt;310  &lt;/SMALL&gt;    if cookie and cookie.get(COOKIE_UID):
&lt;SMALL&gt;311  &lt;/SMALL&gt;      specials[SPECIAL_PROFILE] = database.get(cookie[COOKIE_UID])
&lt;SMALL&gt;312  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;313  &lt;/SMALL&gt;      specials.pop(SPECIAL_PROFILE, None)
&lt;SMALL&gt;314  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;315  &lt;/SMALL&gt;        &#39;/home.gtl&#39;, specials, params, new_cookie_text)
&lt;SMALL&gt;316  &lt;/SMALL&gt;
&lt;SMALL&gt;317  &lt;/SMALL&gt;  def _DoBadUrl(self, path, cookie, specials, params):
&lt;SMALL&gt;318  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles invalid urls: displays an appropriate error message.
&lt;SMALL&gt;319  &lt;/SMALL&gt;
&lt;SMALL&gt;320  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;321  &lt;/SMALL&gt;      path: The invalid url.
&lt;SMALL&gt;322  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;323  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;324  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;325  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;326  &lt;/SMALL&gt;    self._SendError(&#39;Invalid request: %s&#39; % (path,), cookie, specials, params)
&lt;SMALL&gt;327  &lt;/SMALL&gt;
&lt;SMALL&gt;328  &lt;/SMALL&gt;  def _DoQuitserver(self, cookie, specials, params):
&lt;SMALL&gt;329  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /quitserver url for administrators to quit the server.
&lt;SMALL&gt;330  &lt;/SMALL&gt;
&lt;SMALL&gt;331  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;332  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;333  &lt;/SMALL&gt;      specials: Other special values for this request. (unused)
&lt;SMALL&gt;334  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;335  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;336  &lt;/SMALL&gt;    global quit_server
&lt;SMALL&gt;337  &lt;/SMALL&gt;    quit_server = True
&lt;SMALL&gt;338  &lt;/SMALL&gt;    self._SendTextResponse(&#39;Server quit.&#39;, None)
&lt;SMALL&gt;339  &lt;/SMALL&gt;
&lt;SMALL&gt;340  &lt;/SMALL&gt;  def _AddParameter(self, name, params, data_dict, default=None):
&lt;SMALL&gt;341  &lt;/SMALL&gt;    &quot;&quot;&quot;Transfers a value (with a default) from the parameters to the data.&quot;&quot;&quot;
&lt;SMALL&gt;342  &lt;/SMALL&gt;    if params.get(name):
&lt;SMALL&gt;343  &lt;/SMALL&gt;      data_dict[name] = params[name][0]
&lt;SMALL&gt;344  &lt;/SMALL&gt;    elif default is not None:
&lt;SMALL&gt;345  &lt;/SMALL&gt;      data_dict[name] = default
&lt;SMALL&gt;346  &lt;/SMALL&gt;
&lt;SMALL&gt;347  &lt;/SMALL&gt;  def _GetParameter(self, params, name, default=None):
&lt;SMALL&gt;348  &lt;/SMALL&gt;    &quot;&quot;&quot;Gets a parameter value with a default.&quot;&quot;&quot;
&lt;SMALL&gt;349  &lt;/SMALL&gt;    if params.get(name):
&lt;SMALL&gt;350  &lt;/SMALL&gt;      return params[name][0]
&lt;SMALL&gt;351  &lt;/SMALL&gt;    return default
&lt;SMALL&gt;352  &lt;/SMALL&gt;
&lt;SMALL&gt;353  &lt;/SMALL&gt;  def _GetSnippets(self, cookie, specials, create=False):
&lt;SMALL&gt;354  &lt;/SMALL&gt;    &quot;&quot;&quot;Returns all of the user&#39;s snippets.&quot;&quot;&quot;
&lt;SMALL&gt;355  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;356  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;357  &lt;/SMALL&gt;      profile = database[cookie[COOKIE_UID]]
&lt;SMALL&gt;358  &lt;/SMALL&gt;      if create and &#39;snippets&#39; not in profile:
&lt;SMALL&gt;359  &lt;/SMALL&gt;        profile[&#39;snippets&#39;] = []
&lt;SMALL&gt;360  &lt;/SMALL&gt;      snippets = profile[&#39;snippets&#39;]
&lt;SMALL&gt;361  &lt;/SMALL&gt;    except (KeyError, TypeError):
&lt;SMALL&gt;362  &lt;/SMALL&gt;      _Log(&#39;Error getting snippets&#39;)
&lt;SMALL&gt;363  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;364  &lt;/SMALL&gt;    return snippets
&lt;SMALL&gt;365  &lt;/SMALL&gt;
&lt;SMALL&gt;366  &lt;/SMALL&gt;  def _DoNewsnippet2(self, cookie, specials, params):
&lt;SMALL&gt;367  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /newsnippet2 url: actually add the snippet.
&lt;SMALL&gt;368  &lt;/SMALL&gt;
&lt;SMALL&gt;369  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;370  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;371  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;372  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;373  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;374  &lt;/SMALL&gt;    snippet = self._GetParameter(params, &#39;snippet&#39;)
&lt;SMALL&gt;375  &lt;/SMALL&gt;    if not snippet:
&lt;SMALL&gt;376  &lt;/SMALL&gt;      self._SendError(&#39;No snippet!&#39;, cookie, specials, params)
&lt;SMALL&gt;377  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;378  &lt;/SMALL&gt;      snippets = self._GetSnippets(cookie, specials, True)
&lt;SMALL&gt;379  &lt;/SMALL&gt;      if snippets is not None:
&lt;SMALL&gt;380  &lt;/SMALL&gt;        snippets.insert(0, snippet)
&lt;SMALL&gt;381  &lt;/SMALL&gt;    self._SendRedirect(&#39;/snippets.gtl&#39;, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;382  &lt;/SMALL&gt;
&lt;SMALL&gt;383  &lt;/SMALL&gt;  def _DoDeletesnippet(self, cookie, specials, params):
&lt;SMALL&gt;384  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /deletesnippet url: delete the indexed snippet.
&lt;SMALL&gt;385  &lt;/SMALL&gt;
&lt;SMALL&gt;386  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;387  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;388  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;389  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;390  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;391  &lt;/SMALL&gt;    index = self._GetParameter(params, &#39;index&#39;)
&lt;SMALL&gt;392  &lt;/SMALL&gt;    snippets = self._GetSnippets(cookie, specials)
&lt;SMALL&gt;393  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;394  &lt;/SMALL&gt;      del snippets[int(index)]
&lt;SMALL&gt;395  &lt;/SMALL&gt;    except (IndexError, TypeError, ValueError):
&lt;SMALL&gt;396  &lt;/SMALL&gt;      self._SendError(
&lt;SMALL&gt;397  &lt;/SMALL&gt;          &#39;Invalid index (%s)&#39; % (index,),
&lt;SMALL&gt;398  &lt;/SMALL&gt;          cookie, specials, params)
&lt;SMALL&gt;399  &lt;/SMALL&gt;      return
&lt;SMALL&gt;400  &lt;/SMALL&gt;    self._SendRedirect(&#39;/snippets.gtl&#39;, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;401  &lt;/SMALL&gt;
&lt;SMALL&gt;402  &lt;/SMALL&gt;  def _DoSaveprofile(self, cookie, specials, params):
&lt;SMALL&gt;403  &lt;/SMALL&gt;    &quot;&quot;&quot;Saves the user&#39;s profile.
&lt;SMALL&gt;404  &lt;/SMALL&gt;
&lt;SMALL&gt;405  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;406  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;407  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;408  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;409  &lt;/SMALL&gt;
&lt;SMALL&gt;410  &lt;/SMALL&gt;    If the &#39;action&#39; cgi parameter is &#39;new&#39;, then this is creating a new user
&lt;SMALL&gt;411  &lt;/SMALL&gt;    and it&#39;s an error if the user already exists. If action is &#39;update&#39;, then
&lt;SMALL&gt;412  &lt;/SMALL&gt;    this is editing an existing user&#39;s profile and it&#39;s an error if the user
&lt;SMALL&gt;413  &lt;/SMALL&gt;    does not exist.
&lt;SMALL&gt;414  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;415  &lt;/SMALL&gt;
&lt;SMALL&gt;416  &lt;/SMALL&gt;    # build new profile
&lt;SMALL&gt;417  &lt;/SMALL&gt;    profile_data = {}
&lt;SMALL&gt;418  &lt;/SMALL&gt;    uid = self._GetParameter(params, &#39;uid&#39;, cookie[COOKIE_UID])
&lt;SMALL&gt;419  &lt;/SMALL&gt;    newpw = self._GetParameter(params, &#39;pw&#39;)
&lt;SMALL&gt;420  &lt;/SMALL&gt;    self._AddParameter(&#39;name&#39;, params, profile_data, uid)
&lt;SMALL&gt;421  &lt;/SMALL&gt;    self._AddParameter(&#39;pw&#39;, params, profile_data)
&lt;SMALL&gt;422  &lt;/SMALL&gt;    self._AddParameter(&#39;is_author&#39;, params, profile_data)
&lt;SMALL&gt;423  &lt;/SMALL&gt;    self._AddParameter(&#39;is_admin&#39;, params, profile_data)
&lt;SMALL&gt;424  &lt;/SMALL&gt;    self._AddParameter(&#39;private_snippet&#39;, params, profile_data)
&lt;SMALL&gt;425  &lt;/SMALL&gt;    self._AddParameter(&#39;icon&#39;, params, profile_data)
&lt;SMALL&gt;426  &lt;/SMALL&gt;    self._AddParameter(&#39;web_site&#39;, params, profile_data)
&lt;SMALL&gt;427  &lt;/SMALL&gt;    self._AddParameter(&#39;color&#39;, params, profile_data)
&lt;SMALL&gt;428  &lt;/SMALL&gt;
&lt;SMALL&gt;429  &lt;/SMALL&gt;    # Each case below has to set either error or redirect
&lt;SMALL&gt;430  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;431  &lt;/SMALL&gt;    message = None
&lt;SMALL&gt;432  &lt;/SMALL&gt;    new_cookie_text = None
&lt;SMALL&gt;433  &lt;/SMALL&gt;    action = self._GetParameter(params, &#39;action&#39;)
&lt;SMALL&gt;434  &lt;/SMALL&gt;    if action == &#39;new&#39;:
&lt;SMALL&gt;435  &lt;/SMALL&gt;      if uid in database:
&lt;SMALL&gt;436  &lt;/SMALL&gt;        message = &#39;User already exists.&#39;
&lt;SMALL&gt;437  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;438  &lt;/SMALL&gt;        profile_data[&#39;pw&#39;] = newpw
&lt;SMALL&gt;439  &lt;/SMALL&gt;        database[uid] = profile_data
&lt;SMALL&gt;440  &lt;/SMALL&gt;        (cookie, new_cookie_text) = self._CreateCookie(&#39;GRUYERE&#39;, uid)
&lt;SMALL&gt;441  &lt;/SMALL&gt;        message = &#39;Account created.&#39;  # error message can also indicates success
&lt;SMALL&gt;442  &lt;/SMALL&gt;    elif action == &#39;update&#39;:
&lt;SMALL&gt;443  &lt;/SMALL&gt;      if uid not in database:
&lt;SMALL&gt;444  &lt;/SMALL&gt;        message = &#39;User does not exist.&#39;
&lt;SMALL&gt;445  &lt;/SMALL&gt;      elif (newpw and database[uid][&#39;pw&#39;] != self._GetParameter(params, &#39;oldpw&#39;)
&lt;SMALL&gt;446  &lt;/SMALL&gt;            and not cookie.get(COOKIE_ADMIN)):
&lt;SMALL&gt;447  &lt;/SMALL&gt;        # must be admin or supply old pw to change password
&lt;SMALL&gt;448  &lt;/SMALL&gt;        message = &#39;Incorrect password.&#39;
&lt;SMALL&gt;449  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;450  &lt;/SMALL&gt;        if newpw:
&lt;SMALL&gt;451  &lt;/SMALL&gt;          profile_data[&#39;pw&#39;] = newpw
&lt;SMALL&gt;452  &lt;/SMALL&gt;        database[uid].update(profile_data)
&lt;SMALL&gt;453  &lt;/SMALL&gt;        redirect = &#39;/&#39;
&lt;SMALL&gt;454  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;455  &lt;/SMALL&gt;      message = &#39;Invalid request&#39;
&lt;SMALL&gt;456  &lt;/SMALL&gt;    _Log(&#39;SetProfile(%s, %s): %s&#39; %(str(uid), str(action), str(message)))
&lt;SMALL&gt;457  &lt;/SMALL&gt;    if message:
&lt;SMALL&gt;458  &lt;/SMALL&gt;      self._SendError(message, cookie, specials, params, new_cookie_text)
&lt;SMALL&gt;459  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;460  &lt;/SMALL&gt;      self._SendRedirect(redirect, specials[SPECIAL_UNIQUE_ID])
&lt;SMALL&gt;461  &lt;/SMALL&gt;
&lt;SMALL&gt;462  &lt;/SMALL&gt;  def _SendHtmlResponse(self, html, new_cookie_text=None):
&lt;SMALL&gt;463  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends the provided html response with appropriate headers.
&lt;SMALL&gt;464  &lt;/SMALL&gt;
&lt;SMALL&gt;465  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;466  &lt;/SMALL&gt;      html: The response.
&lt;SMALL&gt;467  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;468  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;469  &lt;/SMALL&gt;    self.send_response(200)
&lt;SMALL&gt;470  &lt;/SMALL&gt;    self.send_header(&#39;Content-type&#39;, &#39;text/html&#39;)
&lt;SMALL&gt;471  &lt;/SMALL&gt;    self.send_header(&#39;Pragma&#39;, &#39;no-cache&#39;)
&lt;SMALL&gt;472  &lt;/SMALL&gt;    if new_cookie_text:
&lt;SMALL&gt;473  &lt;/SMALL&gt;      self.send_header(&#39;Set-Cookie&#39;, new_cookie_text)
&lt;SMALL&gt;474  &lt;/SMALL&gt;    self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;475  &lt;/SMALL&gt;    self.end_headers()
&lt;SMALL&gt;476  &lt;/SMALL&gt;    self.wfile.write(html)
&lt;SMALL&gt;477  &lt;/SMALL&gt;
&lt;SMALL&gt;478  &lt;/SMALL&gt;  def _SendTextResponse(self, text, new_cookie_text=None):
&lt;SMALL&gt;479  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a verbatim text response.&quot;&quot;&quot;
&lt;SMALL&gt;480  &lt;/SMALL&gt;
&lt;SMALL&gt;481  &lt;/SMALL&gt;    self._SendHtmlResponse(&#39;&amp;lt;pre&amp;gt;&#39; + cgi.escape(text) + &#39;&amp;lt;/pre&amp;gt;&#39;,
&lt;SMALL&gt;482  &lt;/SMALL&gt;                           new_cookie_text)
&lt;SMALL&gt;483  &lt;/SMALL&gt;
&lt;SMALL&gt;484  &lt;/SMALL&gt;  def _SendTemplateResponse(self, filename, specials, params,
&lt;SMALL&gt;485  &lt;/SMALL&gt;                            new_cookie_text=None):
&lt;SMALL&gt;486  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a response using a gtl template.
&lt;SMALL&gt;487  &lt;/SMALL&gt;
&lt;SMALL&gt;488  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;489  &lt;/SMALL&gt;      filename: The template file.
&lt;SMALL&gt;490  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;491  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;492  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;493  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;494  &lt;/SMALL&gt;    f = None
&lt;SMALL&gt;495  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;496  &lt;/SMALL&gt;      f = _Open(RESOURCE_PATH, filename)
&lt;SMALL&gt;497  &lt;/SMALL&gt;      template = f.read()
&lt;SMALL&gt;498  &lt;/SMALL&gt;    finally:
&lt;SMALL&gt;499  &lt;/SMALL&gt;      if f: f.close()
&lt;SMALL&gt;500  &lt;/SMALL&gt;    self._SendHtmlResponse(
&lt;SMALL&gt;501  &lt;/SMALL&gt;        gtl.ExpandTemplate(template, specials, params),
&lt;SMALL&gt;502  &lt;/SMALL&gt;        new_cookie_text)
&lt;SMALL&gt;503  &lt;/SMALL&gt;
&lt;SMALL&gt;504  &lt;/SMALL&gt;  def _SendFileResponse(self, filename, cookie, specials, params):
&lt;SMALL&gt;505  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends the contents of a file.
&lt;SMALL&gt;506  &lt;/SMALL&gt;
&lt;SMALL&gt;507  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;508  &lt;/SMALL&gt;      filename: The file to send.
&lt;SMALL&gt;509  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;510  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;511  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;512  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;513  &lt;/SMALL&gt;    content_type = None
&lt;SMALL&gt;514  &lt;/SMALL&gt;    if filename.endswith(&#39;.gtl&#39;):
&lt;SMALL&gt;515  &lt;/SMALL&gt;      self._SendTemplateResponse(filename, specials, params)
&lt;SMALL&gt;516  &lt;/SMALL&gt;      return
&lt;SMALL&gt;517  &lt;/SMALL&gt;
&lt;SMALL&gt;518  &lt;/SMALL&gt;    name_only = filename[filename.rfind(&#39;/&#39;):]
&lt;SMALL&gt;519  &lt;/SMALL&gt;    extension = name_only[name_only.rfind(&#39;.&#39;):]
&lt;SMALL&gt;520  &lt;/SMALL&gt;    if &#39;.&#39; not in extension:
&lt;SMALL&gt;521  &lt;/SMALL&gt;      content_type = &#39;text/plain&#39;
&lt;SMALL&gt;522  &lt;/SMALL&gt;    elif extension in RESOURCE_CONTENT_TYPES:
&lt;SMALL&gt;523  &lt;/SMALL&gt;      content_type = RESOURCE_CONTENT_TYPES[extension]
&lt;SMALL&gt;524  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;525  &lt;/SMALL&gt;      self._SendError(
&lt;SMALL&gt;526  &lt;/SMALL&gt;          &#39;Unrecognized file type (%s).&#39; % (filename,),
&lt;SMALL&gt;527  &lt;/SMALL&gt;          cookie, specials, params)
&lt;SMALL&gt;528  &lt;/SMALL&gt;      return
&lt;SMALL&gt;529  &lt;/SMALL&gt;    f = None
&lt;SMALL&gt;530  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;531  &lt;/SMALL&gt;      f = _Open(RESOURCE_PATH, filename, &#39;rb&#39;)
&lt;SMALL&gt;532  &lt;/SMALL&gt;      self.send_response(200)
&lt;SMALL&gt;533  &lt;/SMALL&gt;      self.send_header(&#39;Content-type&#39;, content_type)
&lt;SMALL&gt;534  &lt;/SMALL&gt;      # Always cache static resources
&lt;SMALL&gt;535  &lt;/SMALL&gt;      self.send_header(&#39;Cache-control&#39;, &#39;public, max-age=7200&#39;)
&lt;SMALL&gt;536  &lt;/SMALL&gt;      self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;537  &lt;/SMALL&gt;      self.end_headers()
&lt;SMALL&gt;538  &lt;/SMALL&gt;      self.wfile.write(f.read())
&lt;SMALL&gt;539  &lt;/SMALL&gt;    finally:
&lt;SMALL&gt;540  &lt;/SMALL&gt;      if f: f.close()
&lt;SMALL&gt;541  &lt;/SMALL&gt;
&lt;SMALL&gt;542  &lt;/SMALL&gt;  def _SendError(self, message, cookie, specials, params, new_cookie_text=None):
&lt;SMALL&gt;543  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends an error message (using the error.gtl template).
&lt;SMALL&gt;544  &lt;/SMALL&gt;
&lt;SMALL&gt;545  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;546  &lt;/SMALL&gt;      message: The error to display.
&lt;SMALL&gt;547  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;548  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;549  &lt;/SMALL&gt;      params: Cgi parameters.
&lt;SMALL&gt;550  &lt;/SMALL&gt;      new_cookie_text: New cookie to set.
&lt;SMALL&gt;551  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;552  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;553  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;554  &lt;/SMALL&gt;        &#39;/error.gtl&#39;, specials, params, new_cookie_text)
&lt;SMALL&gt;555  &lt;/SMALL&gt;
&lt;SMALL&gt;556  &lt;/SMALL&gt;  def _CreateCookie(self, cookie_name, uid):
&lt;SMALL&gt;557  &lt;/SMALL&gt;    &quot;&quot;&quot;Creates a cookie for this user.
&lt;SMALL&gt;558  &lt;/SMALL&gt;
&lt;SMALL&gt;559  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;560  &lt;/SMALL&gt;      cookie_name: Cookie to create.
&lt;SMALL&gt;561  &lt;/SMALL&gt;      uid: The user.
&lt;SMALL&gt;562  &lt;/SMALL&gt;
&lt;SMALL&gt;563  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;564  &lt;/SMALL&gt;      (cookie, new_cookie_text).
&lt;SMALL&gt;565  &lt;/SMALL&gt;
&lt;SMALL&gt;566  &lt;/SMALL&gt;    The cookie contains all the information we need to know about
&lt;SMALL&gt;567  &lt;/SMALL&gt;    the user for normal operations, including whether or not the user
&lt;SMALL&gt;568  &lt;/SMALL&gt;    should have access to the authoring pages or the admin pages.
&lt;SMALL&gt;569  &lt;/SMALL&gt;    The cookie is signed with a hash function.
&lt;SMALL&gt;570  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;571  &lt;/SMALL&gt;    if uid is None:
&lt;SMALL&gt;572  &lt;/SMALL&gt;      return (self.NULL_COOKIE, cookie_name + &#39;=; path=/&#39;)
&lt;SMALL&gt;573  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;574  &lt;/SMALL&gt;    profile = database[uid]
&lt;SMALL&gt;575  &lt;/SMALL&gt;    if profile.get(&#39;is_author&#39;, False):
&lt;SMALL&gt;576  &lt;/SMALL&gt;      is_author = &#39;author&#39;
&lt;SMALL&gt;577  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;578  &lt;/SMALL&gt;      is_author = &#39;&#39;
&lt;SMALL&gt;579  &lt;/SMALL&gt;    if profile.get(&#39;is_admin&#39;, False):
&lt;SMALL&gt;580  &lt;/SMALL&gt;      is_admin = &#39;admin&#39;
&lt;SMALL&gt;581  &lt;/SMALL&gt;    else:
&lt;SMALL&gt;582  &lt;/SMALL&gt;      is_admin = &#39;&#39;
&lt;SMALL&gt;583  &lt;/SMALL&gt;
&lt;SMALL&gt;584  &lt;/SMALL&gt;    c = {COOKIE_UID: uid, COOKIE_ADMIN: is_admin, COOKIE_AUTHOR: is_author}
&lt;SMALL&gt;585  &lt;/SMALL&gt;    c_data = &#39;%s|%s|%s&#39; % (uid, is_admin, is_author)
&lt;SMALL&gt;586  &lt;/SMALL&gt;
&lt;SMALL&gt;587  &lt;/SMALL&gt;    # global cookie_secret; only use positive hash values
&lt;SMALL&gt;588  &lt;/SMALL&gt;    h_data = str(hash(cookie_secret + c_data) &amp;amp; 0x7FFFFFF)
&lt;SMALL&gt;589  &lt;/SMALL&gt;    c_text = &#39;%s=%s|%s; path=/&#39; % (cookie_name, h_data, c_data)
&lt;SMALL&gt;590  &lt;/SMALL&gt;    return (c, c_text)
&lt;SMALL&gt;591  &lt;/SMALL&gt;
&lt;SMALL&gt;592  &lt;/SMALL&gt;  def _GetCookie(self, cookie_name):
&lt;SMALL&gt;593  &lt;/SMALL&gt;    &quot;&quot;&quot;Reads, verifies and parses the cookie.
&lt;SMALL&gt;594  &lt;/SMALL&gt;
&lt;SMALL&gt;595  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;596  &lt;/SMALL&gt;      cookie_name: The cookie to get.
&lt;SMALL&gt;597  &lt;/SMALL&gt;
&lt;SMALL&gt;598  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;599  &lt;/SMALL&gt;      a dict containing user, is_admin, and is_author if the cookie
&lt;SMALL&gt;600  &lt;/SMALL&gt;      is present and valid. Otherwise, None.
&lt;SMALL&gt;601  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;602  &lt;/SMALL&gt;    cookies = self.headers.get(&#39;Cookie&#39;)
&lt;SMALL&gt;603  &lt;/SMALL&gt;    if isinstance(cookies, str):
&lt;SMALL&gt;604  &lt;/SMALL&gt;      for c in cookies.split(&#39;;&#39;):
&lt;SMALL&gt;605  &lt;/SMALL&gt;        matched_cookie = self._MatchCookie(cookie_name, c)
&lt;SMALL&gt;606  &lt;/SMALL&gt;        if matched_cookie:
&lt;SMALL&gt;607  &lt;/SMALL&gt;          return self._ParseCookie(matched_cookie)
&lt;SMALL&gt;608  &lt;/SMALL&gt;    return self.NULL_COOKIE
&lt;SMALL&gt;609  &lt;/SMALL&gt;
&lt;SMALL&gt;610  &lt;/SMALL&gt;  def _MatchCookie(self, cookie_name, cookie):
&lt;SMALL&gt;611  &lt;/SMALL&gt;    &quot;&quot;&quot;Matches the cookie.
&lt;SMALL&gt;612  &lt;/SMALL&gt;
&lt;SMALL&gt;613  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;614  &lt;/SMALL&gt;      cookie_name: The name of the cookie.
&lt;SMALL&gt;615  &lt;/SMALL&gt;      cookie: The full cookie (name=value).
&lt;SMALL&gt;616  &lt;/SMALL&gt;
&lt;SMALL&gt;617  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;618  &lt;/SMALL&gt;      The cookie if it matches or None if it doesn&#39;t match.
&lt;SMALL&gt;619  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;620  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;621  &lt;/SMALL&gt;      (cn, cd) = cookie.strip().split(&#39;=&#39;, 1)
&lt;SMALL&gt;622  &lt;/SMALL&gt;      if cn != cookie_name:
&lt;SMALL&gt;623  &lt;/SMALL&gt;        return None
&lt;SMALL&gt;624  &lt;/SMALL&gt;    except (IndexError, ValueError):
&lt;SMALL&gt;625  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;626  &lt;/SMALL&gt;    return cd
&lt;SMALL&gt;627  &lt;/SMALL&gt;
&lt;SMALL&gt;628  &lt;/SMALL&gt;  def _ParseCookie(self, cookie):
&lt;SMALL&gt;629  &lt;/SMALL&gt;    &quot;&quot;&quot;Parses the cookie and returns NULL_COOKIE if it&#39;s invalid.
&lt;SMALL&gt;630  &lt;/SMALL&gt;
&lt;SMALL&gt;631  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;632  &lt;/SMALL&gt;      cookie: The text of the cookie.
&lt;SMALL&gt;633  &lt;/SMALL&gt;
&lt;SMALL&gt;634  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;635  &lt;/SMALL&gt;      A map containing the values in the cookie.
&lt;SMALL&gt;636  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;637  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;638  &lt;/SMALL&gt;      (hashed, cookie_data) = cookie.split(&#39;|&#39;, 1)
&lt;SMALL&gt;639  &lt;/SMALL&gt;      # global cookie_secret
&lt;SMALL&gt;640  &lt;/SMALL&gt;      if hashed != str(hash(cookie_secret + cookie_data) &amp;amp; 0x7FFFFFF):
&lt;SMALL&gt;641  &lt;/SMALL&gt;        return self.NULL_COOKIE
&lt;SMALL&gt;642  &lt;/SMALL&gt;      values = cookie_data.split(&#39;|&#39;)
&lt;SMALL&gt;643  &lt;/SMALL&gt;      return {
&lt;SMALL&gt;644  &lt;/SMALL&gt;          COOKIE_UID: values[0],
&lt;SMALL&gt;645  &lt;/SMALL&gt;          COOKIE_ADMIN: values[1] == &#39;admin&#39;,
&lt;SMALL&gt;646  &lt;/SMALL&gt;          COOKIE_AUTHOR: values[2] == &#39;author&#39;,
&lt;SMALL&gt;647  &lt;/SMALL&gt;      }
&lt;SMALL&gt;648  &lt;/SMALL&gt;    except (IndexError, ValueError):
&lt;SMALL&gt;649  &lt;/SMALL&gt;      return self.NULL_COOKIE
&lt;SMALL&gt;650  &lt;/SMALL&gt;
&lt;SMALL&gt;651  &lt;/SMALL&gt;  def _DoReset(self, cookie, specials, params):  # debug only; resets this db
&lt;SMALL&gt;652  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /reset url for administrators to reset the database.
&lt;SMALL&gt;653  &lt;/SMALL&gt;
&lt;SMALL&gt;654  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;655  &lt;/SMALL&gt;      cookie: The cookie for this request. (unused)
&lt;SMALL&gt;656  &lt;/SMALL&gt;      specials: Other special values for this request. (unused)
&lt;SMALL&gt;657  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;658  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;659  &lt;/SMALL&gt;    self._ResetDatabase()
&lt;SMALL&gt;660  &lt;/SMALL&gt;    self._SendTextResponse(&#39;Server reset to default values...&#39;, None)
&lt;SMALL&gt;661  &lt;/SMALL&gt;
&lt;SMALL&gt;662  &lt;/SMALL&gt;  def _DoUpload2(self, cookie, specials, params):
&lt;SMALL&gt;663  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles the /upload2 url: finish the upload and save the file.
&lt;SMALL&gt;664  &lt;/SMALL&gt;
&lt;SMALL&gt;665  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;666  &lt;/SMALL&gt;      cookie: The cookie for this request.
&lt;SMALL&gt;667  &lt;/SMALL&gt;      specials: Other special values for this request.
&lt;SMALL&gt;668  &lt;/SMALL&gt;      params: Cgi parameters. (unused)
&lt;SMALL&gt;669  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;670  &lt;/SMALL&gt;    (filename, file_data) = self._ExtractFileFromRequest()
&lt;SMALL&gt;671  &lt;/SMALL&gt;    directory = self._MakeUserDirectory(cookie[COOKIE_UID])
&lt;SMALL&gt;672  &lt;/SMALL&gt;
&lt;SMALL&gt;673  &lt;/SMALL&gt;    message = None
&lt;SMALL&gt;674  &lt;/SMALL&gt;    url = None
&lt;SMALL&gt;675  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;676  &lt;/SMALL&gt;      f = _Open(directory, filename, &#39;wb&#39;)
&lt;SMALL&gt;677  &lt;/SMALL&gt;      f.write(file_data)
&lt;SMALL&gt;678  &lt;/SMALL&gt;      f.close()
&lt;SMALL&gt;679  &lt;/SMALL&gt;      (host, port) = http_server.server_address
&lt;SMALL&gt;680  &lt;/SMALL&gt;      url = &#39;http://%s:%d/%s/%s/%s&#39; % (
&lt;SMALL&gt;681  &lt;/SMALL&gt;          host, port, specials[SPECIAL_UNIQUE_ID], cookie[COOKIE_UID], filename)
&lt;SMALL&gt;682  &lt;/SMALL&gt;    except IOError, ex:
&lt;SMALL&gt;683  &lt;/SMALL&gt;      message = &#39;Couldn\&#39;t write file %s: %s&#39; % (filename, ex.message)
&lt;SMALL&gt;684  &lt;/SMALL&gt;      _Log(message)
&lt;SMALL&gt;685  &lt;/SMALL&gt;
&lt;SMALL&gt;686  &lt;/SMALL&gt;    specials[&#39;_message&#39;] = message
&lt;SMALL&gt;687  &lt;/SMALL&gt;    self._SendTemplateResponse(
&lt;SMALL&gt;688  &lt;/SMALL&gt;        &#39;/upload2.gtl&#39;, specials,
&lt;SMALL&gt;689  &lt;/SMALL&gt;        {&#39;url&#39;: url})
&lt;SMALL&gt;690  &lt;/SMALL&gt;
&lt;SMALL&gt;691  &lt;/SMALL&gt;  def _ExtractFileFromRequest(self):
&lt;SMALL&gt;692  &lt;/SMALL&gt;    &quot;&quot;&quot;Extracts the file from an upload request.
&lt;SMALL&gt;693  &lt;/SMALL&gt;
&lt;SMALL&gt;694  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;695  &lt;/SMALL&gt;      (filename, file_data)
&lt;SMALL&gt;696  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;697  &lt;/SMALL&gt;    form = cgi.FieldStorage(
&lt;SMALL&gt;698  &lt;/SMALL&gt;        fp=self.rfile,
&lt;SMALL&gt;699  &lt;/SMALL&gt;        headers=self.headers,
&lt;SMALL&gt;700  &lt;/SMALL&gt;        environ={&#39;REQUEST_METHOD&#39;: &#39;POST&#39;,
&lt;SMALL&gt;701  &lt;/SMALL&gt;                 &#39;CONTENT_TYPE&#39;: self.headers.getheader(&#39;content-type&#39;)})
&lt;SMALL&gt;702  &lt;/SMALL&gt;
&lt;SMALL&gt;703  &lt;/SMALL&gt;    upload_file = form[&#39;upload_file&#39;]
&lt;SMALL&gt;704  &lt;/SMALL&gt;    file_data = upload_file.file.read()
&lt;SMALL&gt;705  &lt;/SMALL&gt;    return (upload_file.filename, file_data)
&lt;SMALL&gt;706  &lt;/SMALL&gt;
&lt;SMALL&gt;707  &lt;/SMALL&gt;  def _MakeUserDirectory(self, uid):
&lt;SMALL&gt;708  &lt;/SMALL&gt;    &quot;&quot;&quot;Creates a separate directory for each user to avoid upload conflicts.
&lt;SMALL&gt;709  &lt;/SMALL&gt;
&lt;SMALL&gt;710  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;711  &lt;/SMALL&gt;      uid: The user to create a directory for.
&lt;SMALL&gt;712  &lt;/SMALL&gt;
&lt;SMALL&gt;713  &lt;/SMALL&gt;    Returns:
&lt;SMALL&gt;714  &lt;/SMALL&gt;      The new directory path (/uid/).
&lt;SMALL&gt;715  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;716  &lt;/SMALL&gt;
&lt;SMALL&gt;717  &lt;/SMALL&gt;    directory = RESOURCE_PATH + os.sep + str(uid) + os.sep
&lt;SMALL&gt;718  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;719  &lt;/SMALL&gt;      print &#39;mkdir: &#39;, directory
&lt;SMALL&gt;720  &lt;/SMALL&gt;      os.mkdir(directory)
&lt;SMALL&gt;721  &lt;/SMALL&gt;      # throws an exception if directory already exists,
&lt;SMALL&gt;722  &lt;/SMALL&gt;      # however exception type varies by platform
&lt;SMALL&gt;723  &lt;/SMALL&gt;    except Exception:
&lt;SMALL&gt;724  &lt;/SMALL&gt;      pass  # just ignore it if it already exists
&lt;SMALL&gt;725  &lt;/SMALL&gt;    return directory
&lt;SMALL&gt;726  &lt;/SMALL&gt;
&lt;SMALL&gt;727  &lt;/SMALL&gt;  def _SendRedirect(self, url, unique_id):
&lt;SMALL&gt;728  &lt;/SMALL&gt;    &quot;&quot;&quot;Sends a 302 redirect.
&lt;SMALL&gt;729  &lt;/SMALL&gt;
&lt;SMALL&gt;730  &lt;/SMALL&gt;    Automatically adds the unique_id.
&lt;SMALL&gt;731  &lt;/SMALL&gt;
&lt;SMALL&gt;732  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;733  &lt;/SMALL&gt;      url: The location to redirect to which must start with &#39;/&#39;.
&lt;SMALL&gt;734  &lt;/SMALL&gt;      unique_id: The unique id to include in the url.
&lt;SMALL&gt;735  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;736  &lt;/SMALL&gt;    if not url:
&lt;SMALL&gt;737  &lt;/SMALL&gt;      url = &#39;/&#39;
&lt;SMALL&gt;738  &lt;/SMALL&gt;    url = &#39;/&#39; + unique_id + url
&lt;SMALL&gt;739  &lt;/SMALL&gt;    self.send_response(302)
&lt;SMALL&gt;740  &lt;/SMALL&gt;    self.send_header(&#39;Location&#39;, url)
&lt;SMALL&gt;741  &lt;/SMALL&gt;    self.send_header(&#39;Pragma&#39;, &#39;no-cache&#39;)
&lt;SMALL&gt;742  &lt;/SMALL&gt;    self.send_header(&#39;Content-type&#39;, &#39;text/html&#39;)
&lt;SMALL&gt;743  &lt;/SMALL&gt;    self.send_header(&#39;X-XSS-Protection&#39;, &#39;0&#39;)
&lt;SMALL&gt;744  &lt;/SMALL&gt;    self.end_headers()
&lt;SMALL&gt;745  &lt;/SMALL&gt;    self.wfile.write(
&lt;SMALL&gt;746  &lt;/SMALL&gt;        &#39;&#39;&#39;&amp;lt;!DOCTYPE HTML PUBLIC &#39;-//W3C//DTD HTML//EN&#39;&amp;gt;
&lt;SMALL&gt;747  &lt;/SMALL&gt;        &amp;lt;html&amp;gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt;748  &lt;/SMALL&gt;        &amp;lt;title&amp;gt;302 Redirect&amp;lt;/title&amp;gt;
&lt;SMALL&gt;749  &lt;/SMALL&gt;        Redirected &amp;lt;a href=&quot;%s&quot;&amp;gt;here&amp;lt;/a&amp;gt;
&lt;SMALL&gt;750  &lt;/SMALL&gt;        &amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&#39;&#39;&#39;
&lt;SMALL&gt;751  &lt;/SMALL&gt;        % (url,))
&lt;SMALL&gt;752  &lt;/SMALL&gt;
&lt;SMALL&gt;753  &lt;/SMALL&gt;  def _GetHandlerFunction(self, path):
&lt;SMALL&gt;754  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;755  &lt;/SMALL&gt;      return getattr(GruyereRequestHandler, &#39;_Do&#39; + path[1:].capitalize())
&lt;SMALL&gt;756  &lt;/SMALL&gt;    except AttributeError:
&lt;SMALL&gt;757  &lt;/SMALL&gt;      return None
&lt;SMALL&gt;758  &lt;/SMALL&gt;
&lt;SMALL&gt;759  &lt;/SMALL&gt;  def do_POST(self):  # part of BaseHTTPRequestHandler interface
&lt;SMALL&gt;760  &lt;/SMALL&gt;    self.DoGetOrPost()
&lt;SMALL&gt;761  &lt;/SMALL&gt;
&lt;SMALL&gt;762  &lt;/SMALL&gt;  def do_GET(self):  # part of BaseHTTPRequestHandler interface
&lt;SMALL&gt;763  &lt;/SMALL&gt;    self.DoGetOrPost()
&lt;SMALL&gt;764  &lt;/SMALL&gt;
&lt;SMALL&gt;765  &lt;/SMALL&gt;  def DoGetOrPost(self):
&lt;SMALL&gt;766  &lt;/SMALL&gt;    &quot;&quot;&quot;Validate an http get or post request and call HandleRequest.&quot;&quot;&quot;
&lt;SMALL&gt;767  &lt;/SMALL&gt;
&lt;SMALL&gt;768  &lt;/SMALL&gt;    url = urlparse(self.path)
&lt;SMALL&gt;769  &lt;/SMALL&gt;    path = url[2]
&lt;SMALL&gt;770  &lt;/SMALL&gt;    query = url[4]
&lt;SMALL&gt;771  &lt;/SMALL&gt;
&lt;SMALL&gt;772  &lt;/SMALL&gt;    # Normally, Gruyere only accepts connections to/from localhost. If you
&lt;SMALL&gt;773  &lt;/SMALL&gt;    # would like to allow access from other ip addresses, add the addresses
&lt;SMALL&gt;774  &lt;/SMALL&gt;    # of the other machines to allowed_ips and change insecure_mode to True
&lt;SMALL&gt;775  &lt;/SMALL&gt;    # above. This makes the application more vulnerable to a real attack so
&lt;SMALL&gt;776  &lt;/SMALL&gt;    # you should only add ips of machines you completely control and make
&lt;SMALL&gt;777  &lt;/SMALL&gt;    # sure that you are not using them to access any other web pages while
&lt;SMALL&gt;778  &lt;/SMALL&gt;    # you are using Gruyere.
&lt;SMALL&gt;779  &lt;/SMALL&gt;
&lt;SMALL&gt;780  &lt;/SMALL&gt;    allowed_ips = [&#39;127.0.0.1&#39;]
&lt;SMALL&gt;781  &lt;/SMALL&gt;
&lt;SMALL&gt;782  &lt;/SMALL&gt;    # WARNING! DO NOT CHANGE THE FOLLOWING SECTION OF CODE!
&lt;SMALL&gt;783  &lt;/SMALL&gt;
&lt;SMALL&gt;784  &lt;/SMALL&gt;    # This application is very exploitable. See main for details. What we&#39;re
&lt;SMALL&gt;785  &lt;/SMALL&gt;    # doing here is (2) and (3) on the previous list:
&lt;SMALL&gt;786  &lt;/SMALL&gt;    #   (2) If a request is received from any IP other than localhost, quit.
&lt;SMALL&gt;787  &lt;/SMALL&gt;    # An external attacker could still mount an attack on this IP by putting
&lt;SMALL&gt;788  &lt;/SMALL&gt;    # an attack on an external web page, e.g., a web page that redirects to
&lt;SMALL&gt;789  &lt;/SMALL&gt;    # a vulnerable url on 127.0.0.1 (which is why we use a random number).
&lt;SMALL&gt;790  &lt;/SMALL&gt;    #   (3) Inject a random identifier as the first part of the path and
&lt;SMALL&gt;791  &lt;/SMALL&gt;    # quit if a request is received without this identifier (except for an
&lt;SMALL&gt;792  &lt;/SMALL&gt;    # empty path which redirects and /favicon.ico).
&lt;SMALL&gt;793  &lt;/SMALL&gt;
&lt;SMALL&gt;794  &lt;/SMALL&gt;    request_ip = self.client_address[0]                      # DO NOT CHANGE
&lt;SMALL&gt;795  &lt;/SMALL&gt;    if request_ip not in allowed_ips:                        # DO NOT CHANGE
&lt;SMALL&gt;796  &lt;/SMALL&gt;      print &amp;gt;&amp;gt;sys.stderr, (                                  # DO NOT CHANGE
&lt;SMALL&gt;797  &lt;/SMALL&gt;          &#39;DANGER! Request from bad ip: &#39; + request_ip)      # DO NOT CHANGE
&lt;SMALL&gt;798  &lt;/SMALL&gt;      _Exit(&#39;bad_ip&#39;)                                        # DO NOT CHANGE
&lt;SMALL&gt;799  &lt;/SMALL&gt;
&lt;SMALL&gt;800  &lt;/SMALL&gt;    if (server_unique_id not in path                         # DO NOT CHANGE
&lt;SMALL&gt;801  &lt;/SMALL&gt;        and path != &#39;/favicon.ico&#39;):                         # DO NOT CHANGE
&lt;SMALL&gt;802  &lt;/SMALL&gt;      if path == &#39;&#39; or path == &#39;/&#39;:                          # DO NOT CHANGE
&lt;SMALL&gt;803  &lt;/SMALL&gt;        self._SendRedirect(&#39;/&#39;, server_unique_id)            # DO NOT CHANGE
&lt;SMALL&gt;804  &lt;/SMALL&gt;        return                                               # DO NOT CHANGE
&lt;SMALL&gt;805  &lt;/SMALL&gt;      else:                                                  # DO NOT CHANGE
&lt;SMALL&gt;806  &lt;/SMALL&gt;        print &amp;gt;&amp;gt;sys.stderr, (                                # DO NOT CHANGE
&lt;SMALL&gt;807  &lt;/SMALL&gt;            &#39;DANGER! Request without unique id: &#39; + path)    # DO NOT CHANGE
&lt;SMALL&gt;808  &lt;/SMALL&gt;        _Exit(&#39;bad_id&#39;)                                      # DO NOT CHANGE
&lt;SMALL&gt;809  &lt;/SMALL&gt;
&lt;SMALL&gt;810  &lt;/SMALL&gt;    path = path.replace(&#39;/&#39; + server_unique_id, &#39;&#39;, 1)       # DO NOT CHANGE
&lt;SMALL&gt;811  &lt;/SMALL&gt;
&lt;SMALL&gt;812  &lt;/SMALL&gt;    # END WARNING!
&lt;SMALL&gt;813  &lt;/SMALL&gt;
&lt;SMALL&gt;814  &lt;/SMALL&gt;    self.HandleRequest(path, query, server_unique_id)
&lt;SMALL&gt;815  &lt;/SMALL&gt;
&lt;SMALL&gt;816  &lt;/SMALL&gt;  def HandleRequest(self, path, query, unique_id):
&lt;SMALL&gt;817  &lt;/SMALL&gt;    &quot;&quot;&quot;Handles an http request.
&lt;SMALL&gt;818  &lt;/SMALL&gt;
&lt;SMALL&gt;819  &lt;/SMALL&gt;    Args:
&lt;SMALL&gt;820  &lt;/SMALL&gt;      path: The path part of the url, with leading slash.
&lt;SMALL&gt;821  &lt;/SMALL&gt;      query: The query part of the url, without leading question mark.
&lt;SMALL&gt;822  &lt;/SMALL&gt;      unique_id: The unique id from the url.
&lt;SMALL&gt;823  &lt;/SMALL&gt;    &quot;&quot;&quot;
&lt;SMALL&gt;824  &lt;/SMALL&gt;
&lt;SMALL&gt;825  &lt;/SMALL&gt;    path = urllib.unquote(path)
&lt;SMALL&gt;826  &lt;/SMALL&gt;
&lt;SMALL&gt;827  &lt;/SMALL&gt;    if not path:
&lt;SMALL&gt;828  &lt;/SMALL&gt;      self._SendRedirect(&#39;/&#39;, server_unique_id)
&lt;SMALL&gt;829  &lt;/SMALL&gt;      return
&lt;SMALL&gt;830  &lt;/SMALL&gt;    params = cgi.parse_qs(query)  # url.query
&lt;SMALL&gt;831  &lt;/SMALL&gt;    specials = {}
&lt;SMALL&gt;832  &lt;/SMALL&gt;    cookie = self._GetCookie(&#39;GRUYERE&#39;)
&lt;SMALL&gt;833  &lt;/SMALL&gt;    database = self._GetDatabase()
&lt;SMALL&gt;834  &lt;/SMALL&gt;    specials[SPECIAL_COOKIE] = cookie
&lt;SMALL&gt;835  &lt;/SMALL&gt;    specials[SPECIAL_DB] = database
&lt;SMALL&gt;836  &lt;/SMALL&gt;    specials[SPECIAL_PROFILE] = database.get(cookie.get(COOKIE_UID))
&lt;SMALL&gt;837  &lt;/SMALL&gt;    specials[SPECIAL_PARAMS] = params
&lt;SMALL&gt;838  &lt;/SMALL&gt;    specials[SPECIAL_UNIQUE_ID] = unique_id
&lt;SMALL&gt;839  &lt;/SMALL&gt;
&lt;SMALL&gt;840  &lt;/SMALL&gt;    if path in self._PROTECTED_URLS and not cookie[COOKIE_ADMIN]:
&lt;SMALL&gt;841  &lt;/SMALL&gt;      self._SendError(&#39;Invalid request&#39;, cookie, specials, params)
&lt;SMALL&gt;842  &lt;/SMALL&gt;      return
&lt;SMALL&gt;843  &lt;/SMALL&gt;
&lt;SMALL&gt;844  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;845  &lt;/SMALL&gt;      handler = self._GetHandlerFunction(path)
&lt;SMALL&gt;846  &lt;/SMALL&gt;      if callable(handler):
&lt;SMALL&gt;847  &lt;/SMALL&gt;        (handler)(self, cookie, specials, params)
&lt;SMALL&gt;848  &lt;/SMALL&gt;      else:
&lt;SMALL&gt;849  &lt;/SMALL&gt;        try:
&lt;SMALL&gt;850  &lt;/SMALL&gt;          self._SendFileResponse(path, cookie, specials, params)
&lt;SMALL&gt;851  &lt;/SMALL&gt;        except IOError:
&lt;SMALL&gt;852  &lt;/SMALL&gt;          self._DoBadUrl(path, cookie, specials, params)
&lt;SMALL&gt;853  &lt;/SMALL&gt;    except KeyboardInterrupt:
&lt;SMALL&gt;854  &lt;/SMALL&gt;      _Exit(&#39;KeyboardInterrupt&#39;)
&lt;SMALL&gt;855  &lt;/SMALL&gt;
&lt;SMALL&gt;856  &lt;/SMALL&gt;
&lt;SMALL&gt;857  &lt;/SMALL&gt;def _Log(message):
&lt;SMALL&gt;858  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, message
&lt;SMALL&gt;859  &lt;/SMALL&gt;
&lt;SMALL&gt;860  &lt;/SMALL&gt;
&lt;SMALL&gt;861  &lt;/SMALL&gt;if __name__ == &#39;__main__&#39;:
&lt;SMALL&gt;862  &lt;/SMALL&gt;  main()
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/gtl.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (348 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/gtl.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?gtl.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: c955e5f883c8e7ef5f56d5ad3d0a4d02
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 15231

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (15231 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;gtl.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;Gruyere Template Language, part of Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import cgi
&lt;SMALL&gt; 23  &lt;/SMALL&gt;import logging
&lt;SMALL&gt; 24  &lt;/SMALL&gt;import operator
&lt;SMALL&gt; 25  &lt;/SMALL&gt;import os
&lt;SMALL&gt; 26  &lt;/SMALL&gt;import pprint
&lt;SMALL&gt; 27  &lt;/SMALL&gt;import sys
&lt;SMALL&gt; 28  &lt;/SMALL&gt;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;# our modules
&lt;SMALL&gt; 30  &lt;/SMALL&gt;import gruyere
&lt;SMALL&gt; 31  &lt;/SMALL&gt;import sanitize
&lt;SMALL&gt; 32  &lt;/SMALL&gt;
&lt;SMALL&gt; 33  &lt;/SMALL&gt;
&lt;SMALL&gt; 34  &lt;/SMALL&gt;def ExpandTemplate(template, specials, params, name=&#39;&#39;):
&lt;SMALL&gt; 35  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a template.
&lt;SMALL&gt; 36  &lt;/SMALL&gt;
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    template: a string template.
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    specials: a dict of special values.
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    params: a dict of parameter values.
&lt;SMALL&gt; 41  &lt;/SMALL&gt;    name: the name of the _this object.
&lt;SMALL&gt; 42  &lt;/SMALL&gt;
&lt;SMALL&gt; 43  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    the expanded template.
&lt;SMALL&gt; 45  &lt;/SMALL&gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;  The template language includes these block structures:
&lt;SMALL&gt; 47  &lt;/SMALL&gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;    [[include:&amp;lt;filename&amp;gt;]] ...[[/include:&amp;lt;filename&amp;gt;]]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;      Insert the file or if the file cannot be opened insert the contents of
&lt;SMALL&gt; 50  &lt;/SMALL&gt;      the block. The path should use / as a separator regardless of what
&lt;SMALL&gt; 51  &lt;/SMALL&gt;      the underlying operating system is.
&lt;SMALL&gt; 52  &lt;/SMALL&gt;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;    [[for:&amp;lt;variable&amp;gt;]] ... [[/for:&amp;lt;variable&amp;gt;]]
&lt;SMALL&gt; 54  &lt;/SMALL&gt;      Iterate over the variable (which should be a mapping or sequence) and
&lt;SMALL&gt; 55  &lt;/SMALL&gt;      insert the block once for each value. Inside the loop _key is bound to
&lt;SMALL&gt; 56  &lt;/SMALL&gt;      the key value for the iteration.
&lt;SMALL&gt; 57  &lt;/SMALL&gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;    [[if:&amp;lt;variable&amp;gt;]] ... [[/if:&amp;lt;variable&amp;gt;]]
&lt;SMALL&gt; 59  &lt;/SMALL&gt;      Expand the contents of the block if the variable is not &#39;false&#39;.  There
&lt;SMALL&gt; 60  &lt;/SMALL&gt;      is no else; use [[if:!&amp;lt;variable&amp;gt;]] instead.
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;    Note that in each case the end tags must match the begin tags with a
&lt;SMALL&gt; 63  &lt;/SMALL&gt;    leading slash. This prevents mismatched tags and makes it easier to parse.
&lt;SMALL&gt; 64  &lt;/SMALL&gt;
&lt;SMALL&gt; 65  &lt;/SMALL&gt;  The variable syntax is:
&lt;SMALL&gt; 66  &lt;/SMALL&gt;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;    {{&amp;lt;field&amp;gt;[.&amp;lt;field&amp;gt;]*[:&amp;lt;escaper&amp;gt;]}}
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;  where &amp;lt;field&amp;gt; is:
&lt;SMALL&gt; 70  &lt;/SMALL&gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;    a key to extract from a mapping
&lt;SMALL&gt; 72  &lt;/SMALL&gt;    a number to extract from a sequence
&lt;SMALL&gt; 73  &lt;/SMALL&gt;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  Variable names that start with &#39;_&#39; are special values:
&lt;SMALL&gt; 75  &lt;/SMALL&gt;    _key = iteration key (inside loops)
&lt;SMALL&gt; 76  &lt;/SMALL&gt;    _this = iteration value (inside loop)
&lt;SMALL&gt; 77  &lt;/SMALL&gt;    _db = the database
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    _cookie = the user&#39;s cookie
&lt;SMALL&gt; 79  &lt;/SMALL&gt;    _profile = the user&#39;s profile ~ _db.*(_cookie.user)
&lt;SMALL&gt; 80  &lt;/SMALL&gt;
&lt;SMALL&gt; 81  &lt;/SMALL&gt;  If a field name starts with &#39;*&#39; it refers to a dereferenced parameter (orx
&lt;SMALL&gt; 82  &lt;/SMALL&gt;  *_this). For example, _db.*uid retrieves the entry from _db matching the
&lt;SMALL&gt; 83  &lt;/SMALL&gt;  uid parameter.
&lt;SMALL&gt; 84  &lt;/SMALL&gt;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;  The comment syntax is:
&lt;SMALL&gt; 86  &lt;/SMALL&gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;    {{#&amp;lt;comment&amp;gt;}}
&lt;SMALL&gt; 88  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 89  &lt;/SMALL&gt;  t = _ExpandBlocks(template, specials, params, name)
&lt;SMALL&gt; 90  &lt;/SMALL&gt;  t = _ExpandVariables(t, specials, params, name)
&lt;SMALL&gt; 91  &lt;/SMALL&gt;  return t
&lt;SMALL&gt; 92  &lt;/SMALL&gt;
&lt;SMALL&gt; 93  &lt;/SMALL&gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;BLOCK_OPEN = &#39;[[&#39;
&lt;SMALL&gt; 95  &lt;/SMALL&gt;END_BLOCK_OPEN = &#39;[[/&#39;
&lt;SMALL&gt; 96  &lt;/SMALL&gt;BLOCK_CLOSE = &#39;]]&#39;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;
&lt;SMALL&gt; 98  &lt;/SMALL&gt;
&lt;SMALL&gt; 99  &lt;/SMALL&gt;def _ExpandBlocks(template, specials, params, name):
&lt;SMALL&gt;100  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands all the blocks in a template.&quot;&quot;&quot;
&lt;SMALL&gt;101  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;102  &lt;/SMALL&gt;  rest = template
&lt;SMALL&gt;103  &lt;/SMALL&gt;  while rest:
&lt;SMALL&gt;104  &lt;/SMALL&gt;    tag, before_tag, after_tag = _FindTag(rest, BLOCK_OPEN, BLOCK_CLOSE)
&lt;SMALL&gt;105  &lt;/SMALL&gt;    if tag is None:
&lt;SMALL&gt;106  &lt;/SMALL&gt;      break
&lt;SMALL&gt;107  &lt;/SMALL&gt;    end_tag = END_BLOCK_OPEN + tag + BLOCK_CLOSE
&lt;SMALL&gt;108  &lt;/SMALL&gt;    before_end = rest.find(end_tag, after_tag)
&lt;SMALL&gt;109  &lt;/SMALL&gt;    if before_end &amp;lt; 0:
&lt;SMALL&gt;110  &lt;/SMALL&gt;      break
&lt;SMALL&gt;111  &lt;/SMALL&gt;    after_end = before_end + len(end_tag)
&lt;SMALL&gt;112  &lt;/SMALL&gt;
&lt;SMALL&gt;113  &lt;/SMALL&gt;    result.append(rest[:before_tag])
&lt;SMALL&gt;114  &lt;/SMALL&gt;    block = rest[after_tag:before_end]
&lt;SMALL&gt;115  &lt;/SMALL&gt;    result.append(_ExpandBlock(tag, block, specials, params, name))
&lt;SMALL&gt;116  &lt;/SMALL&gt;    rest = rest[after_end:]
&lt;SMALL&gt;117  &lt;/SMALL&gt;  return &#39;&#39;.join(result) + rest
&lt;SMALL&gt;118  &lt;/SMALL&gt;
&lt;SMALL&gt;119  &lt;/SMALL&gt;
&lt;SMALL&gt;120  &lt;/SMALL&gt;VAR_OPEN = &#39;{{&#39;
&lt;SMALL&gt;121  &lt;/SMALL&gt;VAR_CLOSE = &#39;}}&#39;
&lt;SMALL&gt;122  &lt;/SMALL&gt;
&lt;SMALL&gt;123  &lt;/SMALL&gt;
&lt;SMALL&gt;124  &lt;/SMALL&gt;def _ExpandVariables(template, specials, params, name):
&lt;SMALL&gt;125  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands all the variables in a template.&quot;&quot;&quot;
&lt;SMALL&gt;126  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;127  &lt;/SMALL&gt;  rest = template
&lt;SMALL&gt;128  &lt;/SMALL&gt;  while rest:
&lt;SMALL&gt;129  &lt;/SMALL&gt;    tag, before_tag, after_tag = _FindTag(rest, VAR_OPEN, VAR_CLOSE)
&lt;SMALL&gt;130  &lt;/SMALL&gt;    if tag is None:
&lt;SMALL&gt;131  &lt;/SMALL&gt;      break
&lt;SMALL&gt;132  &lt;/SMALL&gt;    result.append(rest[:before_tag])
&lt;SMALL&gt;133  &lt;/SMALL&gt;    result.append(str(_ExpandVariable(tag, specials, params, name)))
&lt;SMALL&gt;134  &lt;/SMALL&gt;    rest = rest[after_tag:]
&lt;SMALL&gt;135  &lt;/SMALL&gt;  return &#39;&#39;.join(result) + rest
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;SMALL&gt;137  &lt;/SMALL&gt;
&lt;SMALL&gt;138  &lt;/SMALL&gt;FOR_TAG = &#39;for&#39;
&lt;SMALL&gt;139  &lt;/SMALL&gt;IF_TAG = &#39;if&#39;
&lt;SMALL&gt;140  &lt;/SMALL&gt;INCLUDE_TAG = &#39;include&#39;
&lt;SMALL&gt;141  &lt;/SMALL&gt;
&lt;SMALL&gt;142  &lt;/SMALL&gt;
&lt;SMALL&gt;143  &lt;/SMALL&gt;def _ExpandBlock(tag, template, specials, params, name):
&lt;SMALL&gt;144  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a single template block.&quot;&quot;&quot;
&lt;SMALL&gt;145  &lt;/SMALL&gt;
&lt;SMALL&gt;146  &lt;/SMALL&gt;  tag_type, block_var = tag.split(&#39;:&#39;, 1)
&lt;SMALL&gt;147  &lt;/SMALL&gt;  if tag_type == INCLUDE_TAG:
&lt;SMALL&gt;148  &lt;/SMALL&gt;    return _ExpandInclude(tag, block_var, template, specials, params, name)
&lt;SMALL&gt;149  &lt;/SMALL&gt;  elif tag_type == IF_TAG:
&lt;SMALL&gt;150  &lt;/SMALL&gt;    block_data = _ExpandVariable(block_var, specials, params, name)
&lt;SMALL&gt;151  &lt;/SMALL&gt;    if block_data:
&lt;SMALL&gt;152  &lt;/SMALL&gt;      return ExpandTemplate(template, specials, params, name)
&lt;SMALL&gt;153  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;154  &lt;/SMALL&gt;  elif tag_type == FOR_TAG:
&lt;SMALL&gt;155  &lt;/SMALL&gt;    block_data = _ExpandVariable(block_var, specials, params, name)
&lt;SMALL&gt;156  &lt;/SMALL&gt;    return _ExpandFor(tag, template, specials, block_data)
&lt;SMALL&gt;157  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;158  &lt;/SMALL&gt;    _Log(&#39;Error: Invalid block: %s&#39; % (tag,))
&lt;SMALL&gt;159  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;160  &lt;/SMALL&gt;
&lt;SMALL&gt;161  &lt;/SMALL&gt;
&lt;SMALL&gt;162  &lt;/SMALL&gt;def _ExpandInclude(_, filename, template, specials, params, name):
&lt;SMALL&gt;163  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands an include block (or insert the template on an error).&quot;&quot;&quot;
&lt;SMALL&gt;164  &lt;/SMALL&gt;  result = &#39;&#39;
&lt;SMALL&gt;165  &lt;/SMALL&gt;  # replace /s with local file system equivalent
&lt;SMALL&gt;166  &lt;/SMALL&gt;  fname = os.sep + filename.replace(&#39;/&#39;, os.sep)
&lt;SMALL&gt;167  &lt;/SMALL&gt;  f = None
&lt;SMALL&gt;168  &lt;/SMALL&gt;  try:
&lt;SMALL&gt;169  &lt;/SMALL&gt;    try:
&lt;SMALL&gt;170  &lt;/SMALL&gt;      f = gruyere._Open(gruyere.RESOURCE_PATH, fname)
&lt;SMALL&gt;171  &lt;/SMALL&gt;      result = f.read()
&lt;SMALL&gt;172  &lt;/SMALL&gt;    except IOError:
&lt;SMALL&gt;173  &lt;/SMALL&gt;      _Log(&#39;Error: missing filename: %s&#39; % (filename,))
&lt;SMALL&gt;174  &lt;/SMALL&gt;      result = template
&lt;SMALL&gt;175  &lt;/SMALL&gt;  finally:
&lt;SMALL&gt;176  &lt;/SMALL&gt;    if f: f.close()
&lt;SMALL&gt;177  &lt;/SMALL&gt;  return ExpandTemplate(result, specials, params, name)
&lt;SMALL&gt;178  &lt;/SMALL&gt;
&lt;SMALL&gt;179  &lt;/SMALL&gt;
&lt;SMALL&gt;180  &lt;/SMALL&gt;def _ExpandFor(tag, template, specials, block_data):
&lt;SMALL&gt;181  &lt;/SMALL&gt;  &quot;&quot;&quot;Expands a for block iterating over the block_data.&quot;&quot;&quot;
&lt;SMALL&gt;182  &lt;/SMALL&gt;  result = []
&lt;SMALL&gt;183  &lt;/SMALL&gt;  if operator.isMappingType(block_data):
&lt;SMALL&gt;184  &lt;/SMALL&gt;    for v in block_data:
&lt;SMALL&gt;185  &lt;/SMALL&gt;      result.append(ExpandTemplate(template, specials, block_data[v], v))
&lt;SMALL&gt;186  &lt;/SMALL&gt;  elif operator.isSequenceType(block_data):
&lt;SMALL&gt;187  &lt;/SMALL&gt;    for i in xrange(len(block_data)):
&lt;SMALL&gt;188  &lt;/SMALL&gt;      result.append(ExpandTemplate(template, specials, block_data[i], str(i)))
&lt;SMALL&gt;189  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;190  &lt;/SMALL&gt;    _Log(&#39;Error: Invalid type: %s&#39; % (tag,))
&lt;SMALL&gt;191  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;192  &lt;/SMALL&gt;  return &#39;&#39;.join(result)
&lt;SMALL&gt;193  &lt;/SMALL&gt;
&lt;SMALL&gt;194  &lt;/SMALL&gt;
&lt;SMALL&gt;195  &lt;/SMALL&gt;def _ExpandVariable(var, specials, params, name, default=&#39;&#39;):
&lt;SMALL&gt;196  &lt;/SMALL&gt;  &quot;&quot;&quot;Gets a variable value.&quot;&quot;&quot;
&lt;SMALL&gt;197  &lt;/SMALL&gt;  if var.startswith(&#39;#&#39;):  # this is a comment.
&lt;SMALL&gt;198  &lt;/SMALL&gt;    return &#39;&#39;
&lt;SMALL&gt;199  &lt;/SMALL&gt;
&lt;SMALL&gt;200  &lt;/SMALL&gt;  # Strip out leading ! which negates value
&lt;SMALL&gt;201  &lt;/SMALL&gt;  inverted = var.startswith(&#39;!&#39;)
&lt;SMALL&gt;202  &lt;/SMALL&gt;  if inverted:
&lt;SMALL&gt;203  &lt;/SMALL&gt;    var = var[1:]
&lt;SMALL&gt;204  &lt;/SMALL&gt;
&lt;SMALL&gt;205  &lt;/SMALL&gt;  # Strip out trailing :&amp;lt;escaper&amp;gt;
&lt;SMALL&gt;206  &lt;/SMALL&gt;  escaper_name = None
&lt;SMALL&gt;207  &lt;/SMALL&gt;  if var.find(&#39;:&#39;) &amp;gt;= 0:
&lt;SMALL&gt;208  &lt;/SMALL&gt;    (var, escaper_name) = var.split(&#39;:&#39;, 1)
&lt;SMALL&gt;209  &lt;/SMALL&gt;
&lt;SMALL&gt;210  &lt;/SMALL&gt;  value = _ExpandValue(var, specials, params, name, default)
&lt;SMALL&gt;211  &lt;/SMALL&gt;  if inverted:
&lt;SMALL&gt;212  &lt;/SMALL&gt;    value = not value
&lt;SMALL&gt;213  &lt;/SMALL&gt;
&lt;SMALL&gt;214  &lt;/SMALL&gt;  if escaper_name == &#39;text&#39;:
&lt;SMALL&gt;215  &lt;/SMALL&gt;    value = cgi.escape(str(value))
&lt;SMALL&gt;216  &lt;/SMALL&gt;  elif escaper_name == &#39;html&#39;:
&lt;SMALL&gt;217  &lt;/SMALL&gt;    value = sanitize.SanitizeHtml(str(value))
&lt;SMALL&gt;218  &lt;/SMALL&gt;  elif escaper_name == &#39;pprint&#39;:  # for debugging
&lt;SMALL&gt;219  &lt;/SMALL&gt;    value = &#39;&amp;lt;pre&amp;gt;&#39; + cgi.escape(pprint.pformat(value)) + &#39;&amp;lt;/pre&amp;gt;&#39;
&lt;SMALL&gt;220  &lt;/SMALL&gt;
&lt;SMALL&gt;221  &lt;/SMALL&gt;  if value is None:
&lt;SMALL&gt;222  &lt;/SMALL&gt;    value = &#39;&#39;
&lt;SMALL&gt;223  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;224  &lt;/SMALL&gt;
&lt;SMALL&gt;225  &lt;/SMALL&gt;
&lt;SMALL&gt;226  &lt;/SMALL&gt;def _ExpandValue(var, specials, params, name, default):
&lt;SMALL&gt;227  &lt;/SMALL&gt;  &quot;&quot;&quot;Expand one value.
&lt;SMALL&gt;228  &lt;/SMALL&gt;
&lt;SMALL&gt;229  &lt;/SMALL&gt;  This expands the &amp;lt;field&amp;gt;.&amp;lt;field&amp;gt;...&amp;lt;field&amp;gt; part of the variable
&lt;SMALL&gt;230  &lt;/SMALL&gt;  expansion. A field may be of the form *&amp;lt;param&amp;gt; to use the value
&lt;SMALL&gt;231  &lt;/SMALL&gt;  of a parameter as the field name.
&lt;SMALL&gt;232  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;233  &lt;/SMALL&gt;  if var == &#39;_key&#39;:
&lt;SMALL&gt;234  &lt;/SMALL&gt;    return name
&lt;SMALL&gt;235  &lt;/SMALL&gt;  elif var == &#39;_this&#39;:
&lt;SMALL&gt;236  &lt;/SMALL&gt;    return params
&lt;SMALL&gt;237  &lt;/SMALL&gt;  if var.startswith(&#39;_&#39;):
&lt;SMALL&gt;238  &lt;/SMALL&gt;    value = specials
&lt;SMALL&gt;239  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;240  &lt;/SMALL&gt;    value = params
&lt;SMALL&gt;241  &lt;/SMALL&gt;
&lt;SMALL&gt;242  &lt;/SMALL&gt;  for v in var.split(&#39;.&#39;):
&lt;SMALL&gt;243  &lt;/SMALL&gt;    if v == &#39;*_this&#39;:
&lt;SMALL&gt;244  &lt;/SMALL&gt;      v = params
&lt;SMALL&gt;245  &lt;/SMALL&gt;    if v.startswith(&#39;*&#39;):
&lt;SMALL&gt;246  &lt;/SMALL&gt;      v = _GetValue(specials[&#39;_params&#39;], v[1:])
&lt;SMALL&gt;247  &lt;/SMALL&gt;      if operator.isSequenceType(v):
&lt;SMALL&gt;248  &lt;/SMALL&gt;        v = v[0]  # reduce repeated url param to single value
&lt;SMALL&gt;249  &lt;/SMALL&gt;    value = _GetValue(value, str(v), default)
&lt;SMALL&gt;250  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;251  &lt;/SMALL&gt;
&lt;SMALL&gt;252  &lt;/SMALL&gt;
&lt;SMALL&gt;253  &lt;/SMALL&gt;def _GetValue(collection, index, default=&#39;&#39;):
&lt;SMALL&gt;254  &lt;/SMALL&gt;  &quot;&quot;&quot;Gets a single indexed value out of a collection.
&lt;SMALL&gt;255  &lt;/SMALL&gt;
&lt;SMALL&gt;256  &lt;/SMALL&gt;  The index is either a key in a mapping or a numeric index into
&lt;SMALL&gt;257  &lt;/SMALL&gt;  a sequence.
&lt;SMALL&gt;258  &lt;/SMALL&gt;
&lt;SMALL&gt;259  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;260  &lt;/SMALL&gt;    value
&lt;SMALL&gt;261  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;262  &lt;/SMALL&gt;  if operator.isMappingType(collection) and index in collection:
&lt;SMALL&gt;263  &lt;/SMALL&gt;    value = collection[index]
&lt;SMALL&gt;264  &lt;/SMALL&gt;  elif (operator.isSequenceType(collection) and index.isdigit() and
&lt;SMALL&gt;265  &lt;/SMALL&gt;        int(index) &amp;lt; len(collection)):
&lt;SMALL&gt;266  &lt;/SMALL&gt;    value = collection[int(index)]
&lt;SMALL&gt;267  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;268  &lt;/SMALL&gt;    value = default
&lt;SMALL&gt;269  &lt;/SMALL&gt;  return value
&lt;SMALL&gt;270  &lt;/SMALL&gt;
&lt;SMALL&gt;271  &lt;/SMALL&gt;
&lt;SMALL&gt;272  &lt;/SMALL&gt;def _Cond(test, if_true, if_false):
&lt;SMALL&gt;273  &lt;/SMALL&gt;  &quot;&quot;&quot;Substitute for &#39;if_true if test else if_false&#39; in Python 2.4.&quot;&quot;&quot;
&lt;SMALL&gt;274  &lt;/SMALL&gt;  if test:
&lt;SMALL&gt;275  &lt;/SMALL&gt;    return if_true
&lt;SMALL&gt;276  &lt;/SMALL&gt;  else:
&lt;SMALL&gt;277  &lt;/SMALL&gt;    return if_false
&lt;SMALL&gt;278  &lt;/SMALL&gt;
&lt;SMALL&gt;279  &lt;/SMALL&gt;
&lt;SMALL&gt;280  &lt;/SMALL&gt;def _FindTag(template, open_marker, close_marker):
&lt;SMALL&gt;281  &lt;/SMALL&gt;  &quot;&quot;&quot;Finds a single tag.
&lt;SMALL&gt;282  &lt;/SMALL&gt;
&lt;SMALL&gt;283  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt;284  &lt;/SMALL&gt;    template: the template to search.
&lt;SMALL&gt;285  &lt;/SMALL&gt;    open_marker: the start of the tag (e.g., &#39;{{&#39;).
&lt;SMALL&gt;286  &lt;/SMALL&gt;    close_marker: the end of the tag (e.g., &#39;}}&#39;).
&lt;SMALL&gt;287  &lt;/SMALL&gt;
&lt;SMALL&gt;288  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt;289  &lt;/SMALL&gt;    (tag, pos1, pos2) where the tag has the open and close markers
&lt;SMALL&gt;290  &lt;/SMALL&gt;    stripped off and pos1 is the start of the tag and pos2 is the end of
&lt;SMALL&gt;291  &lt;/SMALL&gt;    the tag. Returns (None, None, None) if there is no tag found.
&lt;SMALL&gt;292  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt;293  &lt;/SMALL&gt;  open_pos = template.find(open_marker)
&lt;SMALL&gt;294  &lt;/SMALL&gt;  close_pos = template.find(close_marker, open_pos)
&lt;SMALL&gt;295  &lt;/SMALL&gt;  if open_pos &amp;lt; 0 or close_pos &amp;lt; 0 or open_pos &amp;gt; close_pos:
&lt;SMALL&gt;296  &lt;/SMALL&gt;    return (None, None, None)
&lt;SMALL&gt;297  &lt;/SMALL&gt;  return (template[open_pos + len(open_marker):close_pos],
&lt;SMALL&gt;298  &lt;/SMALL&gt;          open_pos,
&lt;SMALL&gt;299  &lt;/SMALL&gt;          close_pos + len(close_marker))
&lt;SMALL&gt;300  &lt;/SMALL&gt;
&lt;SMALL&gt;301  &lt;/SMALL&gt;
&lt;SMALL&gt;302  &lt;/SMALL&gt;def _Log(message):
&lt;SMALL&gt;303  &lt;/SMALL&gt;  logging.warning(&#39;%s&#39;, message)
&lt;SMALL&gt;304  &lt;/SMALL&gt;  print &amp;gt;&amp;gt;sys.stderr, message
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/dump.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/dump.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/dump.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e4d1e30a8ceca7ff5f654c59da406ace
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1337

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1337 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/dump.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Debug Dump&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;&amp;lt;table&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_cookie:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_cookie:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_profile:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_profile:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;_db:&amp;amp;nbsp;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;    &amp;lt;td valign=&#39;top&#39;&amp;gt;{{_db:pprint}}&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/editprofile.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (386 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/editprofile.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/editprofile.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1d60ea05e529be938ae661eb148168e9
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 7482

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (7482 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/editprofile.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Profile&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;div&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;&amp;lt;h2&amp;gt;Gruyere: Profile&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt; 17  &lt;/SMALL&gt;  &amp;lt;h3&amp;gt;Add a new account or edit an existing account.&amp;lt;/h3&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt; 19  &lt;/SMALL&gt;[[if:!_cookie.is_admin]]
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;h3&amp;gt;Edit your profile.&amp;lt;/h3&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;[[/if:!_cookie.is_admin]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;[[if:_message]]
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;div class=&#39;message&#39;&amp;gt;{{_message}}&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;[[/if:_message]]
&lt;SMALL&gt; 25  &lt;/SMALL&gt;
&lt;SMALL&gt; 26  &lt;/SMALL&gt;&amp;lt;form method=&#39;get&#39; action=&#39;/{{_unique_id}}/saveprofile&#39;&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;&amp;lt;input type=&#39;hidden&#39; name=&#39;action&#39; value=&#39;update&#39;&amp;gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;&amp;lt;table&amp;gt;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 30  &lt;/SMALL&gt;    User id:
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 32  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt; 33  &lt;/SMALL&gt;  [[if:uid]]
&lt;SMALL&gt; 34  &lt;/SMALL&gt;    &amp;lt;input type=&#39;hidden&#39; name=&#39;uid&#39; value=&#39;{{uid.0}}&#39;&amp;gt;
&lt;SMALL&gt; 35  &lt;/SMALL&gt;    {{uid.0}}
&lt;SMALL&gt; 36  &lt;/SMALL&gt;  [[/if:uid]]
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  [[if:!uid]]
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    &amp;lt;input type=&#39;hidden&#39; name=&#39;uid&#39; value=&#39;{{_cookie.uid}}&#39;&amp;gt;
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    {{_cookie.uid}}
&lt;SMALL&gt; 40  &lt;/SMALL&gt;  [[/if:!uid]]
&lt;SMALL&gt; 41  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt; 42  &lt;/SMALL&gt;[[if:!_cookie.is_admin]]
&lt;SMALL&gt; 43  &lt;/SMALL&gt;  [[if:_cookie.uid]]
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    {{_cookie.uid}}
&lt;SMALL&gt; 45  &lt;/SMALL&gt;  [[/if:_cookie.uid]]
&lt;SMALL&gt; 46  &lt;/SMALL&gt;  [[if:!_cookie.uid]]
&lt;SMALL&gt; 47  &lt;/SMALL&gt;      &amp;amp;lt;not logged in&amp;amp;gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;  [[/if:!_cookie.uid]]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;[[/if:!_cookie.is_admin]]
&lt;SMALL&gt; 50  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;    User name:
&lt;SMALL&gt; 53  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.name:text}}[[/if:uid]][[if:!uid]]{{_profile.name:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;      name=&#39;name&#39; maxlength=&#39;16&#39;&amp;gt;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 58  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;    OLD Password:
&lt;SMALL&gt; 60  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 61  &lt;/SMALL&gt;    &amp;lt;input type=&#39;password&#39; name=&#39;oldpw&#39;&amp;gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 64  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 65  &lt;/SMALL&gt;    NEW Password:
&lt;SMALL&gt; 66  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 67  &lt;/SMALL&gt;    &amp;lt;input type=&#39;password&#39; name=&#39;pw&#39;&amp;gt;
&lt;SMALL&gt; 68  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;&amp;lt;span style=&quot;color:red&quot;&amp;gt;&amp;lt;b&amp;gt;WARNING: Gruyere is not secure.&amp;lt;br&amp;gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;    Do not use a password that you use for any real service.&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 70  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 71  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;    Icon:
&lt;SMALL&gt; 73  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 74  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.icon:text}}[[/if:uid]][[if:!uid]]{{_profile.icon:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 76  &lt;/SMALL&gt;      value=&#39;{{_profile.icon:text}}&#39;
&lt;SMALL&gt; 77  &lt;/SMALL&gt;      name=&#39;icon&#39;&amp;gt;
&lt;SMALL&gt; 78  &lt;/SMALL&gt;    (32x32 image, URL to image location)
&lt;SMALL&gt; 79  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 80  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 81  &lt;/SMALL&gt;    Homepage:
&lt;SMALL&gt; 82  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 83  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39; size=&#39;50&#39;
&lt;SMALL&gt; 84  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.web_site:text}}[[/if:uid]][[if:!uid]]{{_profile.web_site:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;      name=&#39;web_site&#39;&amp;gt;
&lt;SMALL&gt; 86  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 88  &lt;/SMALL&gt;    Profile Color:
&lt;SMALL&gt; 89  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 90  &lt;/SMALL&gt;    &amp;lt;input type=&#39;text&#39;
&lt;SMALL&gt; 91  &lt;/SMALL&gt;      value=&#39;[[if:uid]]{{_db.*uid.color:text}}[[/if:uid]][[if:!uid]]{{_profile.color:text}}[[/if:!uid]]&#39;
&lt;SMALL&gt; 92  &lt;/SMALL&gt;      name=&#39;color&#39;&amp;gt;
&lt;SMALL&gt; 93  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 94  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 95  &lt;/SMALL&gt;    Private Snippet:
&lt;SMALL&gt; 96  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;    &amp;lt;textarea name=&#39;private_snippet&#39; rows=&#39;10&#39; style=&#39;width:100%&#39;&amp;gt;[[if:uid]]{{_db.*uid.private_snippet}}[[/if:uid]][[if:!uid]]{{_profile.private_snippet}}[[/if:!uid]]&amp;lt;/textarea&amp;gt;
&lt;SMALL&gt; 98  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 99  &lt;/SMALL&gt;[[if:_cookie.is_admin]]
&lt;SMALL&gt;100  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;101  &lt;/SMALL&gt;    Is admin:
&lt;SMALL&gt;102  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;103  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;104  &lt;/SMALL&gt;      [[if:uid]][[if:_db.*uid.is_admin]]checked[[/if:_db.*uid.is_admin]][[/if:uid]]
&lt;SMALL&gt;105  &lt;/SMALL&gt;      [[if:!uid]][[if:_profile.is_admin]]checked[[/if:_profile.is_admin]][[/if:!uid]]
&lt;SMALL&gt;106  &lt;/SMALL&gt;      name=&#39;is_admin&#39; value=&#39;True&#39;&amp;gt;Yes
&lt;SMALL&gt;107  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;108  &lt;/SMALL&gt;      [[if:uid]][[if:!_db.*uid.is_admin]]checked[[/if:!_db.*uid.is_admin]][[/if:uid]]
&lt;SMALL&gt;109  &lt;/SMALL&gt;      [[if:!uid]][[if:!_profile.is_admin]]checked[[/if:!_profile.is_admin]][[/if:!uid]]
&lt;SMALL&gt;110  &lt;/SMALL&gt;      name=&#39;is_admin&#39; value=&#39;False&#39;&amp;gt;No
&lt;SMALL&gt;111  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;112  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;113  &lt;/SMALL&gt;    Is author:
&lt;SMALL&gt;114  &lt;/SMALL&gt;  &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;
&lt;SMALL&gt;115  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;116  &lt;/SMALL&gt;      [[if:uid]][[if:_db.*uid.is_author]]checked[[/if:_db.*uid.is_author]][[/if:uid]]
&lt;SMALL&gt;117  &lt;/SMALL&gt;      [[if:!uid]][[if:_profile.is_author]]checked[[/if:_profile.is_author]][[/if:!uid]]
&lt;SMALL&gt;118  &lt;/SMALL&gt;      name=&#39;is_author&#39; value=&#39;True&#39;&amp;gt;Yes
&lt;SMALL&gt;119  &lt;/SMALL&gt;    &amp;lt;input type=&#39;radio&#39;
&lt;SMALL&gt;120  &lt;/SMALL&gt;      [[if:uid]][[if:!_db.*uid.is_author]]checked[[/if:!_db.*uid.is_author]][[/if:uid]]
&lt;SMALL&gt;121  &lt;/SMALL&gt;      [[if:!uid]][[if:!_profile.is_author]]checked[[/if:!_profile.is_author]][[/if:!uid]]
&lt;SMALL&gt;122  &lt;/SMALL&gt;      name=&#39;is_author&#39; value=&#39;False&#39;&amp;gt;No
&lt;SMALL&gt;123  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;124  &lt;/SMALL&gt;[[/if:_cookie.is_admin]]
&lt;SMALL&gt;125  &lt;/SMALL&gt;
&lt;SMALL&gt;126  &lt;/SMALL&gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td align=&#39;left&#39;&amp;gt;
&lt;SMALL&gt;127  &lt;/SMALL&gt;    &amp;lt;input type=&#39;submit&#39; value=&#39;Update&#39;&amp;gt;
&lt;SMALL&gt;128  &lt;/SMALL&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt;129  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt;130  &lt;/SMALL&gt;&amp;lt;/form&amp;gt;
&lt;SMALL&gt;131  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt;132  &lt;/SMALL&gt;
&lt;SMALL&gt;133  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt;134  &lt;/SMALL&gt;
&lt;SMALL&gt;135  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;SMALL&gt;136  &lt;/SMALL&gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/error.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (374 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/error.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/error.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 5370f567b6b301a17108b2fc16b0be71
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 975

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (975 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/error.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Error&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;[[if:_message]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div class=&#39;message&#39;&amp;gt;{{_message}}&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;[[/if:_message]]
&lt;SMALL&gt; 15  &lt;/SMALL&gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/feed.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/feed.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/feed.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 9c8677b65512748760eacd4a5970f9b2
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 1769

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1769 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/feed.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;{{# Copyright 2017 Google Inc. }}
&lt;SMALL&gt;  2  &lt;/SMALL&gt;_feed((
&lt;SMALL&gt;  3  &lt;/SMALL&gt;{{# with a uid parameter, get one user&#39;s snippets
&lt;SMALL&gt;  4  &lt;/SMALL&gt;    returns [name, snippet, ...]
&lt;SMALL&gt;  5  &lt;/SMALL&gt;The first entry is the user&#39;s name and the remaining entries are
&lt;SMALL&gt;  6  &lt;/SMALL&gt;the user&#39;s snippets, in order from most recent to least recent.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;}}
&lt;SMALL&gt;  8  &lt;/SMALL&gt;[[if:uid]]
&lt;SMALL&gt;  9  &lt;/SMALL&gt;[
&lt;SMALL&gt; 10  &lt;/SMALL&gt;&quot;[[if:_db.*uid]]{{_db.*uid.name}}[[/if:_db.*uid]][[if:!_db.*uid]]{{uid.0}}[[/if:!_db.*uid]]&quot;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;[[if:_db.*uid.snippets.0]][[for:_db.*uid.snippets]]
&lt;SMALL&gt; 12  &lt;/SMALL&gt;,&quot;{{_this:html}}&quot;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;[[/for:_db.*uid.snippets]][[/if:_db.*uid.snippets.0]]
&lt;SMALL&gt; 14  &lt;/SMALL&gt;]
&lt;SMALL&gt; 15  &lt;/SMALL&gt;[[/if:uid]]
&lt;SMALL&gt; 16  &lt;/SMALL&gt;{{# without a uid parameter, get one snippet from each user 
&lt;SMALL&gt; 17  &lt;/SMALL&gt;    returns {&#39;private_snippet&#39;:snippet, user:snippet, ...}
&lt;SMALL&gt; 18  &lt;/SMALL&gt;The first entry is the logged in user&#39;s private snippet.
&lt;SMALL&gt; 19  &lt;/SMALL&gt;The rest of the entries are all the other users&#39; most recent snippet.
&lt;SMALL&gt; 20  &lt;/SMALL&gt;}}
&lt;SMALL&gt; 21  &lt;/SMALL&gt;[[if:!uid]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;{
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&quot;private_snippet&quot;:
&lt;SMALL&gt; 24  &lt;/SMALL&gt;  &quot;{{_profile.private_snippet:html}}&quot;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;[[for:_db]]
&lt;SMALL&gt; 26  &lt;/SMALL&gt;[[if:is_author]][[if:snippets.0]],&quot;{{_key}}&quot;:
&lt;SMALL&gt; 27  &lt;/SMALL&gt;  &quot;{{snippets.0:html}}&quot;[[/if:snippets.0]][[/if:is_author]][[/for:_db]]
&lt;SMALL&gt; 28  &lt;/SMALL&gt;}
&lt;SMALL&gt; 29  &lt;/SMALL&gt;[[/if:!uid]]
&lt;SMALL&gt; 30  &lt;/SMALL&gt;))
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/home.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (372 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/home.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/home.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 454e99f94e863b5a127a5f88a6bccf29
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 3533

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3533 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/home.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Home&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;script src=&quot;/{{_unique_id}}/lib.js&quot; text=&quot;text/javascript&quot;&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;&amp;lt;/script&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;&amp;lt;h2 class=&#39;has-refresh&#39;&amp;gt;Gruyere: Home&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;div class=&#39;refresh&#39;&amp;gt;&amp;lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;{{_unique_id}}&quot;)&#39; href=&#39;#&#39;&amp;gt;Refresh&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;table width=&#39;100%&#39;&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;[[if:_profile.private_snippet]]
&lt;SMALL&gt; 20  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;      Private&amp;amp;nbsp;snippet&amp;amp;nbsp;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 26  &lt;/SMALL&gt;      &amp;lt;a class=&#39;button&#39; id=&#39;show&#39; onclick=&#39;_showHide(&quot;show&quot;, &quot;hide&quot;)&#39; href=&#39;#&#39;&amp;gt;Show &amp;amp;#9658;&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;      &amp;lt;span id=&#39;hide&#39; style=&#39;display: none;&#39;&amp;gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;      &amp;lt;a class=&#39;button&#39; onclick=&#39;_showHide(&quot;show&quot;, &quot;hide&quot;)&#39; href=&#39;#&#39;&amp;gt;Hide &amp;amp;#9668;&amp;lt;/a&amp;gt; &amp;amp;nbsp;
&lt;SMALL&gt; 29  &lt;/SMALL&gt;      &amp;lt;span id=&#39;private_snippet&#39;&amp;gt;{{_profile.private_snippet:html}}&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 30  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 32  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td colspan=&#39;3&#39;&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 33  &lt;/SMALL&gt;[[/if:_profile.private_snippet]]
&lt;SMALL&gt; 34  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;&amp;lt;td colspan=&#39;3&#39;&amp;gt;&amp;lt;b&amp;gt;Most recent snippets:&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 35  &lt;/SMALL&gt;[[for:_db]]
&lt;SMALL&gt; 36  &lt;/SMALL&gt;[[if:is_author]][[if:snippets.0]]
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  &amp;lt;tr&amp;gt;
&lt;SMALL&gt; 38  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 39  &lt;/SMALL&gt;     [[if:icon]]&amp;lt;img alt=&#39;&#39; height=&#39;32&#39; width=&#39;32&#39; src=&#39;{{icon:text}}&#39;&amp;gt;[[/if:icon]]
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 41  &lt;/SMALL&gt;    &amp;lt;td&amp;gt;
&lt;SMALL&gt; 42  &lt;/SMALL&gt;      &amp;lt;b&amp;gt;&amp;lt;span style=&#39;color:{{color:text}}&#39;&amp;gt;[[if:name]]{{name:text}}[[/if:name]][[if:!name]]{{_key}}[[/if:!name]]&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;
&lt;SMALL&gt; 43  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 44  &lt;/SMALL&gt;    &amp;lt;td width=&#39;100%&#39;&amp;gt;&amp;lt;span id=&#39;{{_key}}&#39;&amp;gt;{{snippets.0:html}}&amp;lt;/span&amp;gt;
&lt;SMALL&gt; 45  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 46  &lt;/SMALL&gt;          &amp;lt;a href=&#39;/{{_unique_id}}/snippets.gtl?uid={{_key}}&#39;&amp;gt;All snippets&amp;lt;/a&amp;gt;&amp;amp;nbsp;
&lt;SMALL&gt; 47  &lt;/SMALL&gt;      &amp;lt;a href=&#39;{{web_site:text}}&#39;&amp;gt;Homepage&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 48  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 49  &lt;/SMALL&gt;    &amp;lt;br&amp;gt;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;    &amp;lt;/td&amp;gt;
&lt;SMALL&gt; 51  &lt;/SMALL&gt;  &amp;lt;/tr&amp;gt;
&lt;SMALL&gt; 52  &lt;/SMALL&gt;[[/if:snippets.0]][[/if:is_author]]
&lt;SMALL&gt; 53  &lt;/SMALL&gt;[[/for:_db]]
&lt;SMALL&gt; 54  &lt;/SMALL&gt;&amp;lt;/table&amp;gt;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 56  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 57  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/manage.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (376 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/manage.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/manage.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 75d92dd608c87fa22869f17184f9e78b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1499

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1499 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/manage.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&amp;gt;
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;!-- Copyright 2017 Google Inc. --&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;&amp;lt;html&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;&amp;lt;head&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;&amp;lt;title&amp;gt;Gruyere: Profile&amp;lt;/title&amp;gt;
&lt;SMALL&gt;  6  &lt;/SMALL&gt;[[include:base.css]][[/include:base.css]]
&lt;SMALL&gt;  7  &lt;/SMALL&gt;&amp;lt;/head&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;&amp;lt;body&amp;gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;[[include:menubar.gtl]][[/include:menubar.gtl]]
&lt;SMALL&gt; 11  &lt;/SMALL&gt;&amp;lt;h2&amp;gt;Gruyere: Manage the server&amp;lt;/h2&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;
&lt;SMALL&gt; 13  &lt;/SMALL&gt;&amp;lt;div class=&#39;content&#39;&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;&amp;lt;form method=&#39;get&#39; action=&#39;/{{_unique_id}}/editprofile.gtl&#39;&amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;&amp;lt;p&amp;gt;Edit a user&#39;s profile:
&lt;SMALL&gt; 16  &lt;/SMALL&gt;&amp;lt;input type=&#39;text&#39; name=&#39;uid&#39;&amp;gt;
&lt;SMALL&gt; 17  &lt;/SMALL&gt;    &amp;lt;input type=&#39;submit&#39; value=&#39;Edit&#39;&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;&amp;lt;/form&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;&amp;lt;p&amp;gt;&amp;lt;a href=&#39;/{{_unique_id}}/reset&#39;&amp;gt;Reset the server&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;&amp;lt;p&amp;gt;&amp;lt;a href=&#39;/{{_unique_id}}/quitserver&#39;&amp;gt;Quit the server&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
&lt;SMALL&gt; 22  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;SMALL&gt; 23  &lt;/SMALL&gt;&amp;lt;/body&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;&amp;lt;/html&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/resources/menubar.gtl</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (378 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/resources/menubar.gtl HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?resources/menubar.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 03aeee793d5591ca311e44ce0fc71d52
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 1889

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1889 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;resources/menubar.gtl&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;{{# Copyright 2017 Google Inc. }}
&lt;SMALL&gt;  2  &lt;/SMALL&gt;&amp;lt;div class=&#39;menu&#39;&amp;gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;  &amp;lt;span id=&#39;menu-left&#39;&amp;gt;
&lt;SMALL&gt;  4  &lt;/SMALL&gt;    &amp;lt;a href=&#39;/{{_unique_id}}/&#39;&amp;gt;Home&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;      [[if:_cookie.uid]]
&lt;SMALL&gt;  6  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/snippets.gtl&#39;&amp;gt;My&amp;amp;nbsp;Snippets&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  7  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/newsnippet.gtl&#39;&amp;gt;New&amp;amp;nbsp;Snippet&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/upload.gtl&#39;&amp;gt;Upload&amp;lt;/a&amp;gt;
&lt;SMALL&gt;  9  &lt;/SMALL&gt;      [[/if:_cookie.uid]]
&lt;SMALL&gt; 10  &lt;/SMALL&gt;  &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 11  &lt;/SMALL&gt;  &amp;lt;span id=&#39;menu-right&#39;&amp;gt;
&lt;SMALL&gt; 12  &lt;/SMALL&gt;      [[if:_cookie.uid]]
&lt;SMALL&gt; 13  &lt;/SMALL&gt;      &amp;lt;span class=&#39;menu-user&#39;&amp;gt;
&lt;SMALL&gt; 14  &lt;/SMALL&gt;        {{_profile.name:text}} &amp;amp;lt;{{_cookie.uid}}&amp;amp;gt;
&lt;SMALL&gt; 15  &lt;/SMALL&gt;      &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 16  &lt;/SMALL&gt;      [[if:_cookie.is_admin]]
&lt;SMALL&gt; 17  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/manage.gtl&#39;&amp;gt;Manage this server&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;      [[/if:_cookie.is_admin]]
&lt;SMALL&gt; 19  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/editprofile.gtl&#39;&amp;gt;Profile&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/logout&#39;&amp;gt;Sign out&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;      [[/if:_cookie.uid]]
&lt;SMALL&gt; 22  &lt;/SMALL&gt;      [[if:!_cookie.uid]]
&lt;SMALL&gt; 23  &lt;/SMALL&gt;      &amp;lt;a href=&#39;/{{_unique_id}}/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;      | &amp;lt;a href=&#39;/{{_unique_id}}/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;      [[/if:!_cookie.uid]]
&lt;SMALL&gt; 26  &lt;/SMALL&gt;  &amp;lt;/span&amp;gt;
&lt;SMALL&gt; 27  &lt;/SMALL&gt;&amp;lt;/div&amp;gt;
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/code/sanitize.py</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (358 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/code/sanitize.py HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/?sanitize.py
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (243 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 9dd5b1c65862d4f29f531d8a7622300e
Date: Sun, 15 May 2022 13:20:02 GMT
Server: Google Frontend
Content-Length: 4996

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (4996 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
    &lt;STYLE&gt;
    SMALL { color: #AAAAFF; font-size: 75% }
    BIG { color: #3333FF; font-size: 150%; font-weight: bold}
    &lt;/STYLE&gt;&lt;BODY&gt;&lt;PRE&gt;
&lt;BIG&gt;sanitize.py&lt;/BIG&gt;
&lt;SMALL&gt;  1  &lt;/SMALL&gt;&quot;&quot;&quot;HTML sanitizer for Gruyere, a web application with holes.
&lt;SMALL&gt;  2  &lt;/SMALL&gt;
&lt;SMALL&gt;  3  &lt;/SMALL&gt;Copyright 2017 Google Inc. All rights reserved.
&lt;SMALL&gt;  4  &lt;/SMALL&gt;
&lt;SMALL&gt;  5  &lt;/SMALL&gt;This code is licensed under the https://creativecommons.org/licenses/by-nd/3.0/us/
&lt;SMALL&gt;  6  &lt;/SMALL&gt;Creative Commons Attribution-No Derivative Works 3.0 United States license.
&lt;SMALL&gt;  7  &lt;/SMALL&gt;
&lt;SMALL&gt;  8  &lt;/SMALL&gt;DO NOT COPY THIS CODE!
&lt;SMALL&gt;  9  &lt;/SMALL&gt;
&lt;SMALL&gt; 10  &lt;/SMALL&gt;This application is a small self-contained web application with numerous
&lt;SMALL&gt; 11  &lt;/SMALL&gt;security holes. It is provided for use with the Web Application Exploits and
&lt;SMALL&gt; 12  &lt;/SMALL&gt;Defenses codelab. You may modify the code for your own use while doing the
&lt;SMALL&gt; 13  &lt;/SMALL&gt;codelab but you may not distribute the modified code. Brief excerpts of this
&lt;SMALL&gt; 14  &lt;/SMALL&gt;code may be used for educational or instructional purposes provided this
&lt;SMALL&gt; 15  &lt;/SMALL&gt;notice is kept intact. By using Gruyere you agree to the Terms of Service
&lt;SMALL&gt; 16  &lt;/SMALL&gt;https://www.google.com/intl/en/policies/terms/
&lt;SMALL&gt; 17  &lt;/SMALL&gt;&quot;&quot;&quot;
&lt;SMALL&gt; 18  &lt;/SMALL&gt;
&lt;SMALL&gt; 19  &lt;/SMALL&gt;__author__ = &#39;Bruce Leban&#39;
&lt;SMALL&gt; 20  &lt;/SMALL&gt;
&lt;SMALL&gt; 21  &lt;/SMALL&gt;# system modules
&lt;SMALL&gt; 22  &lt;/SMALL&gt;import re
&lt;SMALL&gt; 23  &lt;/SMALL&gt;
&lt;SMALL&gt; 24  &lt;/SMALL&gt;
&lt;SMALL&gt; 25  &lt;/SMALL&gt;def SanitizeHtml(s):
&lt;SMALL&gt; 26  &lt;/SMALL&gt;  &quot;&quot;&quot;Makes html safe for embedding in a document.
&lt;SMALL&gt; 27  &lt;/SMALL&gt;
&lt;SMALL&gt; 28  &lt;/SMALL&gt;  Filters the html to exclude all but a small subset of html by
&lt;SMALL&gt; 29  &lt;/SMALL&gt;  removing script tags/attributes.
&lt;SMALL&gt; 30  &lt;/SMALL&gt;
&lt;SMALL&gt; 31  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 32  &lt;/SMALL&gt;    s: some html to sanitize.
&lt;SMALL&gt; 33  &lt;/SMALL&gt;
&lt;SMALL&gt; 34  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 35  &lt;/SMALL&gt;    The html with all unsafe html removed.
&lt;SMALL&gt; 36  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 37  &lt;/SMALL&gt;  processed = &#39;&#39;
&lt;SMALL&gt; 38  &lt;/SMALL&gt;  while s:
&lt;SMALL&gt; 39  &lt;/SMALL&gt;    start = s.find(&#39;&amp;lt;&#39;)
&lt;SMALL&gt; 40  &lt;/SMALL&gt;    if start &amp;gt;= 0:
&lt;SMALL&gt; 41  &lt;/SMALL&gt;      end = s.find(&#39;&amp;gt;&#39;, start)
&lt;SMALL&gt; 42  &lt;/SMALL&gt;      if end &amp;gt;= 0:
&lt;SMALL&gt; 43  &lt;/SMALL&gt;        before = s[:start]
&lt;SMALL&gt; 44  &lt;/SMALL&gt;        tag = s[start:end+1]
&lt;SMALL&gt; 45  &lt;/SMALL&gt;        after = s[end+1:]
&lt;SMALL&gt; 46  &lt;/SMALL&gt;      else:
&lt;SMALL&gt; 47  &lt;/SMALL&gt;        before = s[:start]
&lt;SMALL&gt; 48  &lt;/SMALL&gt;        tag = s[start:]
&lt;SMALL&gt; 49  &lt;/SMALL&gt;        after = &#39;&#39;
&lt;SMALL&gt; 50  &lt;/SMALL&gt;    else:
&lt;SMALL&gt; 51  &lt;/SMALL&gt;      before = s
&lt;SMALL&gt; 52  &lt;/SMALL&gt;      tag = &#39;&#39;
&lt;SMALL&gt; 53  &lt;/SMALL&gt;      after = &#39;&#39;
&lt;SMALL&gt; 54  &lt;/SMALL&gt;
&lt;SMALL&gt; 55  &lt;/SMALL&gt;    processed += before + _SanitizeTag(tag)
&lt;SMALL&gt; 56  &lt;/SMALL&gt;    s = after
&lt;SMALL&gt; 57  &lt;/SMALL&gt;  return processed
&lt;SMALL&gt; 58  &lt;/SMALL&gt;
&lt;SMALL&gt; 59  &lt;/SMALL&gt;
&lt;SMALL&gt; 60  &lt;/SMALL&gt;TAG_RE = re.compile(r&#39;&amp;lt;(.*?)(\s|&amp;gt;)&#39;)  # matches the start of an html tag
&lt;SMALL&gt; 61  &lt;/SMALL&gt;
&lt;SMALL&gt; 62  &lt;/SMALL&gt;
&lt;SMALL&gt; 63  &lt;/SMALL&gt;def _SanitizeTag(t):
&lt;SMALL&gt; 64  &lt;/SMALL&gt;  &quot;&quot;&quot;Sanitizes a single html tag.
&lt;SMALL&gt; 65  &lt;/SMALL&gt;
&lt;SMALL&gt; 66  &lt;/SMALL&gt;  This does both a &#39;whitelist&#39; for
&lt;SMALL&gt; 67  &lt;/SMALL&gt;  the allowed tags and a &#39;blacklist&#39; for the disallowed attributes.
&lt;SMALL&gt; 68  &lt;/SMALL&gt;
&lt;SMALL&gt; 69  &lt;/SMALL&gt;  Args:
&lt;SMALL&gt; 70  &lt;/SMALL&gt;    t: a tag to sanitize.
&lt;SMALL&gt; 71  &lt;/SMALL&gt;
&lt;SMALL&gt; 72  &lt;/SMALL&gt;  Returns:
&lt;SMALL&gt; 73  &lt;/SMALL&gt;    a safe tag.
&lt;SMALL&gt; 74  &lt;/SMALL&gt;  &quot;&quot;&quot;
&lt;SMALL&gt; 75  &lt;/SMALL&gt;  allowed_tags = [
&lt;SMALL&gt; 76  &lt;/SMALL&gt;      &#39;a&#39;, &#39;b&#39;, &#39;big&#39;, &#39;br&#39;, &#39;center&#39;, &#39;code&#39;, &#39;em&#39;, &#39;h1&#39;, &#39;h2&#39;, &#39;h3&#39;,
&lt;SMALL&gt; 77  &lt;/SMALL&gt;      &#39;h4&#39;, &#39;h5&#39;, &#39;h6&#39;, &#39;hr&#39;, &#39;i&#39;, &#39;img&#39;, &#39;li&#39;, &#39;ol&#39;, &#39;p&#39;, &#39;s&#39;, &#39;small&#39;,
&lt;SMALL&gt; 78  &lt;/SMALL&gt;      &#39;span&#39;, &#39;strong&#39;, &#39;table&#39;, &#39;td&#39;, &#39;tr&#39;, &#39;u&#39;, &#39;ul&#39;,
&lt;SMALL&gt; 79  &lt;/SMALL&gt;  ]
&lt;SMALL&gt; 80  &lt;/SMALL&gt;  disallowed_attributes = [
&lt;SMALL&gt; 81  &lt;/SMALL&gt;      &#39;onblur&#39;, &#39;onchange&#39;, &#39;onclick&#39;, &#39;ondblclick&#39;, &#39;onfocus&#39;,
&lt;SMALL&gt; 82  &lt;/SMALL&gt;      &#39;onkeydown&#39;, &#39;onkeypress&#39;, &#39;onkeyup&#39;, &#39;onload&#39;, &#39;onmousedown&#39;,
&lt;SMALL&gt; 83  &lt;/SMALL&gt;      &#39;onmousemove&#39;, &#39;onmouseout&#39;, &#39;onmouseup&#39;, &#39;onreset&#39;,
&lt;SMALL&gt; 84  &lt;/SMALL&gt;      &#39;onselect&#39;, &#39;onsubmit&#39;, &#39;onunload&#39;
&lt;SMALL&gt; 85  &lt;/SMALL&gt;  ]
&lt;SMALL&gt; 86  &lt;/SMALL&gt;
&lt;SMALL&gt; 87  &lt;/SMALL&gt;  # Extract the tag name and make sure it&#39;s allowed.
&lt;SMALL&gt; 88  &lt;/SMALL&gt;  if t.startswith(&#39;&amp;lt;/&#39;):
&lt;SMALL&gt; 89  &lt;/SMALL&gt;    return t
&lt;SMALL&gt; 90  &lt;/SMALL&gt;  m = TAG_RE.match(t)
&lt;SMALL&gt; 91  &lt;/SMALL&gt;  if m is None:
&lt;SMALL&gt; 92  &lt;/SMALL&gt;    return t
&lt;SMALL&gt; 93  &lt;/SMALL&gt;  tag_name = m.group(1)
&lt;SMALL&gt; 94  &lt;/SMALL&gt;  if tag_name not in allowed_tags:
&lt;SMALL&gt; 95  &lt;/SMALL&gt;    t = t[:m.start(1)] + &#39;blocked&#39; + t[m.end(1):]
&lt;SMALL&gt; 96  &lt;/SMALL&gt;
&lt;SMALL&gt; 97  &lt;/SMALL&gt;  # This is a bit heavy handed but we want to be sure we don&#39;t
&lt;SMALL&gt; 98  &lt;/SMALL&gt;  # allow any to get through.
&lt;SMALL&gt; 99  &lt;/SMALL&gt;  for a in disallowed_attributes:
&lt;SMALL&gt;100  &lt;/SMALL&gt;    t = t.replace(a, &#39;blocked&#39;)
&lt;SMALL&gt;101  &lt;/SMALL&gt;  return t
&lt;/PRE&gt;&lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/gruyere-code.zip</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/gruyere-code.zip HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (292 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: a5fab03f73898e2d7c2d835710feaeb8
Server: Google Frontend
Content-Length: 35401
Date: Sun, 15 May 2022 13:19:59 GMT
Expires: Sun, 15 May 2022 13:29:59 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: application/zip
Age: 0

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (35401 bytes)</summary>
				
				<pre><code>PK   KJe!9  	    data.pyUT	 RLYRLYux    Vmo6_q&gt;Ej)Ptn]0xJ$8#$c		d=4C82^ i]9$+T,INnX^,2WD-r0-Bqz&amp;Jhs0HnPuYP 6ON;U8muas^+
V2_-F$#&gt;8BNo&gt;~	:;&gt;X-	I[	FM,tP[is [l7B&gt;v~+%T&amp;yBVlfE&quot;QZ@)rAe#Xh +hI-HIa!m}-ho
&lt;0:Wq\82l&gt;liT):3#&gt;VUiQnX(saA&lt;I21Jef38-yLI:#N2V/4:7a:;OI|2L:Hi%@2eA_sXeqCqF05/pf 	]).vo&amp;)g&amp;Ag+-J+KFt7)drb&gt;bP\vDN|oWQNQ)jKs&amp;(T9H_t!Zvz_-rlr+Bq	+;uXw5X=_9aj{F\	kaOf|VeTP5*5Mcg:kS|CHHKN&lt;vL$YQ(/)WkiYy9f($*&quot;s#vuj&amp;hxDVO 9$4K=fvY;n\Y&lt;@7&amp;$:x*PK   }J}  l  
  gruyere.pyUT	 nLYnLYux    &lt;ksF+&amp;v l(P^URrdUq$D]6X 0$ Lq JnJ&lt;zz===|h#~b\e`wEg{,`&gt;gA&#39;qqM\*K,rUwYL8;MC%	.
.xG0a30y*x4+W|*\FaaO&lt;,~V,Gj{i4[Pv,,ye&#39;9(Ldi\WePrwr6}zN&amp;(m2W&amp;Rdfi)$XZyUb xXqU$d%SEVJp9	~hG]d15H	_EI0/Y(^l	Qn`&amp;bT 0$ iV(&gt;{S|]p0( 9.&amp;J!H|S \!&lt;J  Xs8,a-E&quot;dFxNy&amp;|@ f/IL}@L@FyAJ8B%f(f36f|`()R&#39;&quot;[7\$:^YQK{EXu@|	_3? 8[oX@G&quot; n$DG#lZT|h
B P4QPLxofoO?L#Qfp_jr|9Z8RNG&gt;.wiX\of;\5\&#39;o=[.~&quot;X	Vi&quot;0#C?]N1 Zis=}~H8(Bdh!3HO*.gj-ls`&amp;PD7Abq$Wg8 e)Ko4B&gt;bST&lt;r

l4AJAW:g.l)p@ORh]	F5FOPCs-_3M&#39;g	
g
2#&lt;Tx:X~rm&amp;H{~%,3-e&quot;}z/#n4	8pd_]m50$bl]o =J-1Ne%HN&gt;z;4&quot;K-%:,9PjF$%I*gNY&amp;_ 2hYQ2lH^	 \,vPL@\*j2FjaElx;&quot;k61Cj+1^
A@M\&gt;P?]	O:]App*HAN0/R|H&amp;X!4RvUH J
b&lt;K@GA0ciMaau^C	4|`! f^DYr&gt;)L5t.Q+%E4(*`T%nj8RD@%ADXP0p # %@|CK!W $&quot; &#39;4hP&lt;CQUfkv_ U!&gt;jOFC)\2@ h:B$VS~OJSr
	)rCy0rB8p4 R8 QMu&lt;d&quot;IB!s0Rhx&gt;R?`C:u`0t^|T(\@PWkt_]\CAq_&lt;N:8(,+Ok#b(lfC&amp;,{$U8iq	-|+C]kqVtX]-zHy)d;D@vy|VA$JF}WmaO7;N9c!&quot;}$L}Za!Nzc_g2
&gt;qZWPJ#NAKB&#39;7~M/v&gt;wdxs~ZOROQx?1#l8&gt;%RpGJp:`2&quot;:	),#tjnP9; x1CN1fVr	W0zJM1S`cLU
8XB@&gt;GOm@LR6A|.%JfsC?x\vTf&lt;0l.11*u&#39;-Y V)-	Dz 7lVf1hlf\=*8,(zjF:ob=dV|f-B!,kK@i$Ci1;4qBhIzTfbk	L=FYL8EItuJJf,TsH0	8$
4B\(U()vvJa~KCfn4j&quot;.eITze B]LNh?9]_~rQ34_-.Gd
]CQx)*r&#39;sjNifH9O&quot;Z[.[D{n&lt;_a &gt;z1NiPpmdFFJ$(=Ti-K.-&#39;x%A2-\PMe!;.w!;^3HGzKX1][K.J()7Vf%C}BaC	J| &#39;`EsBnA7-xVj^|n&amp;f- (?O}A*j~Iv&quot;Q**
g!4AO)6
jg)pr/P*eUl]D)SZVID	sEf` &amp;S:Z?X6mhc&quot;hQk1DoGJ-*K-y1;MqsSUgvfS@\Y8c7A.&lt;&gt;Ecm()^1vR,xW:)XQ!L&lt;n#J##]TyV)^{$u{~ZA}J3VTieqEu%!nZPgQCxN 4*?pH+=Ud@hz&amp;/X$, 6#[ee0bV+l0M:%x&gt;ks4sWfLZ5uz TG0 Op:VXYf/&lt;bJ$$nO|ymH1RIkrtyYLxsz&lt; deE7Au3Hmt!8HQ]0hjaij&gt;^J?MR]Lj47;Us?=	Q}xE6)`ctk
w@P5m)LT[uGA}6n=FO@L+kh9:
W%]}*P5`Xg JUr@)HCy@V
2J99UKG0P.I^&gt;ZTj^X Q ;_Oj1=/*= :TSo62;3R?g&amp;U2?ubN7L&#39;/LeOKaC%_ \L*eY	2Ku3&amp;Vk.qK2&amp;N&gt;&quot;/n%;_5KSt&quot;]Hqp}P&quot;y0Rw99YbjEWi&quot;w-Zl b73?K&quot;c}?f.3^u%d,*?Jy  -| eA&amp;O0+PW
m0k_&lt;U|wWeX!8;vru~VA+2D9*bJ/
MT-}q~BJ:i
&lt;2fub42lq0O2J;X:#+(*=	ie;2PiH`1EZ+!$F&quot;Xf{!
n[\j 	j#
6`Z
fm;kG$ !\w&amp;Z!d &quot;zg^n.Qz$)&gt;HL:DYZ1NZ!uKj2klt.GW]6jzpHOfW8\WzWrq4f1^L:!Q%Hw:wv4_&#39;[,&gt;7f$*r{:
bHOzo&amp;`aoRfz}o~$W a7=7WsG+\6&gt;emye ;qc?gD^d7bCVT[Ei&#39;&#39;I:`mO~^Ok;(Ci.)h==liVe2u0Y0	L&#39;HYO+!hzVYaM#&lt;gC*_IY@pX^	_ A&gt;+yV*ruPl$.4l@ZVW2tG0&quot;&gt;9S	UT=@JCY]3P	Q7yW)ncT1)kdT(JcYoaATrw1^q&lt;kZZO6$r+o&#39;AaI&amp;
YOoL7$f^
6N|0?@&#39;1jQnBVE[8T&lt;wAB|n,zJU9.E_K(6KfJm.5p0|M61V2aJtNXMB *HC]g((YddMUq%+c|Dj	G|=;}S,] f	~pB
d_5aQ%ZUIn)U`P U+p6|.&lt;S3;SLcZ02YmE[cI9
Uc?m!8;SM-u.NwH45W$7mse5*	2f^;\#8!}&gt;[l{:	fv;@y&gt;55=~P^kj53dh{dWv&amp;	z4,-!jjJk|=.Sm?3u=-&lt;s|VJN=)=NF_[!F7,V}&#39;e,,1W+xmX?*NNF~(+cldd6uFffv,&amp;o&lt;`?~H	;w	j^eunsCq!X+kR;_UM(ui&#39;P9D~uG$ aTMEG.o^)2&lt;@`P zK*vOqj:i~fS0^h/3uZ]8V*smR`zVp8 ZV9Z%]wn$%*]e&quot;sgQyc+=:;e- Am&lt;p\Pb9_JzmuZTLZ]z%O w=FnE@N K
:YWxAA_3fkzKoxQortiNvpE8 J|{:lDWb9:K&#39;{x\$TcTuBIlCFljJeTy	}# h=}0,}+rS&quot;$ixv6}+d7&quot;O/d~N_$m8&gt;Wu&quot;;G28K=|^,Uz9i,Ih4)0hS	&#39;uFH!x-A6*5Daz3MxLv72&gt;&amp;Q \9V%MI W?a&#39;1`4i96wbDGh9MS60[kBeYF
&lt;\O=(y j `TdrM!&amp;]Qa:7m.mFu)*&#39;?v\^%D\{zI5R	OB^6SN!^GQL!
2VAGOG2b]uKG^kqenkA+!wL./ZR{EZ)	nTaY5J9 l3yTI6d,J@\ R	mZAv2!	9*WaReV&amp;nzBLU&amp;p[X iJzLACip8blH3=$Lxh4hel&lt;&gt;9Ts
&#39;[SOx8#LoQz5uTX{ryH}6bK&gt;N{2&amp;	u,a&#39;~-
Ke.z=`[V@UZ}zWEmEl?oK@vb&gt;=kq,zH7Mhh }bn\+j &gt;ii04epHC:rgE3^sT{kS2BOPQv&#39;`@lV0D_CT{Jxp nw4R0JO,X,h?PK   JD  y&quot;    gtl.pyUT	 &quot; QY&quot; QYux    Ymo_Ip QIZjp&#39;1AAxH/ }fv\RbSyye?_6[U*qE*k%&gt;lBj.dQI$$}R*OUy-_xT,
Y
~URUnWI%&lt;VSeEJU]x4J6*&lt;\y5o_8d?]*5/*,qM[A kqu}+?&amp;n?\3#k)J?EyV$*T*jXeIbl^h*7A~3C	*xV-&quot;lTC[u&#39;-s`km&quot;$[p2,ET1}(ZL@NC130WtVKA?,MYIk	f	*`)8qlIreX.K!sVk}dFE&#39;VMGlU^fDxo -bEe/Dj&amp;4 Y9&#39;Z&amp;1Ki*evOQ_bO NA/ j6CQ*JdZqx5grN&lt;/z&#39;nB$qV.+08fZJ&quot;GADCdAtZ W#HzRbFwU5!]Iv S61 yGwBcAdbDs:0&#39;WK &quot;,d/(eT2&#39;VYu)$C4X	H10$,c C~%k&#39;tKN&#39;
FVe,v5:-jV^h,/!E*y9^As&#39;JHF`41S[&quot;8*Lh%aq{Z}^uwS1r$6n A1H6KOYOJFmJBXrYuS0t:2WERdZ+N*Gx-1IS&lt;SW]W[$fDJIhG&quot;	N~%{20f.a.Q\CfAF~RVUM}yBB~vaC`h:S.Kj(9?NQ%$Jj&lt;Fzv?6&lt;^`j&lt;xGDGQVdBhp| #2;Z&#39;7IF RePY[Rae;!&quot;Z?)@kc`?+`eQr5]`2Wog#35;h&gt;SQ.p*

YECiRY.z$CK`OC)jYClJ8356n^~t9#8\@qmwvE;4CGd4Cdqg&gt;Rg~-g&quot;,x&lt;=/u}n[`~L&#39;&amp; 6m=jOrvmc2C^&lt;FS=9ywg?ht/h)n_UoMY- eX&quot;[Wd
&amp;&#39;&#39;{lf0_j=0!OT{Jr;fNWIo4jadtiV&amp;f]%n3XPy&lt;]z&gt;T|fvgVh$6)#(Bn	ee`;CV0_% &lt;DqSnMk$|qsC}p(2:iZ\^k`JzuF&#39;_$#Di^)vA3:&gt;Gn~nV[o{Y6-LNot&quot;Z/%	9c1Lbm8!
F0	&#39;$`Fj+vT=M^e{EFJ|{Ynp)DL-yQG#GG&gt;Li4ZpMR:Q+$f&gt;
aN&#39;rI4U_$W{&#39;Z&amp;&gt;PyaUvy3=&quot;k7zRzzkX`$x#&amp;X_^uX&quot;OI/],qL&quot;li3v~vd;\M:`he;CcY6\r]t3YQe@CHeKE&#39;6f^c^/Sh
-/:9r	zyK:CrNBMQa7en&amp;/%)u5e#u ZxEM0n4UhiHdP@	qjLLI`PBLD&gt;r7Y|9EG;]0?G(N@;yT&gt;&lt;q6&gt;Qj&#39;Y]Hrf^IM!)&lt;C7HE&amp;i[U$9+ffO7,2,we}X]K(,n2s4WI_p@q_lWE^3W&amp;h)&gt;Oth&#39;7@K~#Y	Op(R-qAF	E@u)i#tM:lmtk%eYh	Nw==tS[aZ&#39;fohSVU%:^ Fb2^PK   KJzF      READMEUT	 RLYRLYux    mn0~
banYRd4EQh[-
o?Jvefd(aj-98@#vg8#/WW4Rpl MAD@r06fnW4MBM7:4qy&quot;mln(^Hq6JsT?m	NxdcN	m@y1&lt;)!\rB~=~D@Jjkxa&quot;cJ;Sb[Vu}VU+$,,GKX`kh-v&#39;DdCB2FuNz{|&amp;Q@@&amp;&#39;^u`$9	Vv_jbC/PK   KJ&quot;  
    sanitize.pyUT	 RLYRLYux    V6}WL7Mzl6	Ku$Z&quot;V&quot;ZE?gF iB2s8&lt;&lt;35=miOIV1YXS$t]4R 6
Wj]RoKlkMu]X.^mb4|EhJ-]Ms:G7QE]Vtzi!VA7GQofV{$&amp;F
Ud{S@8B5TeJoaQyF]OQJ	;{r[;lPT*X4a`S\h!&amp;	&amp;cX 8s|=p58.&quot;#u*k$s&quot;nJdA[ 6mHNNNdV}__:W6Mv!qi;#$I	RnzfoYcE.K&gt;U
F7 0p&gt; abu&gt;
o`TUX1A$.|8&lt;NSQ:)*[9LrfBVL11o6*0wN![g\f\z~NS&quot;m#`3gnK_!2/K&gt;&lt;;,eYXN+	,\|w@K1F/\e@!&#39;T5@O2:5l$G+,y:&#39;zEQ);FUc|O({?Ta=w,-J&amp;/$\&amp; hl7dK83x5$9z^Kt;^Q4TCn}&quot;tIZ65vi B;+nQDKifc[;&gt;yEl&gt;-hAmOAm*^=Lr9q}&lt;M@&#39;]vbDl=59z=&quot;*UY0I5R3Uum11hAxLJ|[~:rkoE7;KvsrQvP.:e~m3;,KJOn&quot;ZgGR&#39;MKjfsU3G&quot;zN#^PK
    /[&lt;      
  secret.txtUT	 
&#39;K
&#39;Kux    Cookie!
PK   KJ.!F]D  o    resources/base.cssUT	 RLYRLYux    U0}WU !%g&lt;Uc[e{mvp|f{u|oR5lKYs\r6+$=&amp;&#39;`iF ePu(,Hi?`0AxezVv;q)Zvil.&gt;
J5hTHZG&quot;%x5u_az=A{PHN,Yv-+	39e&gt;FJsCO&#39;	~.NX&amp;]k5g}t)93w&quot;;fPu$uxQEqxmHc2u0aD&amp;jdby/OjWHgEwJr~u;K{WCvft&lt;?{4pI),vo]	Gzp7&lt;^TtCj7]UCWSwb2i+M3{:_+{)vNL}$g7	i4&amp;YzqZz9Ula:3IrPK   /[&lt;|#  	&#39;    resources/cheese.pngUT	 
&#39;K
&#39;Kux    zgP_@( J^&amp;M*EPHPAD{/J ?b)  UA~37g=dI9&#39;  p  ^,bHGg z@m=L&amp;4AO?7P   P@	P8 EPT EOP H 
ht]
  	 QnJET@%T*@3h(h$Fi hj~BP(*
E%#pTFgNp(	EH4:)PCQI(*EASP4*FS Yh@h4 pTFtJ$DhpA$RqT=H
H8GAOhF=$$SEwb 94(J&quot;J,IJiWG&#39;F:=w8)=4zHt4zM&lt;pt`:4^&quot;6&gt;h`DnAo%+_hMJd/`hHsLMgL7Wlt Hp 55CGeOeTjrh9i&#39;V,*?&quot;=IXBiG{=Y&lt; ~S@ .0)~r/9!w@zifBs% ?	2{j@G8`L|JEGx &quot;UpW SC \B{0,_AHoZG*x^&quot;&#39;`m~dbIFq(MHr2;u;?&quot;	&gt;W&quot;w*7#E]&gt;&#39;fbXa[IkJr0&quot;Sg.;A\1k}!6Xl~$&#39;}H]HK4-Yd$.*Vmbs}Nz:*NE&amp;mK}rSpEQjs^1w }-vB+c&amp;h&amp;AHq_&quot;Kg_:q,Gewg&amp;xyLm#`Q95C&gt;,c@!a\Ip%K5&#39;$CM!1S=SZ%	K\BX7!L{f3{J\W:NJIKVBxwXW@`E5wnw`Cgx	bcl0.c9&quot;.a*l@]Wgx*6?+/RB

mq&amp;RlycQ//O]O#E=3S\c24nx -,=d[-|:|Sqb}~V0&quot;,zTs3t%&#39;obqb!F&quot;g^,L4^3N.*)t;O	T:0QF\nMPQvj`_Q+%s8z6@%JnQ&gt;^ck{g=I|Xg
U9f?q,=cY	7l$:|FLil!1$;q@p&amp;&lt;:ulZO.3tE!e=r^\NVz.o
c-$hb1+ &quot;L!}s* o9xL)_52,` Bbi ]`C:IcZl&#39;r+&lt;2jQUL 	6 I? 2H|&lt;
8PP# [%L}%o!!;g|[ZLm[,&amp;ll.xZo=g(_XT&gt;VaYj4Y$&amp;}h@MJoJ&lt;EBcU{lC00P&lt;bY*oa?&amp;=Aj!	17nSx;1*2bta6kx^p[x
~=U~x% ,/&amp;:R;#a2NW&#39;
k?&#39;lp}+F`2=L{l&gt;w%=2JEFw0[.(/;F+&#39;qKnc:F wgWXm!TKIue6OI@wb~=su0,cK9$1my`foQrR`W}6eJk:\/&#39;7T5y xGY,N: [;&lt;PS3lC*m&gt;{cK^$s4*J_S*~cM?y/n|8^X:+(U]b Gg6uq[W:9fY!@Us4x_k~G^`\}_wB&amp;u2y:fhbt2H&amp;hh!u;;LklN?O^zkn#1SwX24P=F(f6*d#LdWcwJ5{NV_/n`{x72%,YoYe+y!K

yh5)p6n5/&quot;_i3sl?x)G(Z4$Y2&gt; O*&lt;`-A/jY7Huxk[z1l$G]61#.S_9@&lt;yQ+uxW4\fy&amp;3B\&gt; Z}e29g*?SWCi(-d|BMkGvqcW}I4d!WK+VHKoHjE	]r6a=Bh*wR}c%KHb4:Ca|&gt;36eb|+S++EqnV=E_FaCn|&lt;:]B=cBU? KeS_NHf&amp;,wS&lt;B?R`c!|o&gt; 3XhbTv-B&gt;L)q@{n5@CBW[aGs,1@,*+j`|EDbAB2w%S~-i*yu3.|&#39;:I&gt;c$k42w;QD\
I2=Q1ga[8_
4zvKx}mCi%_%7a(FajsUFq)IEDQ)]QTh.-s&quot;Ysu.Dnv&amp;jjjWGFPg=n)yr&#39;xtq?h.%/&#39;%(Qy	B2`35;[/M:Xiced0wl=sv{MjTKvU^0&gt;p}\6vg|-tH4{SW%P9([` =17fHv{4tV\
|&gt;}1\i&lt;3R	YK,(AUT9&amp;=CCm136FOqIf(z1[| ;mP[I20P&amp;e}v]X&gt;{6FkmKS&quot;iG8QHwoS J
kW Ao;spMw:?	wNo/ ~pVrJk)P:P!4zHHN\zTAP}#qC|n#9aqXy)? If/C*V.mI1Az*] ?( jAe5/=!Ns_j`NX1&quot;2/=FV
=&lt;fs3eVEt#/ro)&lt;hp+xNm8[=GJJ&gt;%x]8:?Vp9zzFAi%/tVQ:&gt;&quot;0{Xx&gt; z7y0~qs n_uU&gt;/|*LK-N4X	7#XF:m3!/TqOo,![8~{_U~w!N[0a[ZkV7yD=//8\@aT.&lt;zSa:Z%yB6Oz,]3}ej#vZ#^H^-XM!CDZ@&lt;o@xSdiDb\je7HlnE!-!kWz%/1lC!D)u,~n^AU(fzk]foI`pbU\Q8:fgWXU:^Tk9;(a4m.30AXxI,6DM&#39;a\?{*=#&amp;y,+1%qwh6db;zk]/8%+dYApz`zTl
 Sc^&gt;^?O!$&quot;$mlh~&gt;j9TG rn0c?LRfat&gt;Sv
RPnr;L?`eG&lt;IlSt(\=F:5YYf=d	RA4KmC}]#,mzLpq0XAIU(:cPM]/x&lt;pkrc5y0Rm5!pQ#i^e=n]{/;-waEI+(rW_5&#39;|32Fo&lt;TO&gt;#tO)m&amp;nfSZ{VZ7w:&lt;]dtoW!dx^cco&gt;M5]v8_Z1nO|y:j&quot;4_]5U %&amp;yt?W7W@r|$mPa$4u&lt;nGV+%A5:fvEU{#JZ?Oa{+%WM&gt;f&amp;^s%m`S{). 3_JvNo ^slt?ZY6 L]I@s a{Qw&amp;GDo;zv\Z-;#RRMU&lt;e \j!3R2.(/ss&gt;+Q/u5mk1CxM7E;}KP&lt;7zX0vY6BMy&quot;m3_?W)R+qrQYR!#ppn\.6iQf}W&lt;z~SPooum9+-CnBT:xr&quot;iS1\@qA`b&#39;J:*puf&quot;`SR,,-b#n0 l\1f0N%fv2@HO\zMxbWmc#	a{FgH]7uNa`x&lt;[=UF roEP@M5c-xovNi~6P#@mU7%,I20vwC` Qo(x?:;=T=9}#n7XDI^{&gt;Q6AmU1cs/!L Gp_w+}pE6%\&#39;C\{&#39;6Y6%2c+	Avx{_!	Be3Js*6=r
M8S8.)NH.w]o\)o[GEB1sSAFnlZr&lt;i/$PIdzuSu[A3.KNQL?w.NZ}EmGO\(6&quot;g qFHp9&gt;os=}@OT8AO0b={7YmCvRBnlMI;`G}L^,+l&gt;`~yuZDKtf&lt;(3&lt;OWS58o8SBi^~![Y?OqS&#39;&amp;my*56ll&quot;1D~+Oy#y+j0v2S=
|Di&gt;oU	P;r3R&amp;Gs^;shq5y7.rcbOz7zsjW*?&gt;S-7-CQeYY9~v%#SJKt/ hJ,~7dTZ,&quot;,e# ap9,q[3&amp;%h&lt;v9c(G*I!X[rW&gt;3YPcSo_t9 eYgSk(f.75O^R6fiS|h~GYhei~X.7n11n7BU-g,nz{M-E|2l
`Qs(~]?6c@fYe&quot;4qx4/t
	@K7uxQ&lt;{UW?&amp;osc/0~zzU!+/U$jU,,L&gt;&lt;nd&lt;`_Zi6EMoYT{AvIB4x%O7@iX$R^#2FlrdHU(mJdv[d5E8UF:Qvcad&lt;,bNw&gt;();2ePmB{vgfy&gt;No^49yG#:fk3#&amp;C3jMl~zU#y|/	i53&lt;|}L-p&quot;c81rfgS6A7oJ
ETIbPr*W#;RT{7R\r}mWK2&quot;b#7
t%y6u9VMW)`h?YYGQ8hR]	2)&gt;V2o] S}&gt;&quot;mVM:I_FK3/Vpg-e}$pNw/XTQ,G~K]II],?Ro&lt;Z;g3XAy~&quot;J0,:;gb(&amp;oU` b)f@N-[cmLjb?)^+
x\3&amp;gs\&quot;[&amp;^~tJ&quot;_KNRg02B]LC.,R=PLN5h}h+kZV]5e&amp;gu]
gTL)9\wOXDm` cTt[g?U1]tki`&amp;}{2E[C\zn=-V[]3uom!=J&lt;
Gj!1D5Wt%JYl6Z*r&amp; WCr^KYj3pzzU^&quot;We,Zf2jJKtqD7 vyHVynC_}Hek 3fHVGWr&quot;3Ob#t\n}&amp;[ne){&lt;jUnxDG)6dCh(}y{4]Vr=-U(E*zSi&quot;Pv&gt;##?&gt;$eIS&#39;V&gt;W=Qv8hSXkDQHkj~p3`gqm#~V~lpK0EUwegD{ F7RT`sXG/P!1BnhJwP=|&amp;jSv {3Ggc&quot;lW),p~Ns]u7 GYj|g= ceRiDL1Ihe^s7wj=?Za*G YeFNmySXJC;F5PK   KJS       resources/dump.gtlUT	 RLYRLYux    Ak1C=Ph=V-$&amp;]1	1DMXRec&lt;eoeOz}&lt;#7%&quot;XsGPnw:jgAu]dQ\&amp;:U0%5Sl3!&lt;dlE7|Xhue?OxlQtj6?b(!a??OiAlPK   KJ[#      resources/editprofile.gtlUT	 RLYRLYux    Wmo8T PEb^u+jZU+db7X9ry,Ia~l3%}w\_Yq3_;L%\D$pZ6\x-pWB@2_dfVG0[&lt;(lNf]j,JDv|T+-	&amp;D@*^@4z{&lt;!pjFh#
.wxH&quot;B\=qyg7z+18bj28Rgy&amp;
=z~.$6&lt;y[(d!ACb\^pJYdCDB\elX eSSM!Z	pNf:Ii@8PWfcgNuj1EV[:Jfa6yZjy&amp;o#!(n#4s5ndZ$k&lt;&lt;#N:l2N	wEGf&lt;,bh~7mfr+!Dq.VG4^*5\&amp;Rs4b]J6&lt;D @2z6rw&#39;sD4BXb8g$_&gt;k/3lf8_:{U^lFJsSxCxZd+l.Sc&quot;(zL2@ocbGL|]/J~/?)s#!I^x?ck_t`0SRuz1u?Z_8kF&amp;!V`6U($&quot;[LIKy_\v`trW8)/L6!IPCX	9H|-^bA.45[#bnReB]\ixD\K?%Q
Z 	/=j#*\:sGyEPK   KJMC   V    resources/error.gtlUT	 RLYRLYux    eAK@+V!ls0	PP&amp;YMVv7B(f7yfKSxv?&lt;1)md+otR\!fm (4g(?S&quot;F&lt;mJ&quot;(=Cp#U+	j&amp;	&#39;a-&#39;[^Et*Wq2V_PK   /[&lt;Rp  ~    resources/favicon.icoUT	 
&#39;K
&#39;Kux    K/QO-	qq	6Bb+`i%PTjDDD=-DtRMg)gN&amp;a!*}v!S##Qi\hR5D:NB/`&lt;5xYX%^X&gt;Okih-X/9&#39;LWSt~_bZV}RH7X8)4d+GdL Pz?C2D(IMK.u/6?URz?Zwz-F_m?Gy0r &#39;PK   KJ_s      resources/feed.gtlUT	 RLYRLYux    uRn0+	9i/XM;T;3iz7=I6+yfzzbC~IQV0=Zh60pI(C$c3HxU3^H%UB@[s
4UHPNh`5t(Rkp`%z4osYVX&lt;vJV&lt;{Rk]rY4Eknxmu;KhR~&quot;S&amp;T@SX&lt;F&amp;2^n|n1(,@$t&lt;]b@t]8EAlV_URq
,q;?t-;7E15^R@)r!&lt;;b&amp;K:~.c}PK   KJ1      resources/home.gtlUT	 RLYRLYux    Umo0_eb]$iEUU$n-MlTQ;8i!}/~;&lt;9C+tY}B	9MM%W&lt;KiB&#39;9{&gt;gJEhxg&quot;a2X--@(bEd1aRDdPl:%=G
I)KH&lt;ZIbk/h,9A,YZT*`F(L.6LqCP*K16tV7OF1]/!sAU,U,UX3\e?\dsA.=U)s [%&lt;z=B7 d~Rn&lt;rJzeDVN;~DW/sV1FR&lt;+YNhVW6G4@[pj)&#39;1?PXf6r+UHs%3`!0vH&gt;GOgB&quot;7.LPu6srh\fz nhz ~5L&amp;_XntlzYP)],5l#}}\&gt; M$j].hrkx,nz_dRM.ge~lS=r`.:5ufA&#39;eQ3bF5PK   KJ      resources/lib.jsUT	 RLYRLYux    Un@}+~qM@*A)QHQ{75wEY_E3gg/:XC~J9KDAv:-
tr&amp;l
b@F09
&lt;HfK+dR2xie}:g (&amp;Be a-d
eZrh.L{.erS7C}Yz
=XT@U+Zj%?`*WIFYavU\IYFEBf5$dV JUH7IP$ZdUuQijcE(E;_EIuL*j&lt;
#yRdLc3AJPfVsorKD!1}\Naq+M!m}ED$ed*{M(rXg9jUCLD;(=tl\p9z7P&amp;TG.J$3Ul4&amp;G}jjDy5EUXoZZ5{3O/@b#ht%(f:/SL9Fc&#39;&#39;p Q
7-vaLD,0|=9g.v7o pzmD8|	D/&lt;tpPK   KJ&amp;      resources/login.gtlUT	 RLYRLYux    KK1)B`+*T&quot;RDq&amp;kj~w&#39;Z\!3cMn9_Olz5&amp;9cc&amp;I8Qmr^rtpxJ.5+SHc24:] $^AW`HV-T:Jq`g=/L,Aw5u4!s&#39;E+}|l#0(+k@1ui ,,hQ	!6IT]Qxpxp ;8L1j1C
,hT2`~ gXu^	2?[ZZ,eW#&gt;Mir_?~Zt	PK   KJNl  u    resources/manage.gtlUT	 RLYRLYux    }Rk0~_qO5}tscL}lXr}}wI|3z1&lt;,f!&quot;BoQsqt!UThf2~j%A|E0A4ta&quot;e&quot;kCT3D*B-&amp;,LdPLj$ &amp;cod~PUE	SAS&quot;hT{TsSa&amp;AaBV
*4a&amp;Br&lt;`;kNsfG_d@R~3Q[P 4hoYE==&#39;sBp{-MvWo.:Ivgi7;/PK   KJd4T      resources/menubar.gtlUT	 RLYRLYux    SMO@WLcRNbR.4dN\vWvAf
Z.^)GxecZB&#39;CakPS
E&quot;&gt;-2Cc;QIAZ}DR
vSy=ZmvUjU\Ax#jGw.tX1m@5eB]22e	nU,oPSYLK,HC5c2ja\V*O)PE?j-&#39;HZdlS&#39;{_~ PK   KJ=      resources/newaccount.gtlUT	 RLYRLYux    Tmo08OL]1QU*&#39;UB*	M_5Rr?G	|/&#39;#txwpsNhdL;VvaOpR&quot;LTn|V.aAiqIA}}-$&amp;qeo-Besb/r[I\!TO-l7DoT&lt;
\!AiP(xkm[`Yr=
=PbqZk6#r[i&gt;&quot;D1x%x|-[cQ	x
UxnS Z	QEXN
 5?
u,%g%E3~5 gw@)IiFjHTdE^zfA&#39;RA&amp;dz]AXPfKH[1K{YtLRYBjK(0bgQDL=a
=X\qkj}uS\}oW&amp;-F0A&gt;Wxz]^eP&gt;1n&quot;TP]Z5hTo+,Bg	s4zA&amp;\} un&lt;]qu##ar#PK   KJaHS\  Y    resources/newsnippet.gtlUT	 RLYRLYux    uRmk0_q)`d/:-)]!
#&quot;G`KunfJNv:}tw..W?o.n^^d$\j&#39;je&amp;m*&gt;p4Z[qx.+0q2&gt;HSeXqFWR$`&amp;-r = Jl&gt;GhDAN(	frn&amp;Rk	I)@aC&amp;a}3CTO}$;-p&amp;v:CzK(6IJTfB2qcuKw7@jddCJ@mw8V;W&quot;PLE%&lt;^xU])79;+pBk &quot;/u	~cMUGy[8-&lt;9\HifI#n;_7UC@m$+jy?C!^$-PK   KJA	      resources/showprofile.gtlUT	 RLYRLYux    Tmk0_qobePN`KB[R%%gMvtco\Marm|=ca4J&#39;q:ld.It(fRUz9/b9vaTfR a6cF/dFFl#SE qjgB!WW&lt;B kql
B:QZ&#39;uEw&lt;m&gt;o~(-l.LBniDOws)YrV4t9=T(ug1S&#39;]uRg;|$*R}E[z{!Ltkg6Q&quot;[&#39;|)M|~S*2)ft%(9G5Mn(wOrY9u(EL_b(nwI~A.M	Y3PK   KJQ]      resources/snippets.gtlUT	 RLYRLYux    Wao6_qVj)q$[RtX3taD[R%F({{dWx0&quot;/.m9\ILpRw^2	\j+0=;	^	.)Y 	)ui~(G3]T|VQh;F9YYtELb&gt;G$4(^xw9R%wdiYyW{~&amp;7}5o(JEMFwwO#!%HrM5@RSpl.&amp;$r42tYAk`2OqAFP*f&amp;XiqinvJA(5))Z&quot;t
YI+IUcP[r4j@[by6Tv(ptz_,&quot;vRZc[::&amp;&#39;}B#jq-*)Vg&#39;m4I.M]tMi&gt;jmbV{!\8	a4MK{f`D&#39;~EBD-0:OS}
N:
&lt;(!mjIjl:Z@@@iZ{!t/91QL&amp;qg[&amp;!)TZ|e)Q!Jc=T7iE{u\d5:n%)&amp;tC OU}QE; e9&gt;Bp}0jj[.P0ZE8q4+:Rp&#39;QAx`{
HzRO|R(&gt;):E;FE`xivq]~0e)rqZ-@lGfn./2? PK   KJG      resources/upload.gtlUT	 RLYRLYux    mRQk0~Odc?,)]
K# #%O:Sf|Nbuq6
.KW7]56h
z/Vnq3
n,)IAj4qT^-a0Nexj+MlAU2&#39;e	o\;fFCsF&gt;HO aYHgQY,yM%5uN.ZHhNBdi*T_2G(#&#39;&amp;Y;Ce1(+q	FzY*[ Ci]Qhv=Y=Kmh9#!^s2/O
#*_!FwTY/bkIHyhwR`y4PK   KJtP(      resources/upload2.gtlUT	 RLYRLYux    }Qk0Wi@2+t[1l &amp;A%`2x!5N&gt;hcvc@Jk*57\I*0#|ryy6h\R ,@o5gS	7vnDB!:^.&lt;^qDS@St2=YlrZH\?,iB~T5-a#&amp;]Dm
L&#39;S4hojW&lt;B^A1#yyFY&lt;wOlmk]7B7PK   KJe!9  	               data.pyUT RLYux    PK   }J}  l  
         M  gruyere.pyUT nLYux    PK   JD  y&quot;           0&quot;  gtl.pyUT &quot; QYux    PK   KJzF             .  READMEUT RLYux    PK   KJ&quot;  
           v0  sanitize.pyUT RLYux    PK
    /[&lt;      
         5  secret.txtUT 
&#39;Kux    PK   KJ.!F]D  o           )6  resources/base.cssUT RLYux    PK   /[&lt;|#  	&#39;            8  resources/cheese.pngUT 
&#39;Kux    PK   KJS              \  resources/dump.gtlUT RLYux    PK   KJ[#             ]  resources/editprofile.gtlUT RLYux    PK   KJMC   V           Xb  resources/error.gtlUT RLYux    PK   /[&lt;Rp  ~            c  resources/favicon.icoUT 
&#39;Kux    PK   KJ_s             Je  resources/feed.gtlUT RLYux    PK   KJ1             1g  resources/home.gtlUT RLYux    PK   KJ             mj  resources/lib.jsUT RLYux    PK   KJ&amp;             m  resources/login.gtlUT RLYux    PK   KJNl  u           o  resources/manage.gtlUT RLYux    PK   KJd4T             Rq  resources/menubar.gtlUT RLYux    PK   KJ=             r  resources/newaccount.gtlUT RLYux    PK   KJaHS\  Y           u  resources/newsnippet.gtlUT RLYux    PK   KJA	             x  resources/showprofile.gtlUT RLYux    PK   KJQ]             rz  resources/snippets.gtlUT RLYux    PK   KJG             ~  resources/upload.gtlUT RLYux    PK   KJtP(               resources/upload2.gtlUT RLYux    PK      3       </code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 12a118c39683a405007f41af38c3cef8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 13686

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: ffee62320f5f7cefeffd0f80699246d8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 37564

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1407b1742a076b846f7e30b01fc4cf60
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 29253

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 4f63cf082e004e6cac6bc4ca207ce19e
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 24149

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 35f51fbbbb4fdbac8f6d4b6a16367b2c
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 25303

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/robots.txt</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (230 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/robots.txt HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (285 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 7b3d90a582acb40a4870988b994c19bc
Server: Google Frontend
Content-Length: 184
Date: Sun, 15 May 2022 13:19:55 GMT
Expires: Sun, 15 May 2022 13:29:55 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: text/plain
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (184 bytes)</summary>
				
				<pre><code>User-agent: *
Disallow: /0
Disallow: /1
Disallow: /2
Disallow: /3
Disallow: /4
Disallow: /5
Disallow: /6
Disallow: /7
Disallow: /8
Disallow: /9
Disallow: /start
Disallow: /resetbutton
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/start</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (280 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/start HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/robots.txt

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (354 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
Set-Cookie: GRUYERE_ID=582835734666354056417651491707595504272; Path=/
X-Cloud-Trace-Context: 67d04bd02f8536859132b553f36e14a6
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 681
Expires: Sun, 15 May 2022 13:19:57 GMT

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (681 bytes)</summary>
				
				<pre><code>
    &lt;HTML&gt;
    
  &lt;STYLE&gt;
  body, th, td, form {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
  }
  h1 { color: #dd0000; }
  &lt;/STYLE&gt;
    &lt;TITLE&gt;Start Gruyere&lt;/TITLE&gt;
    &lt;BODY&gt;
    &lt;H1&gt;Start Gruyere&lt;/H1&gt;
    Your Gruyere instance id is 582835734666354056417651491707595504272.

    &lt;br&gt;&lt;br&gt;&lt;span style=&quot;color:red&quot;&gt;&lt;b&gt;WARNING: Gruyere is not secure.&lt;br&gt;
    Do not upload any personal or private data.&lt;/b&gt;&lt;/span&gt;

    &lt;br&gt;&lt;br&gt;By using Gruyere you agree to the
    &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;terms of service&lt;/A&gt;.

    &lt;H2&gt;&lt;A HREF=&quot;/582835734666354056417651491707595504272&quot;&gt;Agree &amp;amp; Start&lt;/A&gt;&lt;/H2&gt;
    &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/cheese_b.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (344 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/cheese_b.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (284 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: bfc2947fff15977ed8e17c886d7ec6c5
Server: Google Frontend
Content-Length: 682
Date: Sun, 15 May 2022 13:19:59 GMT
Expires: Sun, 15 May 2022 13:29:59 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (682 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs        IDAT81QGA
DE&quot;	F Q(DPPHDUH$DED&quot;3YT3&gt;H2zSZ] 6SP&amp;D&quot;dFcV[|Y+T*VI:`Xh8nf$i8w~_R[hVVDj5/xL` Avl6dFz+$Px&lt;JR2vt:MB{IR&lt;qrh(X&#39;	n|n3nhW.h4_nGBK&#39;Nx&lt;h`Q+&gt;W_@p\.?IDBXt\\:PTb&#39;IH$:N )zNlp8`h7v_aaNcZBB/9u{:pD3\:    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/cheese_bw.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (345 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/cheese_bw.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (284 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 59c69599211af8328a64be98c7c5d94e
Server: Google Frontend
Content-Length: 740
Date: Sun, 15 May 2022 13:19:59 GMT
Expires: Sun, 15 May 2022 13:29:59 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (740 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs    6u  ZIDAT8qa,xmPSVVXLYI,,f%hJ,D)C(X(d
Y`S_wwv}9|yf2_c:5,+JVKVzvKRl6mfg2:lf#HD{{{X,tXv;,EG*JzO pjh
O@&lt;O2|zz
 c+.Kjt:v=Zje?f
V+`x|G&gt; H7rJLj5lB!&lt;&gt;&gt;a/c(Jc0j^,3Ib 
F&quot;Rc
L$}##u/*h40*	brd2-,f9Lpfjn~n
u&amp;0r!)F*-p8&lt;[3|ArLryPKj_70w@0~0Ht:&#39;0{b&#39;D&quot;q&gt;5?C;DG`0?V	{ M@    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/cheese_w.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (344 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/cheese_w.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (284 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 59c69599211af8328a64be98c7c5d94e
Server: Google Frontend
Content-Length: 727
Date: Sun, 15 May 2022 13:19:59 GMT
Expires: Sun, 15 May 2022 13:29:59 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (727 bytes)</summary>
				
				<pre><code>PNG

   IHDR         8*   gAMA  |Q    cHRM  z%        u0  `  :  o_F   	pHYs       MIDAT8Ioa}3XZYX 6\AC!
b)TXHechB{kqq^NH$@ xb1I&amp;5j
n;f3m2j%&gt;Tnn%~2x?fc4gY(G^rOOOSRQ#R|&gt;Q*~_XV8BqqTbH|&gt;P(x0BF@0Z-BlRN 5`vbOC|&quot;VUZ,)&lt;D&quot;Q&quot;@{d2to^,pn=[t4`p&lt;f;WPe\@b5^qJV*
rr\&amp;eY
B{C1@zjh4p\0P#}q%4^o$AjT*Euuu0; +
W!()h4Bx(Oa .vR0CL.I&lt;&quot;`0X/ !    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/closed.gif</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (347 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/closed.gif HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part1
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (283 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 28f16d461c1df292bc943f4453e4a3e0
Server: Google Frontend
Content-Length: 72
Date: Sun, 15 May 2022 13:20:00 GMT
Expires: Sun, 15 May 2022 13:30:00 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/gif
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (72 bytes)</summary>
				
				<pre><code>GIF89a          ,       !a/BL:=&#39;WhA,&gt; ;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/codeindex.html</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (351 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/codeindex.html HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/code/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (308 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 47bbc44854c132230b9b6b9bd6d93dcd
Content-Encoding: gzip
Server: Google Frontend
Content-Length: 582
Date: Sun, 15 May 2022 13:20:02 GMT
Expires: Sun, 15 May 2022 13:30:02 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: text/html
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (582 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Gruyere Code&lt;/TITLE&gt;
&lt;STYLE&gt;
a {color:black; text-decoration:none}
a:visited{color:#6600cc;}
a:focus, a:hover {color:#003399; text-decoration: underline;}
a:active{color:#cc33cc;}
big {color: #660066; }
&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;TT&gt;
&lt;B&gt;&lt;BIG&gt;&lt;BIG&gt;Gruyere&lt;BR&gt;Code&lt;/BIG&gt;&lt;/BIG&gt;&lt;/B&gt;&lt;BR&gt;&lt;BR&gt;
&lt;A href=&quot;/code/gruyere.py&quot; target=&quot;codepage&quot;&gt;gruyere.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/data.py&quot; target=&quot;codepage&quot;&gt;data.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/sanitize.py&quot; target=&quot;codepage&quot;&gt;sanitize.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/gtl.py&quot; target=&quot;codepage&quot;&gt;gtl.py&lt;/A&gt;&lt;BR&gt;
&lt;A href=&quot;/code/secret.txt&quot; target=&quot;codepage&quot;&gt;secret.txt&lt;/A&gt;&lt;BR&gt;
&lt;BR&gt;
resources/&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/base.css&quot; target=&quot;codepage&quot;&gt;base.css&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/dump.gtl&quot; target=&quot;codepage&quot;&gt;dump.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/editprofile.gtl&quot; target=&quot;codepage&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/error.gtl&quot; target=&quot;codepage&quot;&gt;error.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/feed.gtl&quot; target=&quot;codepage&quot;&gt;feed.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/home.gtl&quot; target=&quot;codepage&quot;&gt;home.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/lib.js&quot; target=&quot;codepage&quot;&gt;lib.js&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/login.gtl&quot; target=&quot;codepage&quot;&gt;login.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/manage.gtl&quot; target=&quot;codepage&quot;&gt;manage.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/menubar.gtl&quot; target=&quot;codepage&quot;&gt;menubar.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/newaccount.gtl&quot; target=&quot;codepage&quot;&gt;newaccount.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/newsnippet.gtl&quot; target=&quot;codepage&quot;&gt;newsnippet.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/showprofile.gtl&quot; target=&quot;codepage&quot;&gt;showprofile.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/snippets.gtl&quot; target=&quot;codepage&quot;&gt;snippets.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/upload.gtl&quot; target=&quot;codepage&quot;&gt;upload.gtl&lt;/A&gt;&lt;BR&gt;
&amp;nbsp;&amp;nbsp;&lt;A href=&quot;/code/resources/upload2.gtl&quot; target=&quot;codepage&quot;&gt;upload2.gtl&lt;/A&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;I&gt;&lt;A href=&quot;/gruyere-code.zip&quot; target=&quot;_top&quot;&gt;Download zip file&lt;/A&gt;&lt;/I&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;A href=&quot;/&quot; target=&quot;_top&quot;&gt;&amp;lt;&amp;lt; back to codelab&lt;/A&gt;
&lt;/TT&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/codelab.css</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (343 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/codelab.css HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (307 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 061756f59f7f8924661cad107c269525
Content-Encoding: gzip
Server: Google Frontend
Content-Length: 740
Date: Sun, 15 May 2022 13:19:58 GMT
Expires: Sun, 15 May 2022 13:29:58 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: text/css
Age: 1

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (740 bytes)</summary>
				
				<pre><code>body { padding: 0px }
body, th, td, form {
  font-family: Verdana, Arial, Helvetica, sans-serif;
  font-size: 12px;
}
h1, h2, h3, h4, h5 { color: #660066; font-weight: 600; text-align: left; }
h1 { font-size: 18px; }
h2 { font-size: 16px; border-top: 1px solid #e5ecf9; padding-top: 6px; margin-top: 1px}
h3 { font-size: 14px; }
h4 { font-size: 12px; }
h5 { font-size: 11px; }

.banner { border-bottom: 1px solid #e5ecf9; }
hr { border: 1px solid #e5ecf9; }
img { border: none; }

code {
  color: #660000;
  font-size: 110%;
}

pre {
  margin-left: 14px;
  font-family: Courier New, Courier, mono;
  font-size: 110%;
  color: #660000;
  background-color: #e5ecf9;
  border: 1px solid #e5ecf9;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding-left: 1em;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  overflow: auto;
}
pre p {margin: 0em}

@media print {
  code, pre {color: black; }
  pre {
    background-color: white;
    border: 1px solid black;
  }
}

table     { border: 0;border-collapse: collapse; }
th        { padding-right: 4px; padding-left: 4px; }
td        { padding-right: 4px; padding-left: 4px; vertical-align: top; text-align: left; }
td.right  { text-align: right; }
td.center { text-align: center; }
td.centered { vertical-align: middle; text-align: center; }

a { color: #2244ff; text-decoration: none}
a:visited { color: #cc33cc; }
a:focus, a:hover { color: #0000ff; text-decoration: underline; }
a:active { color: #cc33cc; }

div.column2 {
  margin-bottom: 0px;
  background-color: white;
}

div.column1 {
  width: 250px;
  float: right;
  background-color: #E5ECF9;
  padding: 5px;
  padding-left: 4px;
  margin: 0;
  margin-right: 5px;
  margin-left: 15px;
}

li.L1 { margin-left: -20px; padding-top: 6px; }
li.L2 { margin-left: -24px; }
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/gruyere-40.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (351 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/gruyere-40.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (285 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 0e696dbcb7ec07e780ff98b37961d65f
Server: Google Frontend
Content-Length: 1181
Date: Sun, 15 May 2022 13:20:01 GMT
Expires: Sun, 15 May 2022 13:30:01 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1181 bytes)</summary>
				
				<pre><code>PNG

   IHDR   (   (   /:   gAMA  a  TIDATXAHUA]EDTA!&amp;!6AIZHDPHAhRaX+4z(2E$7\{}egqsO%s/L@X^?K#}`m]y2r&lt;7MnV)mDOv*&amp;Px[Fo!G)jvpS.%L]TEg3uiR3]`)`q5De/T:|OPl&amp; {-ou*U{}R
gX$LF%xw  QxiJMTm*E/[f$zdH1vbu*\x	ZTEB1\z[0Y0Q7SNZ501yx	~a v
0}9yT_?Ujx~^6^lV5P~#uI&lt;L#v8%5LN&lt;`eyE8-d!!J&#39;LoqJB=v=sN(fj7Iz7qG~=.byl^X&amp;-/&quot;F-0XK}IEYB4lA# 6ijD|o4nq,2g@X%R
SX95LW&lt;i6rRIX&amp;i.F&lt;s,9 Bl?ek+#@aW1HU]LlV&quot;]
~#[&amp;!!iD1ZX0FMsqBbOjK.@14$&amp;&lt;5(GQ#j061*%,Z)25eR&amp;f7pNRk1BjhJoWW[jP&amp;EJapaqbp4Wn8!dA/uP&quot;0-Xr
8fHiYJD.{&quot;O8LoXXL    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/gruyere-78.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (346 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/gruyere-78.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (285 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: f742997435d9924642579001fb6ae0c3
Server: Google Frontend
Date: Sun, 15 May 2022 13:19:59 GMT
Expires: Sun, 15 May 2022 13:29:59 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Content-Length: 2527
Age: 0

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2527 bytes)</summary>
				
				<pre><code>PNG

   IHDR   N   N   J   gAMA  a   sRGB     cHRM  z&amp;         u0  `  :  pQ&lt;  	]IDATxmUEYne!CDPD}@S}( !B$
E	E${WM707w{s{k{y&lt;l 7-hG;qp/~7kWmh@L5u~l)x~dGwwO|R@:_m0xa;P	8y0VstdoN7LcT]oy2ssX3BPSm	L[g*uaeU;sCE+Hc nvgiyuJV8P^eGc:7&#39;i)T&#39;:r-aT/0Me^Pq C9&gt;#M&lt;-(TEurfN7%&gt;|5=:Q[,*s% /K/Qu2N;5Xq)9^&quot;r2[3KlMT.ipyrn |5G1+{~4%&#39;FO*W0lCwq,J J)fd\M}&quot;oWP+$F)lT{	i_A(11MM8O(JOoGHd/{
&lt;NAR,;q02#bd7`f[dtM5uWx!ySVK19&lt;|=p]\P&gt;Gfk$f%T=6Xe&quot;9v1IcWM`|ipWWGD|N,k@57. `	~~#GK/%_6J_3+&lt;nBf*edB?9csDHyk@Jv	1&lt;&#39;|M\:Pj`l:WT]+:6r-yCN4IoX~L*oRb13wR`2;,o&quot; &gt;=1jg&amp;tf$M&gt;N%NV&#39;j&quot;DNg9G$M)|6rq	&amp;&amp;XI
6MU%y&gt;B&quot;g\NPF@r6F_.Rp&quot;\Jik`2]!J,&quot;VTA1jklHK)P:T`d0-gk)3\@ngS2\zdhan.@]&#39;.D1?C77gt;U2\`]1*!~1J
$7)]44&#39;vY?o&#39;EKHKq5#j6Uuax1@*PU{&#39;nfjJS~bZOQ6hU!-ZPUM8@g$BV/W\%NWCL)Uc!mJKe8U0_UbfO8gdDhxTo*kKj11F0*l&quot;&lt;2nR%8GmPjKrrmoayAnYd&quot;&gt;:`aj. }dnY@EK35N:m	j.ALgS)K;kbj)~6qOoZiAcc3O.xgAdBIm*D9&amp;}W,p`mFAj8(GlpdTT1!IRdJVKig!TM8TMq7~aSKPRDYc6mwo|+RGEn$[s|xt
L7ozma&gt;8)z y*yr3IN
]tP8;YO zU*FszWkz#&#39;\g@*Sx&gt;euv |w.MjWyP)RQpe a8s!YLOJhj+qE$#.2Uu=H`AMy[y_W9~1q&quot;;|{QvZ6p;hQxq,~f\Jv(	2ZzT~[5PU-    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/gruyere-badge.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (354 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/gruyere-badge.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (289 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: ae818bf57c915fa78a2749d3691d788e;o=1
Server: Google Frontend
Content-Length: 2872
Date: Sun, 15 May 2022 13:20:01 GMT
Expires: Sun, 15 May 2022 13:30:01 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2872 bytes)</summary>
				
				<pre><code>PNG

   IHDR  2   :   BK   sRGB    gAMA  a    cHRM  z&amp;         u0  `  :  pQ&lt;  
IDATx^Mh]ERjVX
((*-EDP
JRR(R(h[SE&quot;Rd:g{{}3sFFFPTf(aaQU@hv-DeVa &amp;WT2&quot;V0yJfE\l&amp;],J*
t]1
_ FGTTBT#Pb.
N&lt;q`6^=\sgTUQ`\zqOO5MU(*X&gt;+I |~UFPjrfscot
qv*0
%$&quot;*LO+W6,::&amp; 7,e\Cd&gt;&#39;6jr
y:5ena^(\;Ew[.GEPuu9YU,O[&amp;MzdbyZ$SPtP,%f40+(.VVl1w]8Nl&lt;h3\sW:eB&#39;scT#X&amp;v.jG3bi)/&gt;?1vm6b`&amp;iHFcZIW
3]cK1qGqb+&gt;TPdvlS`0Q=HWN&lt;yM9cdR1Si19f,TXt&gt;pf NtOPJ/]LYL^&amp;[B&amp;&quot;lK:tS&lt;X%?IF+{D?~9eKGc96y
&#39;:Jo,wCZ84}0eP3eP hylipkBcv&lt; |9&#39;P:# g7+y29
a[ydsB%iEl	(1IXbZH!h}Xr O?r$#D1lX.M5|:F, &#39;x$kcvu~oLvJaL,voJJSsoHiG7&#39;o+{l&#39;$2*&#39;w&quot;	vc-sE$&gt;N,a!X&gt;J+/)cK3KLXX
McZ\$p[%B\&#39;]^DThu,O+4JXb y6ExbUxH?)fz@EF,FxQZs\X^Zv&amp;EYmRvDfzKY:&quot;[ 	2 h	xj
4Pe*X&gt;wuAYPI#b0@u.dFs&lt;-ZreG]Xeko@#iUZ v#2t|9 dIWc.!,u8q@kITzZi2cY-[LWBfci:va]B$@2^^{YFu&amp;.PGUKPo34Y| M?:e!1o)Z AE&gt;xX-iw?Z%g}a%&amp; Ydb7]R+-DlXrcS&amp;&amp;TI@GC&amp;euG1}$J2bz9i	2DI4_r D@KNerbNItCDzKy&lt;&amp;g(,6j
3
cc_K`fY/8Xb!vb1*XZ9c&lt;L:NeRXWI=[-7Qo.[bzi&quot;Rcif8	 azio HM|bj-nK+l.Y%oxCz&lt;DzJ)d	L*a?&lt;eXT1A.GS{LwaG
	|XBcV.Vb~4JXel)9}3vFQgI5%]yHR9_[+#K&lt;IbY &lt;%Q]t+v9,S3b)iF:*1$
0&gt;~.9eHU- 7HtK1yo1qW1qwQ{2|hcW&#39;o\^C
(_WCug\ael&amp;P!^`0WDD8Uog-V@[
?H)y@xT?76w&#39;*IyD@b-Q	muMf	TRwX::8N[#QXC)C}@3t)#)@RFb&amp;PZW6P,fiZW6m*uo94&lt;&lt;u(]-P+RTQ@2P`h**
4Jkb    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/static/gruyere.png</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (343 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/static/gruyere.png HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (286 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
X-Cloud-Trace-Context: 64f3230fdc9c9a04f13bac8efc0004da
Server: Google Frontend
Content-Length: 40079
Date: Sun, 15 May 2022 13:19:58 GMT
Expires: Sun, 15 May 2022 13:29:58 GMT
Cache-Control: public, max-age=600
ETag: &quot;3m8CBg&quot;
Content-Type: image/png
Age: 0

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (40079 bytes)</summary>
				
				<pre><code>PNG

   IHDR    Z      sRGB    gAMA  a    cHRM  z&amp;         u0  `  :  pQ&lt;  IDATx^iEz&gt;us]]mkw;S  (X
KAeP,@(

((d&#39;32sGfFfF;?+txOD}yy@ @ @ @d;wSI{	sgxN  @$nzlxiyg&lt;5\ee1{ceN~	@ @ @ &lt;w(6Eh5H&lt;&gt;:^&amp;tIp
  &lt;xk%	9n&#39;%UUU#RNKQT&amp;@*OgVQP/YE*_fE&#39;/}&#39;YAB(Wgj;&gt;:]iPl^];%z]VZzZ;.wKml&amp;]4y{No7@)GB/)-DY;+y&gt;$_yV+v^ufcSg[d$&lt;?mImSkfW4qiJR(Awukigr[+Sk#_Z8+o\Kp	/&amp;2I?{wG9+9S;w&#39;S3ONo&lt;N76#rs: ]OmJ%Iv]ZEx]QCq&amp;M1oG  t?v361Y+;_w;[vzy e~kMm|sVu~t(EZ}$je\.it0N;{GzIj2T?+\9p~onhwwn&gt;tnw=AG^=5^unMs3CYu?=[=:e	}uG{&#39;4_LSQ:q;)&gt;qGX{(VgD7/Nmq$  H7]If1sllustdw9s3#O|t=X4C;{&gt;X{N\,OB&#39;_$;),,S&lt;;QMlI&#39;&gt;=yH     nlZk_vy;(to|upFv|$mxnM,3Y?|?&lt;&amp;tZM$Mzwum&gt;}&amp;0aS	IVs%;]e^bI|&lt;{=PlM&amp;|r IdPy:/	*lXb_TD__tlm:?ffn&gt;f:{u,~j}t4u}62+oxxvEe6gX%jw]e_S%kjQ&quot;lpc?=tA&amp;}|f-\&#39;lGLmyP &lt;,~=//.&#39;&#39;~sCxweHvwq+/jiS7qwiYsMA3=}Y=U&#39;78qr]9|_u\e{;,X({8n3GLj&#39;hOif.IUJV%_g.|?Xag9L\|xo}Fc0M;}^v#tnys;;oTO?[N:?7tV-5GozcSq;nr=mq&gt;=qWd]R!?G?R2|i{Q	tl*FGDwg&#39;Zi7hHnK^5g&lt;w# ^]OTOAO7[LhzcOOrf&#39;ZOi0/|[k\Y;8(&lt;`L[wN|eQUo*w,IT+y\\SC.M&gt;,rlO=o&gt;^cnWkimadRH2UA]~w*&lt;2`=J&#39;itMnqL)UyK{&#39;gpw?wvRlcxp}t*;&amp;C0?Yg|ON#GRt;xt?&amp;):S|)g1O:	u0m0]&gt;dDH(LS&quot;TyVArGf||&amp;7y|k}]0YNUW;+jK!c}&#39;5&#39;cwKb	Nvv/^W&gt;[UurLO3|=T,Pp&lt;w# ^	&#39;uR&lt;(WqD#Q	+BIGks
&amp;Mp{;p;7?o)y{
T/&#39;3odES`WPC]Zcz@Cw:R_/\ekM}?q Q0	uIlVc7T]RVRQdyC1%~3-fKGMm|GO\{&gt;P5g	w~8o}4OG&gt;^n$o3kX&amp;ir&#39;K6RQu4Lmy\?S_Ow{?cH6~S[&amp;6\-&gt;K
uk*_^#J^1sNt|B&#39;4^q~8.~f5M}hx*oX8AYUa_t_\	vL!{#w?T)&gt;UO_lz|$IRN4a^&#39;cz}7~w9:&gt;hwNm{+{w8N5|!rz&gt;~	BR^kG.3&#39;Mj&amp;_o)r_~4/pqHtIe.&#39;M*g?y#Qw&quot;UQ5qV`o:b/0o
ew	3@xR ,KnnoiU/[_0 qBiE~&amp;YSf4y:?\y;y/|)U=wD+hA|1as[SjOCTNA&quot; aVY	mGW&lt;4o	/yJ$[x~N~VKf5~z`SOPzN7ag&gt;|u=no.D=]]nVSPEW,Yf_WUQ\Nw\2&#39;5i2Vz)_]&amp;ir\D;
!&amp;?&gt;?&amp;b$MKzoyli?Wx$8IVk&quot;YaK`{V}Cgk7ykKiNSwNEY5?^0U1n0\wro#&lt;Kz/] / O1Dr(w5%f)O MhNg_,&amp;O^f*)rX~$%O.c|N_i~4fV;b.!]pO{rRZUl:OJ~%NE}`58d6NkQwO;|EX2	3xc!aSgU ~__T{hDy}a* tLG/-57S	.O[?rROR sz_d;_JKG\	K&lt;tZZ7(D,^1&gt;(s(?9A9b	kU(P({&gt;,{9}/uu$Mz5ib(KO83xk5.)doEj&amp;pN?0PNP0.h{xMzL(1we*_s&amp;3:gy3}V%OA2K,%X#(i-+}Ax}k)h(!{:~k3u,&#39;yiBgTHQ$
3/Y/	*lXb_TDIl-xBl){q|&#39;Hz}~v^#$JX	EhyK#gB9v]r&gt;hp=#_7ot}`.wql3#Z{g&amp;tb%JGK(i$Sx&lt;	VWhqN9&quot;in^&gt;\9C|sg._0&#39;
mZ&lt;H !UE	qKz4F![fxId@V\v&#39;i/MD9&amp;!9uNV{Mt:v9Pu{zZmOS9[W?&lt;GHzudl^W)3/,oiXc_&amp;[W&gt;ss^A,[tvhR.U&#39;o{&gt;9;0W{9&amp;E1S&lt;^3r3Ku(;[qVIAN*_dEEs}M8ppiZsQgr77D]voMC$4}kd-b~|)4?__=M&lt;QZ&#39;R183Yn~Bmmb;q&amp;Al$E4A^$	LgkQ3r/yK_iswZ7xiOneD?eJ/ U.&#39;_&gt;(|?&lt;(TBe%UUUwJ{=s&amp;~YzN].:o%o2%Mg6Jtt&gt;~YzgRSkYvB[tHC4_9bI\3/P&amp;JT={	2Q_Bq4&amp;29fStIgc:{pa_BvhC?W?(H!mN=zo/Z0I7\Nv!sxAqqhNqdO2}I61z&gt;Z5t[o{8O3m$6&lt;}&amp;QWmgvNg]e&amp;+==L,P?@KnFu?p?_W;Drb%=%Ls(|JO?Bn)*_fb#}&lt;&quot;
+GrEg}sDI[:}%J*3G?=^?`R&#39;j=x?L&amp;	R
KM`{=2@|eO-v4S]nnVqql&quot;KS&gt;)dJmAB~iB[jVMk*_,L=Q]}(PL*OVUwQ{_|?&lt;6-)_%_o)?&quot;f? O	vTH+t9Lk%*_|3~&gt;E+r&#39;^2*{vg.PqG. @f	\QzZcHc_7nf!2l.#4aH#! eO/!)B6uivsMWTvl      %&amp;pG&gt;1z&#39;Mi?}%/      i}U@kruE&#39;      &quot;lHP$M(st:D5aUW?R|%/t::X9G -p|*eHJF4!3tBS;Nls&lt;jBZQ,52:uBIsrc-&gt;m9f$  JI2&quot;dJYFr&amp;$wRMn?qt9	jEufhs::s?   d8|!S}i&amp;C5]2Y;v5pk[ntTmJTOWB&#39;^h=YRKCAu,B@ @@#IX2(dVxs;5~kG=A:MG)&gt;,=KN{NV!wS?I5zuO44
(xM0 @	@M#6(a_S2+9Ik:ka &amp;&gt;ZNtSQC6nm;&quot;HxG (B&amp;GwA4&lt;QCtG_wUPh,tD7YPB(jH4LBXG$4XzL&lt;G@ @ h
22sF
o=\Y!JiC7.Uk^|TH;&gt;|(tCD5&lt;r46M\wG?LO~\	eY-7vBt-C6M&lt;n?s^W M&lt;&quot;n   ZfdP	oVn)tSo?L54bNRGw7&lt;5/@1]m1NG;txDv4qN-\w#0F8%ZHqImnmfO_&lt;%Vsj&amp;U5{Uz`2?f/[]]TJ5?n[=_8giq:;ia@ bN@&amp;rS	 }kvc{OoG&#39;TMU!?Ts{7uW[KCf&amp;|]x==[S[,mm8	iWR{7}\C_xcQZI&amp;~1e&amp;;#~N&quot;3VqI9bK@ ~Q% Kd K&gt;{oo4F2(Nzihn?z=(He}}&gt;UWvSu=nBWl9I$M*U[;x4C]DG)_t/?|&amp;vF.~e$jCl?nQZ?L~$J^au[w8N?o3tX._]{RcyueTCOpS~Fo_4i]5?eQ&amp;yHw=wVzV	a[}m&gt;nP&amp;a%8s?[rL4kn?N&amp;6Y-eyF8PiNh*g_2#&#39;7==Q/rK GK{]967i~ko{	}KjO=s&quot;uV()$HBiVkRx^opE.	C?dnZ;?fxy}74POa7oss&amp;kl(ML MB3K/Mn-jM),s)RBa ]iHpCo_6LEw\as;{C&gt;&#39;;/&quot;X&quot;N ~W~&gt;	R$d69/H-u/24hbe	i1Kzv5Yy8b/v4?p#(G;gU(*&gt;g$Uat/	S&#39;TO.^oUy_.J(^[U}jBj=jcOnny:^*Ie~lmus,=68|*3Si bpo`2Qw^{a3wNE&amp;gx5aEG|oaz&quot;_zH2VZ	]pq;8V^wqu6Q97wZf,3	th	@-4`oxu:yhV!GO]@dPw{&quot;[=`M!S{3^&lt;@f2zY:|\kt&gt;zi-u=@0*Iu5:s\7rM`E&gt;Cm]k}
o+kz7o:7`&gt;KWk-&#39;0d9t\hM{ikh-TO-o//xUxaf|~^sBa.4_~*Lj$Qs\9Jouxsxww	%3I*4uk\&amp;%C94)[tVKV*y+
/Nzx+0gVdagG)qYu(Kkbe$A  &amp;vK81=to:T2K6g^Y3=W]KthCz-#}{O&gt;q&gt;NJLi
15~1hJASoyCB]I2yk;LN5&lt;fsmjb=nu\{CfT2iw7J&amp;_hLV5[ZF]WJ3o7*@c&amp;-+6\O/ogr/xMJ6KeAxK.xVS#r`5mFA?P6S4$\C,gU34) i/&#39;t|- [LTi{|KQyMT7Ih?p$ _Oy+5d(4xIs&amp;dP1x&amp;}2d9F4j&gt;eI._&amp;.t5wVyozp^{M^%t\Kut[n&#39;][_)7IMHk{:F&gt;}zmTOkDBT~\O`
?^X[FT2D#M	L3yw*)3FM50p,AVVPeD0I&lt;fp7J( q	v/1}c/H$!] _ADkOQzh4q1%_n{Fm?t2+9|&gt;q[G_t fc@BAqCf_KU,_l?GVb6U}]x,&amp;IV~kb&amp;~=,?n}UwN)st#m?&amp;/&amp;`kgxkdqTC4V{WUwLxuajsg|LB~;;^R?\~OSp,4qV&amp;I]	(cn&amp;SUm41O&lt;S/ki&quot;ELRFP&gt;4Ljwir.e_;rz=0cufxJ2	i&quot;ToW8KW9f^7xuCb1^lK[Mn)H!(jk2O%ov-eVr~Xo.?&gt;&gt;J[HEYZSTCQgR^zmZ
e7&gt;_?pCPHe7&gt;W|;}N*VN9N-6#]4&amp;nLVabX4L=L&quot;[df
U4+	ai)v&amp;r8#5;7DKhee{@2~_/	FjS}$Bf7g-&#39;/(/wM9z0g(%CS&quot;.p/SmUwOY7{4B[tnH_X&amp;aO#K[GhoZQz}2ORCN8f[ZjWgiV;J52cKlK:lNn{ZCTx}uY]zt!bGNt-yeTs{K6y3gR?_uM/./i60;&gt;MX(r`B^~`ykYGjP	qG4O=eKlFSj,
B
5-200b&amp;`qlN,sJqSdPV\1p`Z:v|?2~3x]qF(`f|-&amp;mqbpu~r4ih9Ecg.W.k8&lt;!Q$l-g&gt;5Z3SLoy[^~&gt;#?o;5,Buq;gO`e_V5/hB%&amp;
buh
au	]D7p$AL&#39;^Vjb}?jLScYlZ3X^!9 p*~,o@B`#&amp;I} @n^3f@
o,io;r[
iU7q&amp;irK9_zLt3!]&#39;sv&amp;
q	&amp;ID:pLK-g\DG,	w:s(=cKZy%RFg?_S0pF]._[v#go|ioWo:G+QxGx@-ELs&quot;Us:T{Y?%_~F^~:8@i=%2+9|=[)b7&#39;.Wj)K9_+_|/wM=E|929oyMW	j&lt;}-g;Del{K~!3}&#39;_p]N~!z]c	_,\/Hy|WdsXz{XS|	 ?%$=&quot;*V!&#39; @u2+9|&amp;OWsm=oRHL}{`|PK?b2
t\IU&amp;t4ih&amp;EsAgKtji`GwS[?vNK
m4BQZ6VyYvm|8fx]4 b|)S|lK4	g@j@M8YS#?:%lbY@	l._.mj&gt;o&amp;kORCdk7KGVA#(;iB4wRF#By[!$MR3!   ;494&amp;Bf7g\DIxi2?!,;Uuk};	bns_SF#Bw&gt;.9b=xMb$B   4P&lt;,HlJ
o2Cj&gt;4yh^
;JDI-];Vllq+PGb)j.eM]Z&#39;jQ[#Hj^4@ RIjoYUupb(fE7`_&amp;4zzh/N7.&gt;cB&amp;vF5+&gt;Um5x|v&lt;xv!MR9Q  i&quot;Hd8~dYv%151bM%=-][;mo~tOK+\jBZQ,5UmZ[5v1Jg:rjXj45,^}	@ @ V5t][6&quot;Sd$(b$n6&amp;Xkj-4cJ{tQ|F2j&gt;S|r^=Ym|d\Bmj&gt;E?MlC$DdIOqY|V#sf`?eo]!&lt;n$/vK#xXZMGiid@ @ @ B!fY$Mxn$   (6&amp;tk|TiH7   #@[T EVonlpM`	EF  `	&amp;N7W&amp;k]H      }0V`!in  J`0Qp&amp;IQ&gt; @l,YNbmI&amp;+t_9jeg4%L_Kq     2F}+UV{&amp;;DIZJ]s:A @ @ ~T&amp;CjHh:kO_&gt;OR`SXeC%Hfs  w,el,K	Z:3&amp;p^~x&#39;(q5p{%[~u(unK97,4Se#C	 @xv2Rf3tdX:Igoi4)lo:kO$8~;\l~}e#_&gt;#4pq&gt;NZ,MRaq@ @ m2*`&#39;qPa`&#39;;+$+xx.]xW~o|&#39;V~V~J	Q1y@4Oj7r.=N|_    ;
8b4upn{}zA,N5^KsZXL9@3V-d	INk=/nT7;oN&amp;gz~(R.A4$/6]KmRR+P&#39;\S(JQ   V#Bf0fGty5KT6Wgf?b1F!Kb-u#T_OA!!V-m3h8t2ws|d77aQ)[W*rE\ct	]    A	5rM$M&lt;c[t8bBCdbg-4P9J&amp;n%;4CeFqdI.1Is	0&gt;&gt;*MR	tV.Pl0a(j  $52*,tzA^+#ib`xS_:;[dk25yd^VQrt7-7(]&quot;aIX&amp;\vWx_#%v4gTkNa5JTdC6  X(,nTlfJ&#39;,MD#L4R5
1Yg^,5&gt;
zHkKX
!M(Vm:;#8&quot;d1AsUZ+j7[(  O?me2p]jk1b:-b^mNV?jX8&amp;3Yg`&amp;i3zZ9@5z=49)=QxXX:RD  -e6&#39;T5),r=}|#?z4NTq&quot;  J`2[POc\kO8Ux6   m?S	+y4C&lt;k,d  tuXsz  ]-1I!X&lt;i  C`cse&amp;tdbMdF  H{S6GxxnC5A  X	dmy0X&lt;x      K`S)1lN1l	     &amp;	@ @ @ JF@55H       P2i[zB       @5[@ @ @ F&lt;`!@ @ @ @ MbKyq-  &#39;L@   7tOZ  @`Ntb:    0i     #&amp;1      4  Ay=Gl]Mg@ @ @ @D?/    &amp;tb*&amp;@ @ @ D:I&#39;V     PJj8		  @`0&amp;t@ @ @ bD a1tZ     OaH   yMIf^Q+  (%(y;H      Y#P~+tv&#39;^   &quot;4ydnC+XF=      $P4_9reqkb&lt;  @	~QAQnTi.   O :in&amp;     &amp;$  H(b@ @ @@    In4   		  @@f@)   @@    In2   		  @@f@)   @@   @vISm~M/n]]qiE~l   Lu*h$/$h_[[}iEbJV&gt;ekZzI$g|m/J_p)[i!M M. `NGsV\+}^$M+;	I$&#39; d}umm8i7B]9KWkBsgYz,~,^   I#oO}&amp;)^`Nz%_YDdILVFuiX]~74JKqUL6sufcCt  I$/~fi&quot;T:4=[hX9J5Go4qN`9iR.n1jL{Ge  $ &amp;[.aY?KpEDD	iBw3.Ms&amp;dUZn@{Ch&#39;.&gt;3&amp;/4Wo./Wx9   J9!\R	?7!4vkm7.&#39;In4-ep1icl&gt;GwYv-  JvZe:[bM
y{4- %)WAf (;q#$FM4\*
rJN&gt;W}u&gt;
   # \ M$&#39;tL3.&amp;hD)*Lx9i/&amp;cPk
iUDN 0Ac0KcQnUW:}MFh%Y^8W{ !`A+1&amp;&gt;&quot;ok%\zX)&quot;5s`G.kYLaK_3  lk-Y5MpZ[*r3pabv	      &amp;P`+t|Ew41XkBY1L  &amp;^1QI&amp;j{iR#QA @ RD}N&gt;&gt;@5)e5CP&gt;wt=	%  $@!B[w`+	_C&quot;n	I(K  &quot;	)L%R     y&amp;&amp;      1&quot; i   		  @@f@)   @_tw.NJx@ @ @ MR%M4d|k5TK(*    )&amp;&amp;(BCd@cA @ B $)anR   IIPI?$h  @)	@$JXd
Z    )&amp; iw(EW=Z6!_9  !$ib5#V$-,eeH&quot;?  	kEu.&lt;jj:[Lk
n Q&#39;.&amp;Vg     .%$&lt; M? n&lt;     WW&quot;V%\^,myY     )&#39;K/#JH-JLt.F   IPY+Ebkl:Z@ @ E MI9d
59A-J#ZjG  @	@&amp;$&amp;\J	T	2@ @x&amp;~VbJm:I-aC@ @# i&quot;mf2d@a  +H9i&gt;N.9tqo,  }.D^J(  @xWmK22&gt;AW8 C $=	(&lt;TFX HiBn
NN@ @ JB D$MK:ZI    $ i&quot;&amp;5;    E4tW\:TW!^@ @ x&amp;f3btaxN2j	@ @ 2&amp;4q$X)CW  D@ D&amp;%:X 8@ A D5!.KrViN*7`On@*@0i
*    f&amp;KwW.|ZV@ @ 4q+M$u	y2  84qAKqR     @&gt;B__ty`0q d@	 B@:R  #ei&quot;Z&quot;:&quot;t Ja~C:YAqOA JH D2ja(3&gt;P   &gt;&amp;QNjF @*dSewNI
Z  &quot;=i81gLE/
Ksq @eLapDAe @	dO%F8, T4Axf{3`r   |&amp;%p8.  &#39;%i3Y:T:XE\[ HLIa lbnUVvp@ @ dIfs5zegF  ?2#MkK)g\@ RA ;65%)j\@ O 39e)#|\@ F D&lt;}EzC)dNK)Wb{u.g*yvcd (	H)Y84Ad
O{B$I*o+]&amp;yl&quot;s\}^^R{s#C@y&gt; E t/i6~$NiR&lt;C 1&quot;iz;es:u	S*&gt;IQ4zMQw4	1&lt;F,F8ToT)S-/&amp;%&amp; &quot;,H&amp;Ys7RCxiR&#39;:^RE $TZpXW	@HUR&gt;4&quot;Ii~(D2\lOhUX8NrkMZ9fmr}&gt;nQlAvB9DD{oc/}&quot;H4	q\&lt;M#eigw,cul:&amp;/GN`QgJ&#39;&amp;nA,!48hKb	dOzY^&quot;a?iGdt;$gY]m&amp;J$8[o+-^pbR&amp;&gt;6wE4C OmQQN/im|=3&amp;/dHrvx-ZxZ#[gpQJn&quot;rXBUs=&lt;4$2(Mg/M&quot;PV)STaKi/lO,m~bh=V[{/&#39;`H48ICH^jO6p0N)!H{=-&quot;,lR f5&lt;+^T&gt;C#+K&quot;^Q4Vj}^,CxNX3XDr[Q$MduYJzXC1
L02PzB+$ i\&amp;&lt;D^HWS}jkMC4b=&lt;i&quot;5=AJ	IFWH $ 8HB&amp;&amp;R{B+ak(lfBbD&amp;.lmc9	
&amp;i&quot;&#39;zB+$ i\@Hi&quot; qj#M1}c6&amp;8-tyg&amp;+&amp;l/,&gt;&quot;n24kIFWH $G&#39;B$P4)n_O/rmB Mm}UR&quot;WL	I,
@XibtTnR^9c-Yw%#(;tS5}IT*=JkRhib6ji&quot;SNWX*,zG:45)YO_=NK: .6i&amp;m4)k&#39;.^%7^+4]!C#!tHp~I8WTK&gt;2/MBG&quot;Vuq[Q4/NbEfz7#]ErxRz-cG32W/6]txT0V	&#39;{/0@ MBX$irvEJ,r\[&quot;:)+
Oi&quot;BIOyi 6I5k,v@@@H`LQ4o[Jf\6&#39;?i&quot;
F6G$i].(~C&#39;	nxt}tY87&amp; IisC&quot;:b~moX-Fa}{MDs/G(MHvjP44)!y{w
OfpmKnLG\x8	!/p+&amp;BP%@WpBG&lt;7v4b\AiR\!G M.c/MQoY&#39;hLU&#39;5\*E&gt;z
kp9OE\#s5q +I duI-&#39;F-4	u-sAA-^&amp;[|F`&lt;&amp;
 WL{XZe&amp;l|_0H@y	dOPf3mfdm2E! $@	xz ~HbZ YP   g&amp;4, M&lt;|o @	d@`&amp;C+&lt;oG ;,HDG&lt;&#39;,e,NH,LJD
WI	V&gt;KrYn(.
  4AI4?a*n l4.A$l4R)B#p?W @9dC`*}$S M~P HH[$,MJA94)Zo:.  dD6^NhS$t@ @ I!M`N9eK @dG`N|9I@ ]-M0P,t|	   L&amp;9q	 H,LIc 4!3Yb3@ @ 2&amp;M&gt;2o]b6&#39;FYpQ 4`h	\&amp;P!    	dL8q:&quot;@ dPq
`$ $44U2Y    )M84W 44qr`pHxD%A @2+MgG+K@ @ dU8:NYKp*{=ih) M aGbmv~@ @ 2,M&#39;xlS9qrD!(b_q

@ JM l-?N4P(NS9e_0
v o-AGr  Y%yihPG&amp;
5~r
A eZHk$Fl	  ~@NDHH*dKO4Rf   j&amp;L8 $;J/J P&lt;2 @ &amp;cBbuIi9;&#39;w{xL;{J=P  	gwN|8RV	-|++WBf 41bgu%32!5%5 4VFQ],	SXd}@ RG DHuK%&lt;OI d H[wYbUuRdg  )&quot; iCLAq%nu( Bo	  q&quot; i25d8%(nG.A @@ +)g&quot;?Q8P!   |&amp;&quot;eOnMI`GR~RN $ 4Q&lt;KUS9(.5  y&amp;r[}K%}r%l   ?&amp;~LN6V&gt;$=/
  MHw@i#v-VKkYmE.Nyh d I ;mML%4R	9p**qDH4O+*
Su\^Z.r9zaEMqiKOau5IQRI&#39;s[U8{pu(	giI]P9M$CO	{o)Wrx.r&gt;,Xp@&lt;	D`_
CERH&quot;(&gt;J4
)p}b4]Cc&#39; &amp;uQKjOu)tMQ$*Jh2BY	IBo&amp;/&#39;~21|fT[b8`QkgW}04)D
	8CGV~JalDpRLiIo)r@f	8I-:K.IuZ^HV0iiGN M JQNTs@!C!MS!DH70Xk^h2b?Q_TwX}
$libqZe*nI|q&gt;}cu.FXmB0l 8bKYbcUo?:994fd1fjL6)SV&amp;Q.&amp;)dAM $Izt8A q:9psH
&gt;[D!@uN+Cdc!MJbOD$YbHa(Tzg?Pa DN$TM(&amp;9N0c&quot;&amp;uD[^gEbD&lt;}$DJ@ka.!G
x54+$bU}RhDU&gt;n]	  gN+t2;cM[nkbW^sXV6gi1o
KJR@Y8kB_~d&amp;@BDpHt_$G+p|$T4I~ ,_ MRKpW%
FBBIq,	r^{k X8ttq4IaMI:.Zm-he44,DBdE4XHHfY&amp;x	A @ 
 MbC #Hp p% i
i&gt;    44ojFxM0 @&amp;?Gy*)B6@ A8$PH4mHt9@ &quot;&amp;xL	X&amp;&amp;p= @	$@W@@||Sci#I@ @ 	FK,1(*	 H(:GrLG!#@@&amp;&amp;)$`&amp;dyNv.I &quot;HTY{FkII I $$]Qw9t D4IaNt)-A&quot;P
H(HHK\xa  4IaNL)4-]U 8&amp;&amp;$`7I&amp;e*~	@0/HA@fsW&quot; HHHG*q@ x&amp;59$
  &amp;#  6ILR@ k	#Y=&amp;	\&amp;h8d 	I	qIFg2K $9oq:V$yr
@ @@q4C0 4Ia
8lh5hNj+b!A V!M M2A@A%.5?[@  M`uU+9=p$  ~	@@d@|*wA~ 4a@#tB8$LB @1 M M2DiZ&#39;nI$kaQ12H,wtW&#39;%  &#39; ii9n%._&#39;&amp; )HHSR
ar7QO 44()PB{M/I x4aYP~MS-(;d  %&amp; iiiDsZ,]%IDlV[HMN:M[%0oX\.IY7Cs@ 	d\4TOLjr.Ku9D+Vzt|{:Q|~(,o
d  $ iI~M8}4a&#39;/40JRq47&amp;&quot;/GI*&#39;a
5RA H D+.5:PW^+B&amp;u9VlRIw.{t4+&gt;7e@ O D&amp;a#Wc-i&amp;M|*&quot;n&amp;^n4i&amp;ANv~8?yV	w
?fw2y%&#39;7UJ#k2YK8NbI`O2j Pz&amp;4F6vN5~kEf!V]ip.(A3QIOsR\G	q(`^&quot;8KCr	DdJ ;eZKE	$M JJ?  &#39; i7M6Iw04)
:hHD0A30W%[e&gt;vik	9l4\NR
$U&amp;4|W:jNXusc&amp;hR+Z[z,=4&quot;  !McIl&amp;L13s(4_!b1MCv@NA rGi4syz:*$U%2v4@R@	@7&lt;(NNbBC5&gt;)K~yibZ\0z
Q%0xS$`KI!5	B-kv2   &amp;i&amp;GYf,)M[#f(JKfm*Sw%#M9	&amp;b) MD0&amp;  +&amp;`D_&quot;-,[+9PWwSx4N+DH^=\+  p@fr93XE{R6!$q_#%1A(O{7aHJB&amp;BqT@ E &amp;;Vm&amp;)Y:yYl$0OV^cjtHc	(:qbhZe2PKwm\@ &amp; ib)Hf&amp;MQ/z5)A;q.(^&quot;5c=Jg$&quot;M,QzM#nw9v	?
 @@&amp;V&gt;`M90&amp;U{puX@-|$De7U/U\VpdV96khA @ $&amp;],/&quot;;xw@ @ I Mt-Y MWA @  M2qSi MWA @  M2q!MRA }@ 2A $@ @ B @ @ @ F Mbt3gQO   		  @@fD@Q2  $ 		  @@f$E     HH   4Nd  H
HH   4HE=A @ @ :&amp;&amp;      1&quot; iE     &amp;&amp;      1&quot; i=z  @t M M@ @ @ bD $F7#:A @ @ ) M|HV.os]}k=~k]7sQ2yV]{	5K+*Q\Xfmm}*G&gt;&lt;|C&quot;jTDJ60pV.G#0 &#39;J&amp;r]Y7&amp;iuF	Y&amp; Ljjqer:$VE&quot;M+jC+%u9WLIuRt|FR+{1VC[YM$7|GV M&lt;omS!}J	f,&quot;i?5yvT&lt;:T[gdTUitKd#ee56`,k[ufuN(&lt;Y(=3=D|_w-&lt;VBM8WXX^LVx
@1T:jt/m@2JH2F:S,CnsH+^QN!VV|X_PQgwS|8%Gn?#57h_^&#39;tF\+^a:sS^5@.$EmEEWxP*sCR4&quot;# M#$6c-(D?2H&quot;~tQNek^a&amp;M@lKp4g2t@[LtQ00i4U.&quot;UW(oib4=5
3T9kS~yep&amp;FsLgu]GuZivf?R}{.1&amp; i}m%guH	2cs.M=vmHjhpmk/J|&#39;2kWWW_WO8:{v!akI@g~^SJE((N_V*C\0K3W;
}4dv-NxvKAX;&quot;-ejID4;T5QZJEd(Xk&amp;B&amp;5PeReC}&quot;)H.A0&lt;Vwe9pw\\@@pN&gt;j%&amp;6fvn/WiQ\Xv_{ZX%8H	@x :DEeyvF&amp;Y(qBG:09K$1wcppyyP6}[WkW W7rM7N&lt;=rG!M~4~@X50c(s^J,M[g&#39;vX%e-\sEX(&#39;A&lt;&quot;Mu~HEj_?u.&lt;jj:\z*KW5qtTxD	Sx:JJ}HLh4Zx%?iTbBO^]jibD+V4&gt;s=&amp;/E9Q/A?VgBIY-SR,MX&lt;lq2q$ytLArlxpq&lt;O};Z\q7o(CZs&lt;os4!u&amp;@}&amp;tjUs7~rC&amp;tw0S3(P[zPHb&amp;LdFI4q
0vwrq~9l:FPVla-$uuwksY~&gt;CoTQfLBo&amp;I$9 &amp;+njh&#39;ytql!?kThu&lt;]^&amp;lO(aM ZS&#39;8S=N)4K^!OLmXiaQvfcVdD2^R|}w*r+iR(%&gt;&quot;-&amp;NEyn|b&gt;;p2QmVQ&#39;^Ohw[n~$@QFLA~&amp;O
Xm*E?G F^rGjfh`*4fMfjEdptQ+^!&lt;W
K71`iva=G/[u&#39;G3):W(s77J@	QS^E(I&amp;&lt;&amp;l4yn*9@^Mc;W)U&amp;.#n{Ocu4?\
E~f--BsxK&amp;r8{|-weK3rE3s0r&gt;5D vS )&#39;FAW(5w#QD4Cz-2t?`[zqiM_CCI]8lHI+pSp-=U&#39;|%xpR$Fqv4H.-JK	HK4!%t5qq&#39;&amp;)c`&lt;].H&lt;~O%Ed\s(P]L/8@kR5pO	e	N$~@ @ @@K\= /M4&quot;
]?@ @ 2@ j]B4qp@d;z\d  H7.)&gt;N,4HH  H5`^c0$1/h &#39;&quot;	i]Yp?ga|&amp;~_[b1mUe\DXCj5-XX[   uQ(N#M4avbauY&amp;B&quot;I\\@	XUT5a%+PuP9T]^EkI]t796]I)iaj2E&gt;uQs$A_.LI1!`yM=}#r@)&#39;xMbK-|bJk$,I&amp;#dG echR.MQlW&#39;J.q]Y(ZX1&amp;(=n	}L&amp;KCA,zFOq{6?|i3gQB}r;FRT1j$tN3q@LGu*&#39;}\$#v_qe_=(SK5h4Y35`VS=j6L7x&amp;jnv\g&lt;&#39;lRI`M]k4q$Vne S6I&#39;hVcZ9iUD&lt;$G2uIajI&amp;&amp;P! 3yAm&gt;4X?0:[&amp;qJ$b*Y7{f?^r!M:JA~o\ H?[=2\)70T#(5Pr:2^Ih#dL5mP5AI|&amp;MlN:0j 5U~mEo7cvibYlw8gP}j5-
}$2~#Db4#9&gt;@{;Y$`ud*Hg&amp;z|IS%qBh4H&gt;vIiB @4K)X&gt;#9~0DxMD6w)HnGj)|$@xIr M$oYy0ErNu=U#ux_&amp;SD\k*M
Tkdo\&quot;%PF	&amp;2a+~s9%D[Hl&amp;?9k^XIb$Vas0/i7?Qp1mX]:|&#39;yeiBaF8n[)	&#39;MN&lt; P:2D[	I&amp;OqN!O	wRgI9]at
;&amp;M0!#y(h%-M5^mth)!&amp; DE-=yP&quot;G&#39;q*bD[(5ND&#39;^\&amp;]I.&#39;
3Y2sy8D[m&quot;XK=RZ`^:{.E22 a4U41s5 C%^ybr$s7X}XZx&amp;t,+Im^U}:1(v$pyXp#w51-u&#39;7sdR&#39;tljk!,#2bBG^-A	xXv%y@O#&amp;L_z!6U2u{
_#	 Pfe4)s	g=&amp;&amp;r^17 P~e4)&#39;6g93Cr&quot;4B#6K;  K$MJ6&amp;	@ @ 2B&amp;@   \j#A @ @ q}@ @ @@#K=@ @ @54kSA=!@ @ @ 2^@+	 8F	&lt;x      zB,[c_E   8l	z$   V8G
akN4@ @\0Xt  liX.   6R&#39;UEe@ @ RL$MNA@@ @ bE [`z   6_,&amp;+   #HXHH   &amp;wRiRe(  x#a]=		  @@4Aw  )s:%_Bi     `&quot;P9HtG   4Aw  p&amp;%4Aw  aK@ @ @&amp;Mt@;   X&#39;%S&#39;&amp;      &quot;ibqjsXHtG   18N MA @ @ 	{L@;   8qRaC&amp;.w=G?nWee%UUU6ttW|&amp;x*TQf$   R(qd|MI7  ;KI;)MT]i]    &amp;, %&quot;W4u	IcD=  $@I`iHH  (&amp;f]i,u  DD ju@WKLi=`#(@ @ bH@N(dq8&#39;YR*y,aA@ @ @ &quot;wb_4HD%C~%X&lt;9  ~&#39;R2D,tIIm|T=ZyUVOn]7R{MAT|1
 krW!C_J%&#39;N(nS&amp;qwMEXa4!R][,.mWQ1N3%(J|0~d=OzTF7S8yP;Q$6O[gY\w3)YTmYyZBHvEUpY*LH;l P&amp;&gt;q(E(2s=4Q&quot;&quot;^?i{b4Z_orI&quot;^#biB}K2=&#39;:Y27&lt;P 	i:g@1JB_TLMW2E
/~4an[KI8i7WmIb.]Onz^,;pX{F9
$|4Z7A)i4dSoc&amp;0_*nic
5U0K};QL)5YoGI`|[Cq:U1cB&#39;{F:cxu(EtiR68D&quot; Mxa&amp;+N&amp;t,S&#39;4@VM-Udvp ]h&gt;r$CdjSc|!M&lt;/GH(ISN{gY_S&lt;f3(M)aNE\G*tb9sI&amp;,0%M$I	&amp;&amp;4G;19:@Mp&gt;	^&quot;U_mN9tj+r#)jNj4\Q&#39;]h7RsvaUfOD&lt;?LqwSy:Y!bd{9OQQ(rcF8lR&gt;cZCk&amp;F`NS29J~=3{YB2a&amp;n8&amp;&quot;ir6oEKpr$~u%Lg
9N41(tR&quot;&amp;!L6;d)DoWdda%gcbM(a,xM.#dD5)4K3$ibKYegq6o	PS&quot;7J8%kbiMoa#f`$DGtQ-a{Mq3__wFx^3C^w]F*tCXz)I#2=@l&amp;!Y)M%9LRHk;Y5SgKOCi!q-JBZD:,m[a[dUIH!MRf8	@x/t!CFcS9	
z+3y-U|XS1- 2)j`t5X?&lt;co0e&amp;t&lt;473`:UXz1&lt;DmP&gt; 4qX@/%M)gN4.V41TzMSBHb`_1b&quot;h+bll}Mn1-CI2HNhA*Fhg$9,t	+i%X[v2J&#39; iR4D$81E&amp;&#39;#%RfmsE&lt;M
)Sv-ivGZY/]X.d`&lt;r%D=Q0ee M&amp;XYi$,H,fVi6xMMV|K$/{.{9ndQ/~lBUY&amp;iI$rN.-uW)o]?\Xo
WGD1NPkT-$R]hA [/.q	SXq)8e    +}9$%N	&#39;iLTA5
IL:&#39; iR@/%	8lcy&lt;B6h @ MB#[(&lt;/\z  # iiKf}
3{ct&quot;8*	4,{PZ%#te(S&amp; _&amp;^A *&gt;Vf^AN  I $*$y-K|Zo PF&amp;&amp; &gt;IM I/\@  M0G$%F##*JlbnMK+Vw_nY`rF@  Mba XX]}ISoLFb(4U&#39;I&amp;w(@A D&amp;&amp;.&amp;fK5)=`u&amp;2 jkb	I.! iRasl${DZ$LL  C $&quot;A}_Q@&#39;-5)piX2y8&lt;3E!&gt;nsfJ#&lt;w5rs7m{3ROh?hiqm2gs I 4z&lt;hU&amp;Wka3Y_TsK9&lt;39dJkj&gt;VM;Fr$e[t%Qr+(I:3=7~%N9iU&lt;  Y&#39; iXX&amp;q^Tnb~KiiA?WWSsZrm5&#39;K}bFmv&quot;@l37p84-20DmtX}SR&amp;q	9$@	@d&amp;W&amp;|36A`&amp;5/vs0Xc:U9^L_eI1!FgJ~R{&gt;W2kM	x$A N $= 4	Lo&amp;lm`0EW8+\&gt;xd`qLB&gt;BD&amp;tk{pG= M&amp;Moyy=mG#	 u&amp;Y.+M[`)q-FDB@brbUcL]q:VG6&#39;4	al4gXOh`X_e.p1=&amp;0?&#39;%M\&gt;&amp;to1tpLIyIPc  &amp;	_N,S+]Na`!`a-T$nWC|$,&amp;}Ixk-j4S^mth}M15fk1
Qa 	@49Q9Dx0~j~Wst-K-dL)u8L|uXKF(ut8&lt;Kes 44I@I|*DT4!#w&#39;SA3^,L?c#p Uk&quot;_ecr&#39;7sCPe594Jrg2}&gt;6ZY  i!5 c7
5.*`d%\u(5HR/i+lV}6G?qia6uH9VGiQ,@@$n%_DJu3_2]&amp;Z qNISD  /&amp;A	x*:tFA7%&gt;+PryL &amp;P@  i r\~l9Sb{P1HHuV$CMnej&amp;C	y@ 	@@@&amp;O`
rE
n&quot; &quot; i,2e! {\XK)@ F lbPq`&#39; &amp;&amp; 4R	F!`N@ B$ i,xPTB	O8-,IhGA M M@7X,H24 oN% i&quot;/M\7  &amp;  v12W!?@	@6K1h\6&amp;x4@ &quot; ii	@kr@  M|%t#aH&lt;  44&amp;OnF 5&amp;Rk&#39;	xM\ DG |44nPF  &amp;:@@)  		&amp; ib\|8%  o~F&quot;`- WAf w&amp;&amp;  #H4  !4	bB(*&amp;i2qpfMhFA  M M@ iu T4	bR(_u*|ud@I:}	 %od &amp;. =o3@d^ P&amp;2!R
f1v# ii	We{F$H(H&lt; DF6t084	h|SQpdu@ M M@ 8f`\F $YZ_A{MRi  		&#39;6H{ l6&quot;Q,d Ip3d  Q44dqVG=| F (nt\ C %BHY&lt;g{p. @k@qxXWj)\&amp;x&quot;@ $ ii!t$q&gt;*RE82E $:p_u} Pv&amp;&amp; OQH:j &lt;   P4HpR5&amp;*NwP HHg(F.E)  0&amp;a%*R&#39;kz)@	@@@d%$ If)YLIbK&quot;(@ 		DB@&amp;$+eu	BLb 6HH1I6~E? 		DE@m-O`(FO	 HRD7&amp;/K_`RIg	uMEmA # iiN}%   HhRt%&#39;o_	RST@ :I&amp;F]Hh@aW&lt; (@}*#(@ 5&quot;}svUVV^RUU5|nMGw5-h*H jF!E2Bb*:@ &quot;t		H9!	$XDJ#}&lt;~/  4)fE9lpiUhW)g@ B JIe@	%BN);(T @ 4k%&#39;8&lt;Bm.Pb  1! i,aF 	$ 44A@$| 	@g0 A)D	z @@@@xJnHB@ @ $&lt;#4A @  M M@ J%EV9/  B&amp;Q% `&#39;Mvoz   I&amp;&amp;      1&quot; i   		  @@f@)   @@    In2   		  @@f@)   @@  	 FcY(&amp;{  @mTHH  ^|	0Rie#  K v7lo*@@  D.VQN MBz   	Q&lt;Y 4Jb		 @P%@I@4	@&amp;f|BKA @@H~vj^0lDI4I  (F{}jcq`BLHH  ibJUaJ%L@:4~ c/6   FY5dQ8YLHpqBA RB&quot;
@nr/G:Z+	iR)@ Li{c//`z@  8aK0q6@DQ}O&#39; i @FHuV`N!InF&gt;h&amp;@Dd&amp;qEF$9ii   `&amp; K7aYdcc
i!	@ @@&#39; h M0$  HxydMQ&#39;)h4    qdA&gt;&lt;&#39;Nw!M0$  xm^I&#39;&gt;)m&quot;RT[HI   y.&lt;Ic)#&amp;7UaI	@ @ @ JF`$BHseg    @ BR$M`@ @ @ @dH~!)I_SO    @y	(:   @LMU    IENDB`</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload2</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP_2021_A05</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP_2017_A06</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to &#39;nosniff&#39;. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p>

<p>At &quot;High&quot; threshold this scan rule will not alert on client or server error responses.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (502 bytes)</summary>
				
				<pre><code>POST http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/upload.gtl
Content-Length: 25
Cookie: GRUYERE=; GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (25 bytes)</summary>
				
				<pre><code>upload_file=test_file.txt</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (242 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Type: text/html; charset=utf-8
Pragma: no-cache
X-Cloud-Trace-Context: 64b5600ff225fbd4e5fec8fa3344b8d5
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 224

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (224 bytes)</summary>
				
				<pre><code>
        &lt;HTML&gt;&lt;BODY&gt;
        &lt;H1 style=&quot;color:red&quot;&gt;Gruyere System Alert&lt;/H1&gt;
        &lt;TT style=&quot;font-size: 150%&quot;&gt;
        Exception: &#39;unicode&#39; object has no attribute &#39;filename&#39;
        &lt;/TT&gt;
        
        &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>X-Content-Type-Options</code></pre></td>
	</tr>
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to &#39;nosniff&#39; for all web pages.</p>

<p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				
				<li id="alerts--risk-1-confidence-1">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">Low</span>, <span>Confidence</span>=<span
							class="confidence-level">Low</span> <span>(3)</span>
					</h3>
					<ol>
						
						
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://google-gruyere.appspot.com</span> <span>(3)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-6">Timestamp Disclosure - Unix</a> <span>(3)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html">OWASP_2017_A03</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A timestamp was disclosed by the application/web server - Unix</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>26087470, which evaluates to: 1970-10-30 00:31:10</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/425450881661954264328804432207969818728
X-XSS-Protection: 0
X-Cloud-Trace-Context: dd487feea4901d73f1fdcf2a14bf1c0b
Date: Sun, 15 May 2022 13:19:59 GMT
Server: Google Frontend
Content-Length: 3841
Expires: Sun, 15 May 2022 13:19:59 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3841 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/425450881661954264328804432207969818728/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/425450881661954264328804432207969818728/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/425450881661954264328804432207969818728/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/425450881661954264328804432207969818728/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;425450881661954264328804432207969818728&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;







  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/425450881661954264328804432207969818728/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;


&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>26087470</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Manually confirm that the timestamp data is not sensitive, and that the data cannot be aggregated to disclose exploitable patterns.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html">OWASP_2017_A03</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A timestamp was disclosed by the application/web server - Unix</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>26087470, which evaluates to: 1970-10-30 00:31:10</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (430 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login?pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/login
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: cb805a8a9a771a6bd9832957669cc3a8
Date: Sun, 15 May 2022 13:20:06 GMT
Server: Google Frontend
Content-Length: 3839
Expires: Sun, 15 May 2022 13:20:06 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3839 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Home&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;script src=&quot;/582835734666354056417651491707595504272/lib.js&quot; text=&quot;text/javascript&quot;&gt;
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl&#39;&gt;My&amp;nbsp;Snippets&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newsnippet.gtl&#39;&gt;New&amp;nbsp;Snippet&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/upload.gtl&#39;&gt;Upload&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      &lt;span class=&#39;menu-user&#39;&gt;
        ZAP &amp;lt;ZAP&amp;gt;
      &lt;/span&gt;
      
      | &lt;a href=&#39;/582835734666354056417651491707595504272/editprofile.gtl&#39;&gt;Profile&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/logout&#39;&gt;Sign out&lt;/a&gt;
      
      
  &lt;/span&gt;
&lt;/div&gt;

&lt;div&gt;
&lt;h2 class=&#39;has-refresh&#39;&gt;Gruyere: Home&lt;/h2&gt;
&lt;div class=&#39;refresh&#39;&gt;&lt;a class=&#39;button&#39; onclick=&#39;_refreshHome(&quot;582835734666354056417651491707595504272&quot;)&#39; href=&#39;#&#39;&gt;Refresh&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#39;content&#39;&gt;
&lt;table width=&#39;100%&#39;&gt;

  &lt;tr&gt;&lt;td colspan=&#39;3&#39;&gt;&lt;b&gt;Most recent snippets:&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;






  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:blue&#39;&gt;Cheddar Mac&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;cheddar&#39;&gt;Gruyere is the cheesiest application on the web.&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=cheddar&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://images.google.com/?q=cheddar+cheese&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;



  &lt;tr&gt;
    &lt;td&gt;
     
    &lt;/td&gt;
    &lt;td&gt;
      &lt;b&gt;&lt;span style=&#39;color:red; text-decoration:underline&#39;&gt;Brie&lt;/span&gt;&lt;/b&gt;
    &lt;/td&gt;
    &lt;td width=&#39;100%&#39;&gt;&lt;span id=&#39;brie&#39;&gt;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;/span&gt;&lt;/span&gt;
    &lt;br&gt;
          &lt;a href=&#39;/582835734666354056417651491707595504272/snippets.gtl?uid=brie&#39;&gt;All snippets&lt;/a&gt;&amp;nbsp;
      &lt;a href=&#39;https://news.google.com/news/search?q=brie&#39;&gt;Homepage&lt;/a&gt;
    &lt;br&gt;
    &lt;br&gt;
    &lt;/td&gt;
  &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>26087470</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Manually confirm that the timestamp data is not sensitive, and that the data cannot be aggregated to disclose exploitable patterns.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html">OWASP_2017_A03</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>A timestamp was disclosed by the application/web server - Unix</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>26087470, which evaluates to: 1970-10-30 00:31:10</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (471 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;is_author=True&amp;pw=ZAP&amp;uid=ZAP HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/newaccount.gtl
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (378 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Content-type: text/html
Pragma: no-cache
Set-Cookie: GRUYERE=26087470|ZAP||author; path=/582835734666354056417651491707595504272
X-XSS-Protection: 0
X-Cloud-Trace-Context: 51f9d1fd2e5c757a866155237d8d93ca
Date: Sun, 15 May 2022 13:20:05 GMT
Server: Google Frontend
Content-Length: 2224
Expires: Sun, 15 May 2022 13:20:05 GMT

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (2224 bytes)</summary>
				
				<pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;!-- Copyright 2017 Google Inc. --&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Gruyere: Error&lt;/title&gt;
&lt;style&gt;
/* Copyright 2017 Google Inc. */

body, html, td, span, div, input, textarea {
  font-family: sans-serif;
  font-size: 14pt;
}

body {
  background: url(&#39;cheese.png&#39;) top center repeat;
  text-align: center;
  opacity: 0.80;
}

h2 {
  text-align: center;
  font-size: 30pt;
  font-weight: bold;
}

td {
  vertical-align: top;
  padding: 5px;
}

a, a:hover {
  text-decoration: underline;
  color: #0000bb;
}

a:visited {
  color: #bb0000;
}

a.button:visited {
  color: #0000bb;
}

.content {
  text-align: left;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
  background: #ffffcc;
  padding: 20px;
  border: 3px solid #ffb149;
}

.menu {
  text-align: left;
  padding: 10px 20px 35px 20px;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
  width: 90%;
  background: #ffffcc;
  border: 3px solid #ffb149;
}

.menu-user {
  color: #000000;
  font-weight: bold;
}

#menu-left {
  float: left;
}

#menu-left a, #menu-left a:hover, #menu-left a:visited {
  color: #000000;
}

#menu-right {
  float: right;
}

#menu-right a, #menu-right a:hover, #menu-right a:visited {
  color: #000000;
}

.message {
  width: 50%;
  color: #ff0000;
  background: #ffdddd;
  border: 2px solid #ff0000;
  border-radius: 1em;
  -moz-border-radius: 1em;
  padding: 10px;
  font-weight: bold;
  text-align: center;
  margin: auto;
  margin-top: 20px;
  margin-bottom: 20px;
}

input, textarea {
  background-color: #ffffff;
}

.refresh {
  float: center;
  width: 90%;
  text-align: right;
  margin: auto;
  padding-top: 0;
  padding-bottom: 2pt;
  margin-top: 0;
  margin-bottom: 0;
}

.h2-with-refresh {
  margin-bottom: 0;
}

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div class=&#39;menu&#39;&gt;
  &lt;span id=&#39;menu-left&#39;&gt;
    &lt;a href=&#39;/582835734666354056417651491707595504272/&#39;&gt;Home&lt;/a&gt;
      
  &lt;/span&gt;
  &lt;span id=&#39;menu-right&#39;&gt;
      
      
      &lt;a href=&#39;/582835734666354056417651491707595504272/login&#39;&gt;Sign in&lt;/a&gt;
      | &lt;a href=&#39;/582835734666354056417651491707595504272/newaccount.gtl&#39;&gt;Sign up&lt;/a&gt;
      
  &lt;/span&gt;
&lt;/div&gt;



&lt;div class=&#39;message&#39;&gt;Account created.&lt;/div&gt;


&lt;/body&gt;

&lt;/html&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>26087470</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Manually confirm that the timestamp data is not sensitive, and that the data cannot be aggregated to disclose exploitable patterns.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				  
				 
				
				
				
				
				
				
				<li id="alerts--risk-0-confidence-1">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">Informational</span>, <span>Confidence</span>=<span
							class="confidence-level">Low</span> <span>(14)</span>
					</h3>
					<ol>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">https://google-gruyere.appspot.com</span> <span>(6)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-8">Charset Mismatch (Header Versus Meta Content-Type Charset)</a> <span>(6)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (331 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/part5
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 33537749b2028b9bf13c22aa26ba5f2c
Date: Sun, 15 May 2022 13:20:01 GMT
Server: Google Frontend
Content-Length: 11506
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 68642faca77c3cd21d49dee4da457602
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 13686
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 29322522d1b968a3e70b385ad2b8830b
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 37564
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 7e436405686e8a47d09262828f9fddc8
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 29253
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1e89a569badcde4c8a34bb748c9e52ab
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 24149
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET https://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (332 bytes)</summary>
				
				<pre><code>GET https://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: https://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (417 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: e1de65e8de11ab80b5e5f9f018599f64
Date: Sun, 15 May 2022 13:20:04 GMT
Server: Google Frontend
Content-Length: 25303
Alt-Svc: h3=&quot;:443&quot;; ma=2592000,h3-29=&quot;:443&quot;; ma=2592000,h3-Q050=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000,quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://google-gruyere.appspot.com</span> <span>(8)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-8">Charset Mismatch (Header Versus Meta Content-Type Charset)</a> <span>(6)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (326 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/ HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/0
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 53e16cb763327c4aeefb0327df227823
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 11506

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (11506 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses &lt;!--PART#--&gt;&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;STYLE&gt;.column1 {display:none}&lt;/STYLE&gt;
&lt;BR&gt;&lt;P&gt;
&lt;H2&gt;&lt;A name=&quot;0__hackers&quot;&gt;&lt;/A&gt;Want to beat the hackers at their own game?&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;Learn how hackers find security vulnerabilities!
&lt;LI&gt;Learn how hackers exploit web applications!
&lt;LI&gt;Learn how to stop them!
&lt;/UL&gt;
&lt;/P&gt;
&lt;!--MARK-0--&gt;
&lt;P&gt;
This codelab shows how web application vulnerabilities can be
exploited and how to defend against these attacks. The best way to
learn things is by doing, so you&#39;ll get a chance to do some real
penetration testing, actually exploiting a real
application. Specifically, you&#39;ll learn the following:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; How an application can be attacked using common web security
vulnerabilities, like cross-site scripting vulnerabilities (XSS) and
cross-site request forgery (XSRF).
&lt;/LI&gt;
&lt;LI&gt; How to find, fix, and avoid these common vulnerabilities and
other bugs that have a security impact, such as denial-of-service,
information disclosure, or remote code execution.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
To get the most out of this lab, you should have some familiarity with
how a web application works (e.g., general knowledge of HTML,
templates, cookies, AJAX, etc.).
&lt;/P&gt;
&lt;!--MARK-1--&gt;
&lt;BR&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__gruyere&quot;&gt; &lt;/A&gt; Gruyere &lt;/H2&gt;
&lt;P&gt;
&lt;A href=&quot;/static/gruyere.png&quot;&gt;
&lt;IMG src=&quot;/static/gruyere.png&quot; height=&quot;285&quot; border=&quot;0&quot;
    style=&quot;float:left; vertical-align:middle; margin-right: 10; margin-bottom: 10&quot;&gt;
&lt;/A&gt;
This codelab is built around &lt;B&gt;Gruyere&lt;/B&gt;
 /&amp;#609;ru&amp;#720;&amp;#712;j&amp;#603;&amp;#601;r/ &lt;!--groo-yair--&gt; - a
small, cheesy web application that allows its users to publish
snippets of text and store assorted files. &quot;Unfortunately,&quot; Gruyere
has multiple security bugs ranging from cross-site scripting and
cross-site request forgery, to information disclosure, denial of
service, and remote code execution. The goal of this codelab is to
guide you through discovering some of these bugs and learning ways to
fix them both in Gruyere and in general.
&lt;/P&gt;
&lt;P&gt; The codelab is organized by types of vulnerabilities. In each
section, you&#39;ll find a brief description of a vulnerability and a task
to find an instance of that vulnerability in Gruyere. Your job is to
play the role of a malicious hacker and find and exploit the security
bugs. In this codelab, you&#39;ll use both black-box hacking and white-box
hacking. In &lt;B&gt;black box hacking,&lt;/B&gt; you try to find security bugs by
experimenting with the application and manipulating input fields and
URL parameters, trying to cause application errors, and looking at the
HTTP requests and responses to guess server behavior. You do not have
access to the source code, although understanding how to view source
and being able to view http headers (as you can in Chrome or
LiveHTTPHeaders for Firefox) is valuable. Using a web proxy
like &lt;A href=&quot;https://portswigger.net/burp/&quot; target=&quot;_top&quot;&gt;Burp&lt;/A&gt;
or &lt;A href=&quot;https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project&quot;
target=&quot;_top&quot;&gt;ZAP&lt;/A&gt; may be helpful in creating or modifying
requests. In &lt;B&gt;white-box hacking,&lt;/B&gt; you have access to the source
code and can use automated or manual analysis to identify bugs. You
can treat Gruyere as if it&#39;s open source: you can read through the
source code to try to find bugs. Gruyere is written in Python, so
some familiarity with Python can be helpful. However, the security
vulnerabilities covered are not Python-specific and you can do most of
the lab without even looking at the code. You can run a local instance
of Gruyere to assist in your hacking: for example, you can create an
administrator account on your local instance to learn how
administrative features work and then apply that knowledge to the
instance you want to hack. Security researchers use both hacking
techniques, often in combination, in real life.
&lt;/P&gt;
&lt;BR clear=&quot;left&quot;&gt;
We&#39;ll tag each challenge to indicate which techniques are
required to solve them:
&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that can be solved just by using
black box techniques.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require that you look at the
Gruyere source code.&lt;BR&gt;&lt;BR&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; Challenges that require some specific knowledge
of Gruyere that will be given in the first hint.
&lt;BR&gt;
&lt;P style=&quot;color:red&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Accessing or attacking a computer system without
authorization is illegal in many jurisdictions. While doing this
codelab, you are specifically granted authorization to attack the
Gruyere application as directed. You may not attack Gruyere in
ways other than described in this codelab, nor may you attack App
Engine directly or any other Google service. You should use what you
learn from the codelab to make your own applications more secure. You
should not use it to attack any applications other than your own, and
only do that with permission from the appropriate authorities (e.g.,
your company&#39;s security team).
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part1&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part1</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part1 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 12a118c39683a405007f41af38c3cef8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 13686

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (13686 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 1)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;1__setup&quot;&gt; &lt;/A&gt; Setup &lt;/H2&gt;
&lt;P&gt;
To access Gruyere, go to
&lt;CODE&gt;&lt;A href=&quot;/start&quot;&gt;https://google-gruyere.appspot.com/start&lt;/A&gt;&lt;/CODE&gt;.
AppEngine will start a new instance of Gruyere for you, assign it a
unique id and redirect you to
&lt;CODE&gt;https://google-gruyere.appspot.com/&lt;!--do not replace--&gt;123/&lt;/CODE&gt;
(where &lt;CODE&gt;123&lt;/CODE&gt; is your unique id). Each instance of Gruyere
is &quot;sandboxed&quot; from the other instances so your instance won&#39;t be
affected by anyone else using Gruyere. You&#39;ll need to use your
unique id instead of &lt;CODE&gt;123&lt;/CODE&gt; in all the examples. If you want
to share your instance of Gruyere with someone else (e.g., to show
them a successful attack), just share the full URL with them including
your unique id.
&lt;/P&gt;
&lt;P&gt;The Gruyere source code is available online so that you can use
it for white-box hacking. You can browse the source code
at &lt;A href=&quot;/code/&quot;&gt;https://google-gruyere.appspot.com/code/&lt;/A&gt; or download
all the files
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;.
If want to debug it or actually try fixing the bugs, you can download
it and run it locally. You do not need to run Gruyere locally in
order to do the lab.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;running_locally&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Running locally &lt;/H4&gt;
&lt;DIV id=&quot;running_locally&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;FONT color=&quot;#ff0000&quot;&gt;
&lt;B&gt;WARNING:&lt;/B&gt; Because Gruyere is very vulnerable, it
includes some protection against being exploited by an external
attacker when run locally. You&#39;ll see these parts of the code marked
DO NOT CHANGE. Gruyere only accepts requests from localhost and uses
a random unique id in the URL. However, it&#39;s difficult to fully
protect against an external attack. And if you make changes to
Gruyere you could make it more vulnerable to a real
attack. Therefore, you should close other web pages while running
Gruyere locally and you should make sure that no other user is
logged in to the machine you are using.
&lt;/FONT&gt;
&lt;/P&gt;
&lt;P&gt; To run Gruyere locally, you&#39;ll first need to install Python 2.7,
if you don&#39;t already have it. Gruyere was developed and tested with
version 2.7 and may not work with other versions of Python. You can
download it from &lt;A href=&quot;https://www.python.org/downloads/&quot;
target=&quot;_top&quot;&gt;python.org&lt;/A&gt;. Download Gruyere itself
from &lt;A href=&quot;/gruyere-code.zip&quot;&gt;https://google-gruyere.appspot.com/gruyere-code.zip&lt;/A&gt;
and unpack it to your local disk. Then to run the application, simply
type:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
$ cd &amp;lt;gruyere-directory&amp;gt;
$ ./gruyere.py&lt;/PRE&gt;
&lt;P&gt;
You&#39;ll need to replace &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; in all the
examples with &lt;CODE&gt;localhost:8008&lt;/CODE&gt; in addition to
replacing &lt;CODE&gt;123&lt;/CODE&gt; with your unique id. Note that the unique
id appears in a different location. There are a few other small
differences between running Gruyere locally vs. accessing the
instance on App&amp;nbsp;Engine. The most obvious is that the
App&amp;nbsp;Engine version runs in a limited sandbox. So if you do
something that puts Gruyere into an infinite loop, the monitor will
detect it and kill it. That might not happen when you run it locally,
depending on what the loop is doing.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__reset_button&quot;&gt; &lt;/A&gt; Reset Button &lt;/H3&gt;
As noted above, each instance is sandboxed so it can&#39;t consume
infinite resources and it can&#39;t interfere with anyone else&#39;s
instance. Notwithstanding that, it is possible to put your Gruyere
instance into a state where it is completely unusable. If that
happens, you can push a magic &quot;reset button&quot; to wipe out all the data
in your instance and start from scratch. To do this, visit this
URL with your instance id:
&lt;PRE&gt;
https://google-gruyere.appspot.com/resetbutton/582835734666354056417651491707595504272
&lt;/PRE&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__about_the_code&quot;&gt; &lt;/A&gt; About the Code &lt;/H3&gt;
&lt;P&gt;
Gruyere is small and compact. Here is a quick rundown of the
application code:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gruyere.py&quot;&gt;gruyere.py&lt;/A&gt;&lt;/CODE&gt;
is the main Gruyere web server
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt;
stores the default data in the database. There is an administrator
account and two default users.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere template language
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
is the Gruyere module used for sanitizing HTML to protect the
application from security holes.
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;&lt;A href=&quot;/code/&quot;&gt;resources/...&lt;/A&gt;&lt;/CODE&gt;
holds all template files, images, CSS, etc.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H3&gt;&lt;A name=&quot;1__features_and_technologies&quot;&gt; &lt;/A&gt; Features and Technologies &lt;/H3&gt;
&lt;P&gt;
Gruyere includes a number of special features and technologies which
add attack surface. We&#39;ll highlight them here so you&#39;ll be aware of
them as you try to attack it. Each of these introduces new
vulnerabilities.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; HTML in Snippets: Users can include a limited subset of HTML in
their snippets.
&lt;/LI&gt;
&lt;LI&gt; File upload: Users can upload files to the server, e.g., to
include pictures in their snippets.
&lt;/LI&gt;
&lt;LI&gt; Web administration: System administrators can manage the system
using a web interface.
&lt;/LI&gt;
&lt;LI&gt; New accounts: Users can create their own accounts.
&lt;/LI&gt;
&lt;LI&gt; Template language: Gruyere Template Language(GTL) is a new
language that makes writing web pages easy as the templates connect
directly to the database. Documentation for GTL can be found
in &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gruyere/gtl.py&lt;/A&gt;&lt;/CODE&gt;.
&lt;/LI&gt;
&lt;LI&gt; AJAX: Gruyere uses AJAX to implement refresh on the home and
snippets page. You should ignore the AJAX parts of Gruyere except
for the challenges that specifically tell you to focus on AJAX.
&lt;UL&gt;
&lt;LI&gt; In a real application, refresh would probably happen
automatically, but in Gruyere we&#39;ve made it manual so that you can
be in complete control while you are working with it.  When you click
the refresh link, Gruyere
fetches &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt;
which contains refresh data for the current page and then client-side
script uses the browser DOM API (Document Object Model) to insert the
new snippets into the page. Since AJAX runs code on the client side,
this script is visible to attackers who do not have access to your
source code.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;1__using_gruyere&quot;&gt; &lt;/A&gt; Using Gruyere &lt;/H2&gt;
&lt;P&gt;
To familiarize yourself with the features of Gruyere, complete the
following tasks:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; View another user&#39;s snippets by following the &quot;All snippets&quot; link
on the main page. Also check out what they have their Homepage set to.
&lt;/LI&gt;
&lt;LI&gt; Sign up for an account for yourself to use when
hacking. &lt;B&gt;Do not use the same password for your Gruyere
account as you use for any real service.&lt;/B&gt;
&lt;/LI&gt;
&lt;LI&gt; Fill in your account&#39;s profile, including a private snippet and
an icon that will be displayed by your name.
&lt;/LI&gt;
&lt;LI&gt; Create a snippet (via &quot;New Snippet&quot;) containing your favorite
joke.
&lt;/LI&gt;
&lt;LI&gt; Upload a file (via &quot;Upload&quot;) to your account.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; This covers the basic features provided by Gruyere. Now
let&#39;s break them!
&lt;/P&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part2&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part2</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part2 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: ffee62320f5f7cefeffd0f80699246d8
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 37564

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (37564 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 2)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;2__cross_site_scripting&quot;&gt; &lt;/A&gt; Cross-Site Scripting
(XSS) &lt;/H2&gt;
&lt;P&gt;
Cross-site scripting (XSS) is a vulnerability that permits an attacker
to inject code (typically HTML or JavaScript) into contents of a
website not under the attacker&#39;s control. When a victim views such a
page, the injected code executes in the victim&#39;s browser. Thus, the
attacker has bypassed the
browser&#39;s &lt;A href=&quot;https://www.google.com/search?q=same+origin+policy&quot;&gt;same
origin policy&lt;/A&gt; and can steal victim&#39;s private information
associated with the website in question.
&lt;/P&gt;
&lt;P&gt;
In a &lt;b&gt;reflected XSS&lt;/b&gt; attack, the attack is in the request itself
(frequently the URL) and the vulnerability occurs when the server
inserts the attack in the response verbatim or incorrectly escaped or
sanitized. The victim triggers the attack by browsing to a malicious
URL created by the attacker. In a &lt;b&gt;stored XSS&lt;/b&gt; attack, the attacker
stores the attack in the application (e.g., in a snippet) and the
victim triggers the attack by browsing to a page on the server that
renders the attack, by not properly escaping or sanitizing the stored
data.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xss_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt; To understand how this could happen: suppose the
URL &lt;CODE&gt;https://www.google.com/search?q=flowers&lt;/CODE&gt; returns a page
containing the HTML fragment
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
that is, the value of the query parameter &lt;CODE&gt;q&lt;/CODE&gt; is inserted
verbatim into the page returned by
Google. If &lt;CODE&gt;www.google.com&lt;/CODE&gt; did not do any validation or
escaping of &lt;CODE&gt;q&lt;/CODE&gt; (it does), an attacker could craft a link
that looks like this:&lt;BR&gt;
&lt;PRE&gt;
https://www.google.com/search?q=flowers+%3Cscript%3Eevil_script()%3C/script%3E
&lt;/PRE&gt;
and trick a victim into clicking on this link. When a victim loads
this link, the following page gets rendered in the victim&#39;s browser:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;p&amp;gt;Your search for &#39;flowers&amp;lt;script&amp;gt;evil_script()&amp;lt;/script&amp;gt;&#39;
returned the following results:&amp;lt;/p&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
And the browser executes &lt;CODE&gt;evil_script()&lt;/CODE&gt;. And since
the page comes
from &lt;CODE&gt;www.google.com&lt;/CODE&gt;, &lt;CODE&gt;evil_script()&lt;/CODE&gt; is
executed in the context of &lt;CODE&gt;www.google.com&lt;/CODE&gt; and has access
to all the victim&#39;s browser state and cookies for that domain.
&lt;/P&gt;
&lt;P&gt; Note that the victim does not even need to explicitly click on the
malicious link. Suppose the attacker
owns &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, and creates a page with an
&lt;CODE&gt;&amp;lt;iframe&amp;gt;&lt;/CODE&gt; pointing to the malicious link; if the
victim visits &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt;, the attack will
silently be activated.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__xss_challenge&quot;&gt; &lt;/A&gt; XSS Challenges &lt;/H3&gt;
&lt;P&gt;
Typically, if you can get JavaScript to execute on a page when it&#39;s
viewed by another user, you have an XSS vulnerability. A simple
JavaScript function to use when hacking is the &lt;CODE&gt;alert()&lt;/CODE&gt;
function, which creates a pop-up box with whatever string you pass as
an argument.
&lt;/P&gt;
&lt;P&gt;You might think that inserting an alert message isn&#39;t terribly
dangerous, but if you can inject that, you can inject other scripts
that are more malicious. It is not necessary to be able to inject any
particular special character in order to attack. If you can
inject &lt;CODE&gt;alert(1)&lt;/CODE&gt; then you can inject arbitrary script
using &lt;CODE&gt;eval(String.fromCharCode(...))&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt; Your challenge is to find XSS vulnerabilities in Gruyere. You
should look for vulnerabilities both in URLs and in stored data. Since
XSS vulnerabilities usually involve applications not properly handling
untrusted user data, a common method of attack is to enter random text
in input fields and look at how it gets rendered in the response
page&#39;s HTML source. But before we do that, let&#39;s try something simpler.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__file_upload_xss&quot;&gt; &lt;/A&gt; File Upload XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Can you upload a file that allows you to execute arbitrary script
on the &lt;CODE&gt;google-gruyere.appspot.com&lt;/CODE&gt; domain?&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload HTML files and HTML files can contain script.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;upload_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;upload_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;&lt;B&gt;To exploit,&lt;/B&gt; upload a &lt;CODE&gt;.html&lt;/CODE&gt; file containing a script like this:
&lt;PRE&gt;
&amp;lt;script&amp;gt;
alert(document.cookie);
&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; host the content on a separate domain so the script
won&#39;t have access to any content from your domain. That is, instead of
hosting user content on &lt;CODE&gt;example.com/&lt;I&gt;username&lt;/I&gt;&lt;/CODE&gt; we
would host it at &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.usercontent.example.com&lt;/CODE&gt;
or &lt;CODE&gt;&lt;I&gt;username&lt;/I&gt;.example-usercontent.com&lt;/CODE&gt;. (Including
something like &quot;&lt;CODE&gt;usercontent&lt;/CODE&gt;&quot; in the domain name avoids
attackers registering usernames that look innocent
like &lt;CODE&gt;wwww&lt;/CODE&gt; and using them for phishing attacks.)
&lt;P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss&quot;&gt; &lt;/A&gt; Reflected XSS &lt;/H3&gt;
&lt;P&gt;
There&#39;s an interesting problem here. Some browsers have built-in
protection against reflected XSS attacks. There are also browser
extensions like NoScript that provide some protection.  If you&#39;re
using one of those browsers or extensions, you may need to use a
different browser or temporarily disable the extension to execute
these attacks.
&lt;/P&gt;
&lt;P&gt;At the time this codelab was written, the two browsers which had
this protection were IE and Chrome. To work around this, Gruyere
automatically includes a &lt;TT&gt;X-XSS-Protection: 0&lt;/TT&gt; HTTP header in
every response which is recognized by IE and will be recognized by
future versions of Chrome. (It&#39;s available in the developer channel
now.) If you&#39;re using Chrome, you can try starting it with
the &lt;TT&gt;--disable-xss-auditor&lt;/TT&gt; flag by entering one of these
commands:
&lt;UL&gt;&lt;LI&gt;Windows: &lt;TT&gt;&quot;C:\Documents and Settings\USERNAME\Local
Settings\Application
Data\Google\Chrome\Application\chrome.exe&quot; --disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;Mac: &lt;TT&gt;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
--disable-xss-auditor&lt;/TT&gt;
&lt;LI&gt;GNU/Linux: &lt;TT&gt;/opt/google/chrome/google-chrome --disable-xss-auditor&lt;/TT&gt;
&lt;/UL&gt;
If you&#39;re using Firefox with the NoScript extension,
add &lt;TT&gt;google-gruyere.appspot.com&lt;/TT&gt; to the allow list. If you still
can&#39;t get the XSS attacks to work, try a different browser.
&lt;/P&gt;
&lt;P&gt;You may think that you don&#39;t need to worry about XSS if the browser
protects against it. The truth is that the browser protection can&#39;t be
perfect because it doesn&#39;t really know your application and therefore
there may be ways for a clever hacker to circumvent that
protection. The real protection is to not have an XSS vulnerability in
your application in the first place.
&lt;/P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a reflected XSS attack. What we want is a URL
that when clicked on will execute a script.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What does this URL do?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/invalid
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The most dangerous characters in a URL are &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;. If you can get an application to directly
insert what you want in a page and can get those characters through,
then you can probably get a script through. Try these:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%3e%3c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%253e%253c
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%c0%be%c0%bc
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26gt;%26lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/%26amp;gt;%26amp;lt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/\074\x3c\u003c\x3C\u003C\X3C\U003C
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/+ADw-+AD4-
&lt;/PRE&gt;
&lt;P&gt;
This tries &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; in many different
ways that might be able to make it through the URL and get rendered
incorrectly using: verbatim (URL %-encoding), double %-encoding, bad
UTF-8 encoding, HTML &amp;amp;-encoding, double &amp;amp;-encoding, and
several different variations on C-style encoding. View the resulting
source and see if any of those work. (Note: literally
typing &lt;CODE&gt;&amp;gt;&amp;lt;&lt;/CODE&gt; in the URL is identical
to &lt;CODE&gt;%3e%3c&lt;/CODE&gt; because the browser automatically %-encodes
those character. If you are trying to want a literal &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;
or &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; then you will need to use a tool like curl to
send those characters in URL.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_url_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_url_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a
victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to escape user input that is displayed in
error messages. Error messages are displayed
using &lt;CODE&gt;&lt;A href=&quot;/code/?resources/error.gtl&quot;&gt;error.gtl&lt;/A&gt;&lt;/CODE&gt;,
but are not escaped in the template. The part of the template that
renders the message is &lt;CODE&gt;{{message}}&lt;/CODE&gt; and it&#39;s missing the
modifier that tells it to escape user input. Add
the &lt;CODE&gt;:text&lt;/CODE&gt; modifier to escape the user input:
&lt;/P&gt;&lt;PRE&gt;
&amp;lt;div class=&quot;message&quot;&amp;gt;{{_message:text}}&amp;lt;/div&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
This flaw would have been best mitigated by a design that escapes all
output by default and only displays raw HTML when explicitly tagged to
do so. There are
also &lt;A href=&quot;https://www.google.com/search?q=XSS+auto+escaping&quot;
target=&quot;_top&quot;&gt;autoescaping&lt;/A&gt; features available in many template
systems.
&lt;/P&gt;
&lt;!--MARK-2--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss&quot;&gt; &lt;/A&gt; Stored XSS &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Now find a stored XSS. What we want
to do is put a script in a place where Gruyere will serve it back to
another user.&lt;/B&gt;
&lt;/P&gt;
The most obvious place that Gruyere serves back
user-provided data is in a snippet (ignoring uploaded files which we&#39;ve already discussed.)&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Put this in a snippet and see what you get:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
There are many different ways that script can be embedded in a
document.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Hackers don&#39;t limit themselves to valid HTML syntax. Try some invalid
HTML and see what you get. You may need to experiment a bit in order
to find something that will work. There are multiple ways to do this.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; enter any of these as your snippet (there
are certainly more methods):
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1) &amp;lt;a onmouseover=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;

(2) &amp;lt;p &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello

(3) &amp;lt;/td &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;hello
&lt;/PRE&gt;
&lt;P&gt;
Notice that there are multiple failures in sanitizing the
HTML. Snippet 1 worked because &lt;CODE&gt;onmouseover&lt;/CODE&gt; was
inadvertently omitted from the list of disallowed attributes
in &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;. Snippets
2 and 3 work because browsers tend to be forgiving with HTML syntax
and the handling of both start and end tags is buggy.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to investigate and fix the sanitizing performed
on the snippets. Snippets are sanitized in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt;
in the &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;
file. Let&#39;s block snippet 1 by adding &lt;CODE&gt;&quot;onmouseover&quot;&lt;/CODE&gt; to
the list of &lt;CODE&gt;disallowed_attributes&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Looking at
the code that was just fixed, can you find a way to bypass the fix?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a close look at the code in &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; that
determines whether or not an HTML attribute is allowed or not.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_stored_not_fixed&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xss_stored_not_fixed&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The fix was insufficient because the code that checks for disallowed
attributes is case sensitive and HTML is not. So this still works:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
(1&#39;) &amp;lt;a ONMOUSEOVER=&quot;alert(1)&quot; href=&quot;#&quot;&amp;gt;read this!&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
Correctly sanitizing HTML is a tricky
problem. The &lt;CODE&gt;_SanitizeTag&lt;/CODE&gt; function has a number of
critical design flaws:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; It does not validate the well-formedness of the input HTML. As we
see, badly formed HTML passes through the sanitizer unchanged. Since
browsers typically apply very lenient parsing, it is very hard to
predict the browser&#39;s interpretation of the given HTML unless we
exercise strict control on its format.
&lt;/LI&gt;
&lt;LI&gt; It uses blacklisting of attributes, which is a bad technique. One
of our exploits got past the blacklist simply by using an uppercase
version of the attribute. There could be other
attributes &lt;A href=&quot;https://www.w3.org/TR/html40/index/attributes.html&quot;
target=&quot;_top&quot;&gt;missing from this list&lt;/A&gt; that are dangerous. It is
always better to whitelist known good values.
&lt;/LI&gt;
&lt;LI&gt; The sanitizer does not do any further sanitization of attribute
values. This is dangerous since URI attributes like &lt;CODE&gt;href&lt;/CODE&gt;
and &lt;CODE&gt;src&lt;/CODE&gt; and the &lt;CODE&gt;style&lt;/CODE&gt; attribute can all be
used to inject JavaScript.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
The right approach to HTML sanitization is to:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; Parse the input into an intermediate DOM structure, then rebuild
the body as well-formed output.
&lt;/LI&gt;
&lt;LI&gt; Use strict whitelists for allowed tags and attributes.
&lt;/LI&gt;
&lt;LI&gt; Apply strict sanitization of URL and CSS attributes if they are
permitted.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;Whenever possible it is preferable to use an already available known
and proven &lt;A href=&quot;https://www.google.com/search?q=sanitize+html&quot;
target=&quot;_top&quot;&gt;HTML sanitizer&lt;/A&gt;.
&lt;/P&gt;
&lt;!--MARK-3--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_html_attribute&quot;&gt; &lt;/A&gt; Stored XSS via
HTML Attribute &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;You can also do XSS by injecting a value into an
HTML attribute. Inject a script by setting the color value in a
profile.&lt;/B&gt;
&lt;/P&gt;&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The color is rendered as &lt;CODE&gt;style=&#39;color:&lt;I&gt;color&lt;/I&gt;&#39;&lt;/CODE&gt;.
Try including a single quote character in your color name.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can insert an HTML attribute that executes a script.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_color_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_color_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
red&#39; onload=&#39;alert(1)&#39; onmouseover=&#39;alert(2)
&lt;/PRE&gt;
&lt;P&gt;
You may need to move the mouse over the snippet to trigger the
attack. This attack works because the first quote ends
the &lt;CODE&gt;style&lt;/CODE&gt; attribute and the second quote starts the
onload attribute.
&lt;/P&gt;
&lt;P&gt; But this attack shouldn&#39;t work at all. Take a look
at &lt;CODE&gt;&lt;A href=&quot;/code/?resources/home.gtl&quot;&gt;home.gtl&lt;/A&gt;&lt;/CODE&gt; where
it renders the color. It says &lt;CODE&gt;style=&#39;{{color:text}}&#39;&lt;/CODE&gt; and
as we saw earlier, the &lt;CODE&gt;:text&lt;/CODE&gt; part tells it to escape
text. So why doesn&#39;t this get escaped?
In &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;, it
calls &lt;CODE&gt;cgi.escape(str(value))&lt;/CODE&gt; which takes an optional
second parameter that indicates that the value is being used in an
HTML attribute. So you can replace this
with &lt;CODE&gt;cgi.escape(str(value),True)&lt;/CODE&gt;. Except that doesn&#39;t fix
it! The problem is that &lt;CODE&gt;cgi.escape&lt;/CODE&gt; assumes your HTML
attributes are enclosed in double quotes and this file is using single
quotes. (This should teach you to always carefully read the
documentation for libraries you use and to always test that they do
what you want.)
&lt;/P&gt;
&lt;P&gt; You&#39;ll note that this attack uses both &lt;CODE&gt;onload&lt;/CODE&gt;
and &lt;CODE&gt;onmouseover&lt;/CODE&gt;. That&#39;s because even though W3C specifies
that onload events is only supported on &lt;CODE&gt;body&lt;/CODE&gt;
and &lt;CODE&gt;frameset&lt;/CODE&gt; elements, some browsers support them on
other elements. So if the victim is using one of those browsers, the
attack always succeeds. Otherwise, it succeeds when the user moves the
mouse. It&#39;s not uncommon for attackers to use multiple attack vectors
at the same time.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to use a correct text escaper, that escapes
single and double quotes too. Add the following function
to &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt; and call it instead
of &lt;CODE&gt;cgi.escape&lt;/CODE&gt; for the &lt;CODE&gt;text&lt;/CODE&gt; escaper.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _EscapeTextToHtml(var):
  &quot;&quot;&quot;Escape HTML metacharacters.

  This function escapes characters that are dangerous to insert into
  HTML. It prevents XSS via quotes or script injected in attribute values.

  It is safer than cgi.escape, which escapes only &amp;lt;, &amp;gt;, &amp;amp; by default.
  cgi.escape can be told to escape double quotes, but it will never
  escape single quotes.
  &quot;&quot;&quot;
  meta_chars = {
      &#39;&amp;quot;&#39;: &#39;&amp;amp;quot;&#39;,
      &#39;\&amp;#39;&#39;: &#39;&amp;amp;#39;&#39;,  # Not &amp;amp;apos;
      &#39;&amp;amp;&#39;: &#39;&amp;amp;amp;&#39;,
      &#39;&amp;lt;&#39;: &#39;&amp;amp;lt;&#39;,
      &#39;&amp;gt;&#39;: &#39;&amp;amp;gt;&#39;,
      }
  escaped_var = &quot;&quot;
  for i in var:
    if i in meta_chars:
      escaped_var = escaped_var + meta_chars[i]
    else:
      escaped_var = escaped_var + i
  return escaped_var
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.  Even with the
above fix in place, the color value is still vulnerable.
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Some browsers allow you to include script in stylesheets.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
The easiest browser to exploit in this way is Internet Explorer which
supports dynamic CSS properties.
&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_style_xss_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;another_style_xss_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Internet Explorer&#39;s dynamic CSS properites (aka CSS expressions) make
this attack particularly easy.
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; use the following for your color
preference:
&lt;PRE&gt;
expression(alert(1))
&lt;/PRE&gt;
&lt;P&gt;
While other browsers don&#39;t support CSS expressions, there are other
dangerous CSS properties, such as Mozilla&#39;s &lt;CODE&gt;-moz-binding&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to sanitize the color as a color.
The best thing to do would be to add a new output sanitizing form to
gtl, i.e., we would write &lt;CODE&gt;{{foo:color}}&lt;/CODE&gt; which makes
sure &lt;CODE&gt;foo&lt;/CODE&gt; is safe to use as a color. This function can be
used to sanitize:
&lt;/P&gt;
&lt;PRE&gt;
SAFE_COLOR_RE = re.compile(r&quot;^#?[a-zA-Z0-9]*$&quot;)

def _SanitizeColor(color):
  &quot;&quot;&quot;Sanitizes a color, returning &#39;invalid&#39; if it&#39;s invalid.

  A valid value is either the name of a color or # followed by the
  hex code for a color (like #FEFFFF). Returning an invalid value
  value allows a style sheet to specify a default value by writing
  &#39;color:default; color:{{foo:color}}&#39;.
  &quot;&quot;&quot;

  if SAFE_COLOR_RE.match(color):
    return color
  return &#39;invalid&#39;
&lt;/PRE&gt;
&lt;P&gt;
Colors aren&#39;t the only values we might want to allow users to
provide. You should do similar sanitizing for user-provided fonts,
sizes, urls, etc.  It&#39;s helpful to do input validation, so that when a
user enters an invalid value, you&#39;ll reject it at that time. But only
doing input validation would be a mistake: if you find an error in
your validation code or a new browser exposes a new attack vector,
you&#39;d have to go back and scrub all previously entered values. Or, you
could add the output validation which you should have been doing in
the first place.
&lt;/DIV&gt;
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__stored_xss_via_ajax&quot;&gt; &lt;/A&gt; Stored XSS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an XSS attack that uses a bug in
Gruyere&#39;s AJAX code.&lt;/B&gt; The attack should be triggered when you click
the refresh link on the page.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Run &lt;CODE&gt;curl&lt;/CODE&gt;
on &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&lt;/CODE&gt; and look at
the result. (Or browse to it in your browser and view source.)  You&#39;ll
see that it includes each user&#39;s first snippet into the response. This
entire response is then evaluated on the client side which then
inserts the snippets into the document. Can you put something in your
snippet that will be parsed differently than expected?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Try putting some quotes (&lt;CODE&gt;&amp;quot;&lt;/CODE&gt;) in your snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Put this in your snippet:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
all &amp;lt;span style=display:none&amp;gt;&quot;
+ (alert(1),&quot;&quot;)
+ &quot;&amp;lt;/span&amp;gt;your base
&lt;/PRE&gt;
&lt;P&gt;
The JSON should look like
&lt;PRE&gt;_feed(({..., &quot;Mallory&quot;: &quot;snippet&quot;, ...}))&lt;/PRE&gt;
but instead looks like this:
&lt;PRE&gt;_feed({..., &quot;Mallory&quot;: &lt;U&gt;&quot;all &amp;lt;span style=display:none&amp;gt;&quot;&lt;/U&gt;
+ &lt;U&gt;(alert(1),&quot;&quot;)&lt;/U&gt;
+ &lt;U&gt;&quot;&amp;lt;/span&amp;gt;your base&quot;&lt;/U&gt;, ...})&lt;/PRE&gt;
Each underlined part is
a separate expression. Note that this exploit is written to be
invisible both in the original page rendering (because of
the &lt;CODE&gt;&amp;lt;span style=display:none&amp;gt;&lt;/CODE&gt;) and after refresh (because it inserts only an empty string). All that will appear on the screen
is &lt;A href=&quot;https://www.google.com/search?q=all+your+base+are+belong+to+us&quot;
target=&quot;_top&quot;&gt;all your base&lt;/A&gt;. There are bugs on both the server
and client sides which enable this attack.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; first, on the server side, the text is incorrectly
escaped when it is rendered in the JSON response. The template
says &lt;CODE&gt;{{snippet.0:html}}&lt;/CODE&gt; but that&#39;s not enough. This text
is going to be inserted into the innerHTML of a DOM node so the HTML
does have to be sanitized. However, that sanitized text is then going
to be inserted into JavaScript and single and double quotes have to be
escaped. That is, adding support for &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to GTL
would not be sufficient; we would also need to support something
like &lt;CODE&gt;{{...:html:js}}&lt;/CODE&gt;.
&lt;/P&gt;&lt;P&gt;To escape quotes, use &lt;CODE&gt;\x27&lt;/CODE&gt; and &lt;CODE&gt;\x22&lt;/CODE&gt;
for single and double quote respectively. Replacing them
with &lt;CODE&gt;&amp;amp;#27;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;quot;&lt;/CODE&gt; is incorrect
as those are not recognized in JavaScript strings and will break
quotes around HTML attribute.
&lt;/P&gt;
&lt;P&gt; Second, in the browser, Gruyere converts the JSON by using
JavaScript&#39;s &lt;CODE&gt;eval&lt;/CODE&gt;. In general, &lt;CODE&gt;eval&lt;/CODE&gt; is very
dangerous and should rarely be used. If it used, it must be used very
carefully, which is hardly the case here. We should be using the JSON
parser which ensures that the string does not include any unsafe
content. The JSON parser is available
at &lt;A href=&quot;http://www.json.org/&quot; target=&quot;_top&quot;&gt;json.org&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;2__reflected_xss_via_ajax&quot;&gt; &lt;/A&gt; Reflected XSS via
AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt;&lt;B&gt;Find a URL that when clicked on will execute a
script using one of Gruyere&#39;s AJAX features.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
When Gruyere refreshes a user snippets page, it
uses
&lt;PRE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=value&lt;/PRE&gt;
and the result is the script
&lt;PRE&gt;_feed(([&quot;user&quot;, &quot;snippet1&quot;, ... ]))&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This uses a different vulnerability, but the exploit is very similar
to the previous reflected XSS exploit.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xss_ajax2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;xss_ajax2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a URL like the following and get a victim to click on it:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl?uid=%3Cscript%3Ealert(1)%3C/script%3E
&lt;/PRE&gt;
&lt;P&gt;
This renders as
&lt;PRE&gt;_feed(([&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;]))&lt;/PRE&gt;
which surprisingly &lt;I&gt;does&lt;/I&gt; execute the script. The bug is that
Gruyere returns all gtl files as content type &lt;CODE&gt;text/html&lt;/CODE&gt;
and browsers are very tolerant of what HTML files they accept.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you need to make sure that your JSON content can never
be interpreted as HTML. Even though literal &lt;CODE&gt;&amp;lt;&lt;/CODE&gt;
and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt; are allowed in JavaScript strings, you need to
make sure they don&#39;t appear literally where a browser can misinterpret
them. Thus, you&#39;d need to modify &lt;CODE&gt;{{...:js}}&lt;/CODE&gt; to replace
them with the JavaScript escapes &lt;CODE&gt;\x3c&lt;/CODE&gt;
and &lt;CODE&gt;\x3e&lt;/CODE&gt;.  It is always safe to
write &lt;CODE&gt;&#39;\x3c\x3e&#39;&lt;/CODE&gt; in Javscript strings instead
of &lt;CODE&gt;&#39;&amp;lt;&amp;gt;&#39;&lt;/CODE&gt;.  (And, as noted above, using the HTML
escapes &lt;CODE&gt;&amp;amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;amp;gt;&lt;/CODE&gt; is incorrect.)
&lt;/P&gt;
&lt;P&gt; You should also always set the content type of your responses,
in this case serving JSON results
as &lt;CODE&gt;application/javascript.&lt;/CODE&gt; This alone doesn&#39;t solve the
problem because browsers don&#39;t always respect the content type:
browsers sometimes do &quot;sniffing&quot; to try to &quot;fix&quot; results from servers
that don&#39;t provide the correct content type.
&lt;/P&gt;
&lt;P&gt;&lt;B&gt;But wait, there&#39;s more!&lt;/B&gt; Gruyere doesn&#39;t set the content
encoding either. And some browsers try to guess what the encoding type
of a document is or an attacker may be able to embed content in a
document that defines the content type. So, for example, if an
attacker can trick the browser into thinking a document
is &lt;CODE&gt;&lt;A href=&quot;https://www.google.com/search?q=utf-7&quot;&gt;UTF-7&lt;/A&gt;&lt;/CODE&gt;
then it could embed a script tag as &lt;CODE&gt;+ADw-script+AD4-&lt;/CODE&gt;
since &lt;CODE&gt;+ADw-&lt;/CODE&gt; and &lt;CODE&gt;+AD4-&lt;/CODE&gt; are alternate
encodings for &lt;CODE&gt;&amp;lt;&lt;/CODE&gt; and &lt;CODE&gt;&amp;gt;&lt;/CODE&gt;.  So always set
both the content type &lt;I&gt;and&lt;/I&gt; the content encoding of your
responses, e.g., for HTML:&lt;/P&gt;
&lt;PRE&gt;
Content-Type: text/html; charset=utf-8
&lt;/PRE&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;2__more_about_xss&quot;&gt; &lt;/A&gt; More about XSS &lt;/H3&gt;
&lt;P&gt;
In addition to the XSS attacks described above, there are quite a few
more ways to attack Gruyere with XSS. Collect them all!
&lt;/P&gt;
&lt;P&gt;
XSS is a difficult beast. On one hand, a fix to an XSS vulnerability
is usually trivial and involves applying the correct sanitizing
function to user input when it&#39;s displayed in a certain context. On
the other hand, if history is any indication, this is extremely
difficult to get right. &lt;A href=&quot;https://www.kb.cert.org/vuls/&quot;
target=&quot;_top&quot;&gt;US-CERT&lt;/A&gt; reports dozens of publicly disclosed XSS
vulnerabilities involving multiple companies.
&lt;/P&gt;
&lt;P&gt; Though there is no magic defense to getting rid of XSS
vulnerabilities, here are some steps you should take to prevent these
types of bugs from popping up in your products:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;OL&gt;
&lt;LI&gt; First, make sure
you &lt;A href=&quot;https://www.google.com/search?q=understanding+cross-site+scripting&quot;
target=&quot;_top&quot;&gt;understand the problem&lt;/A&gt;.
&lt;/LI&gt;
&lt;LI&gt; Wherever possible, do sanitizing via templates features instead
of calling escaping functions in source code. This way, all of your
escaping is done in one place and your product can benefit from
security technologies designed for template systems that verify their
correctness or actually do the escaping for you. Also, familiarize
yourself with the other security features of your template system.
&lt;/LI&gt;
&lt;LI&gt; Employ good testing practices with respect to XSS.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t write your own template library :)
&lt;/LI&gt;
&lt;/OL&gt;
&lt;!--MARK-6--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part3&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part3</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part3 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 1407b1742a076b846f7e30b01fc4cf60
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 29253

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (29253 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 3)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;3__client_state_manipulation&quot;&gt; &lt;/A&gt; Client-State Manipulation &lt;/H2&gt;
&lt;P&gt;
When a user interacts with a web application, they do it indirectly
through a browser. When the user clicks a button or submits a form,
the browser sends a request back to the web server. Because the
browser runs on a machine that can be controlled by an attacker, the
application must not trust any data sent by the browser.
&lt;/P&gt;&lt;P&gt; It might seem that not trusting any user data would make it
impossible to write a web application but that&#39;s not the case. If the
user submits a form that says they wish to purchase an item, it&#39;s OK
to trust that data. But if the submitted form also includes the price
of the item, that&#39;s something that cannot be trusted.

&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__elevation_of_privilege&quot;&gt; &lt;/A&gt; Elevation of Privilege &lt;/H3&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Convert your account to an administrator account.&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Take a look at
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/editprofile.gtl&quot;&gt;editprofile.gtl&lt;/A&gt;&lt;/CODE&gt;
page that users and administrators use to edit profile settings. If you&#39;re not
an administrator, the page looks a bit different. Can you figure out
how to fool Gruyere into letting you use this page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;elevation_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;elevation_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to fool Gruyere into &lt;i&gt;thinking&lt;/i&gt; you used this
page to update your account?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;

&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;clientstate&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;clientstate&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can convert your account to being an administrator by issuing
either of the following requests:
&lt;/P&gt;&lt;UL&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&lt;/CODE&gt;
&lt;/LI&gt;
&lt;LI&gt; &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=update&amp;amp;is_admin=True&amp;amp;uid=username&lt;/CODE&gt;
(which will make any &lt;CODE&gt;username&lt;/CODE&gt; into an an admin)
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;After visiting this URL, your account is now marked as an
administrator but your cookie still says you&#39;re not. So sign out and
back in to get a new cookie. After logging in, notice the
&#39;Manage this server&#39; link on the top right.&lt;/P&gt;
&lt;P&gt;The bug here is that there is no validation on the server side that
the request is authorized. The only part of the code that restricts
the changes that a user is allowed to make are in the template, hiding
parts of the UI that they shouldn&#39;t have access to. The correct thing
to do is to check for authorization on the server, at the time that
the request is received.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__cookie_manipulation&quot;&gt; &lt;/A&gt; Cookie Manipulation &lt;/H3&gt;
Because the HTTP protocol is stateless, there&#39;s no way a web server
can automatically know that two requests are from the same user. For
this
reason, &lt;A href=&quot;https://www.google.com/search?q=http+cookies&quot;&gt;cookies&lt;/a&gt;
were invented. When a web site includes a cookie (an arbitrary string)
in a HTTP response, the browser automatically sends the cookie back to
the browser on the next request. Web sites can use the cookie to save
session state. Gruyere uses cookies to remember the identity of the
logged in user. Since the cookie is stored on the client side, it&#39;s
vulnerable to manipulation. Gruyere protects the cookies from
manipulation by adding a hash to it. Notwithstanding the fact that
this hash isn&#39;t very good protection, you don&#39;t need to break the hash
to execute an attack.
&lt;/P&gt;&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Get Gruyere to issue you a cookie for someone else&#39;s account.&lt;/B&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You don&#39;t need to look at the Gruyere cookie parsing code. You just need to know what the cookies look like. Gruyere&#39;s cookies use the format:
&lt;PRE&gt;
&lt;i&gt;hash&lt;/i&gt;|&lt;i&gt;username&lt;/i&gt;|admin|author
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;cookie_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Gruyere issues a cookie when you log in. Can you trick it into
issuing you a cookie that looks like another user&#39;s cookie?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookieparsing&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookieparsing&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can get Gruyere to issue you a cookie for someone else&#39;s account
by creating a new account with
username &lt;CODE&gt;&quot;foo|admin|author&quot;&lt;/CODE&gt;. When you log into this
account, it will issue you the
cookie &lt;CODE&gt;&quot;hash|foo|admin|author||author&quot;&lt;/CODE&gt; which actually
logs you into &lt;CODE&gt;foo&lt;/CODE&gt; as an administrator. (So this is also
an elevation of privilege attack.)
&lt;/P&gt;
&lt;P&gt;Having no restrictions on the characters allowed in usernames
means that we have to be careful when we handle them. In this case,
the cookie parsing code is tolerant of malformed cookies and it
shouldn&#39;t be. It should escape the username when it constructs the
cookie and it should reject a cookie if it doesn&#39;t match the exact
pattern it is expecting.
&lt;/P&gt;
&lt;P&gt;Even if we fix this, Python&#39;s hash function is not
cryptographically secure. If you look at
Python&#39;s &lt;CODE&gt;string_hash&lt;/CODE&gt; function
in &lt;CODE&gt;&lt;a href=&quot;https://svn.python.org/projects/python/trunk/Objects/stringobject.c&quot;&gt;python/Objects/stringobject.cc&lt;/A&gt;&lt;/CODE&gt;
you&#39;ll see that it hashes the string strictly from left to right. That
means that we don&#39;t need to know the cookie secret to generate our own
hashes; all we need is another string that hashes to the same value,
which we can find in a relatively short time on a typical PC. In
contrast, with a cryptographic hash function, changing any bit of the
string will change many bits of the hash value in an unpredictable
way. At a minimum, you should use a secure hash function to protect
your cookies. You should also consider encrypting the entire cookie as
plain text cookies can expose information you might not want exposed.
&lt;/P&gt;
&lt;P&gt;And these cookies are also vulnerable to a replay attack. Once a
user is issued a cookie, it&#39;s good forever and there&#39;s no way to
revoke it. So if a user is an administrator at one time, they can save
the cookie and continue to act as an administrator even if their
administrative rights are taken away. While it&#39;s convenient to not
have to make a database query in order to check whether or not a user
is an administrator, that might be too dangerous a detail to store in
the cookie. If avoiding additional database access is important, the
server could cache a list of recent admin users. Including a timestamp
in a cookie and expiring it after some period of time also mitigates
against a replay attack.&lt;/P&gt;

&lt;P&gt;&lt;B&gt;Another challenge:&lt;/B&gt; Since account names are limited to 16 characters, it seems that
this trick would not work to log in to the
actual &lt;CODE&gt;administrator&lt;/CODE&gt; account
since &lt;CODE&gt;&quot;administrator|admin&quot;&lt;/CODE&gt; is 19 characters. Can you
figure out how to bypass that restriction?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;cookie2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Additional Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;cookie2&quot; style=&quot;display:none&quot;&gt;
The 16 character limit is implemented on the client side. Just issue
your own request:
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/saveprofile?action=new&amp;uid=administrator|admin|author&amp;pw=secret
&lt;/PRE&gt;
&lt;P&gt;Again, this restriction should be implemented on the server side,
not just the client side.&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_request_forgery&quot;&gt; &lt;/A&gt; Cross-Site Request Forgery (XSRF) &lt;/H2&gt;
&lt;P&gt;
The previous section said &quot;If the user submits a form that says they
wish to purchase an item, it&#39;s OK to trust that data.&quot; That&#39;s true as
long as it really was the user that submitted the form. If your site
is vulnerable to XSS, then the attacker can fake any request as if it
came from the user. But even if you&#39;ve protected against XSS, there&#39;s
another attack that you need to protect against: cross-site request
forgery.
&lt;/P&gt;&lt;P&gt;
When a browser makes requests to a site, it always sends along any
cookies it has for that site, regardless of where the request comes
from. Additionally, web servers generally cannot distinguish between a
request initiated by a deliberate user action (e.g., user clicking on
&quot;Submit&quot; button) versus a request made by the browser without user
action (e.g., request for an embedded image in a page). Therefore, if
a site receives a request to perform some action (like deleting a
mail, changing contact address), it cannot know whether this action
was knowingly initiated by the user &amp;mdash; even if the request contains
authentication cookies. An attacker can use this fact to fool the
server into performing actions the user did not intend to perform.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_desc&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; More details &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_desc&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
For example, suppose Blogger is vulnerable to XSRF attacks (it
isn&#39;t). And let us say Blogger has a Delete Blog button on the
dashboard that points to this URL:
&lt;PRE&gt;
https://www.blogger.com/deleteblog.do?blogId=BLOGID
&lt;/PRE&gt;
Bob, the attacker, embeds the following HTML on his web page
on &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;:
&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;img src=&quot;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&quot;
    style=&quot;display:none&quot;&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the victim, Alice, is logged in to &lt;CODE&gt;www.blogger.com&lt;/CODE&gt; when
she views the above page, here is what happens:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt; Her browser loads the page
from &lt;CODE&gt;https://www.evil.example.com&lt;/CODE&gt;. The browser then tries to
load all embedded objects in the page, including the &lt;CODE&gt;img&lt;/CODE&gt;
shown above.
&lt;/LI&gt;
&lt;LI&gt; The browser makes a request
to &lt;CODE&gt;https://www.blogger.com/deleteblog.do?blogId=alice&#39;s-blog-id&lt;/CODE&gt;
to load the image. Since Alice is logged into Blogger &amp;mdash; that is,
she has a Blogger cookie &amp;mdash; the browser also sends that cookie in
the request.
&lt;/LI&gt;
&lt;LI&gt; Blogger verifies the cookie is a valid session cookie for
Alice. It verifies that the blog referenced
by &lt;CODE&gt;alice&#39;s-blog-id&lt;/CODE&gt; is owned by Alice. It deletes Alice&#39;s
blog.
&lt;/LI&gt;
&lt;LI&gt; Alice has no idea what hit her.
&lt;/LI&gt;
&lt;/UL&gt;
&lt;P&gt;
In this sample attack, since each user has their own blog id, the
attack has to be specifically targeted to a single person. In many
cases, though, requests like these don&#39;t contain any user-specific
data.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xsrf_challenge&quot;&gt; &lt;/A&gt; XSRF Challenge &lt;/H3&gt;
&lt;P&gt;
The goal here is to find a way to perform an account changing action
on behalf of a logged in Gruyere user without their
knowledge. Assume you can get them to visit a web page under your
control.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt; Find a way to get someone to delete one
of their Gruyere snippets.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What is the URL used to delete a snippet? Look at the URL associated
with the &quot;X&quot; next to a snippet.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; lure a user to visit a page that makes
the following request:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/deletesnippet?index=0
&lt;/PRE&gt;
&lt;P&gt;
To be especially sneaky, you could set your Gruyere icon to this URL
and the victim would be exploited when they visited the main page.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should first change &lt;CODE&gt;/deletesnippet&lt;/CODE&gt; to
work via a &lt;CODE&gt;POST&lt;/CODE&gt; request since this is a state changing
action. In the HTML form, change &lt;CODE&gt;method=&#39;get&#39;&lt;/CODE&gt;
to &lt;CODE&gt;method=&#39;post&#39;&lt;/CODE&gt;. On the server side, &lt;CODE&gt;GET&lt;/CODE&gt;
and &lt;CODE&gt;POST&lt;/CODE&gt; requests look the same except that they usually
call different handlers. For example, Gruyere uses Python&#39;s
BaseHTTPServer which calls &lt;CODE&gt;do_GET&lt;/CODE&gt; for &lt;CODE&gt;GET&lt;/CODE&gt;
requests and &lt;CODE&gt;do_POST&lt;/CODE&gt; for &lt;CODE&gt;POST&lt;/CODE&gt; requests.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;However&lt;/B&gt;, note that changing to &lt;CODE&gt;POST&lt;/CODE&gt; is not enough
of a fix in itself! (Gruyere uses &lt;CODE&gt;GET&lt;/CODE&gt; requests
exclusively because it makes hacking it a bit
easier. &lt;CODE&gt;POST&lt;/CODE&gt; is not more secure than &lt;CODE&gt;GET&lt;/CODE&gt; but
it is more correct: browsers may re-issue &lt;CODE&gt;GET&lt;/CODE&gt; requests
which can result in an action getting executed more than once;
browsers won&#39;t reissue &lt;CODE&gt;POST&lt;/CODE&gt; requests without user
consent.) Then we need to pass a unique, unpredictable authorization
token to the user and require that it get sent back before performing
the action. For this authorization token, &lt;CODE&gt;action_token&lt;/CODE&gt;,
we can use a hash of the value of the user&#39;s cookie appended to a
current timestamp and include this token in all state-changing HTTP
requests as an additional HTTP parameter. The reason we
use &lt;CODE&gt;POST&lt;/CODE&gt; over &lt;CODE&gt;GET&lt;/CODE&gt; requests is that if we
pass &lt;CODE&gt;action_token&lt;/CODE&gt; as a URL parameter, it might leak via
HTTP Referer headers. The reason we include the timestamp in our hash
is so that we can expire old tokens, which mitigates the risk if it
leaks.
&lt;/P&gt;
&lt;P&gt; When a request is processed, Gruyere should regenerate the token
and compare it with the value supplied with the request. If the values
are equal, then it should perform the action. Otherwise, it should
reject it. The functions that generate and verify the tokens look like
this:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
def _GenerateXsrfToken(self, cookie):
  &quot;&quot;&quot;Generates a timestamp and XSRF token for all state changing actions.&quot;&quot;&quot;

  timestamp = time.time()
  return timestamp + &quot;|&quot; + (str(hash(cookie_secret + cookie + timestamp)))

def _VerifyXsrfToken(self, cookie, action_token):
  &quot;&quot;&quot;Verifies an XSRF token included in a request.&quot;&quot;&quot;

  # First, make sure that the token isn&#39;t more than a day old.
  (action_time, action_hash) = action_token.split(&quot;|&quot;, 1)
  now = time.time()
  if now - 86400 &amp;gt; float(action_time):
    return False

  # Second, regenerate it and check that it matches the user supplied value
  hash_to_verify = str(hash(cookie_secret + cookie + action_time)
  return action_hash == hash_to_verify
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; There&#39;s several things wrong with these functions.
&lt;/P&gt;&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xsrf_whats_wrong&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; What&#39;s missing? &lt;/H4&gt;
&lt;DIV id=&quot;xsrf_whats_wrong&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
By including the time in the token, we prevent it from being used
forever, but if an attacker were to gain access to a copy of the
token, they could reuse it as many times as they wanted within that 24
hour period. The expiration time of a token should be set to a small
value that represents the reasonable length of time it will take the
user to make a request.  This token also doesn&#39;t protect against an
attack where a token for one request is intercepted and then used for
a different request. As suggested by the
name &lt;CODE&gt;action_token&lt;/CODE&gt;, the token should be tied to the
specific state changing action being performed, such as the URL of the
page. A better signature for &lt;CODE&gt;_GenerateXsrfToken&lt;/CODE&gt; would
be &lt;CODE&gt;(self, cookie, action)&lt;/CODE&gt;. For very long actions, like
editing snippets, a script on the page could query the server to
update the token when the user hits submit. (But read the next section
about XSSI to make sure that an attacker won&#39;t be able to read that
new token.)&lt;/P&gt;
&lt;P&gt;
XSRF vulnerabilities exist because an attacker can easily script a
series of requests to an application and than force a user to execute
them by visiting some page. To prevent this type of attack, you need
to introduce some value that can&#39;t be predicted or scripted by an
attacker for &lt;B&gt;every account changing&lt;/B&gt; request. Some application
frameworks have XSRF protection built in: they automatically include a
unique token in every response and verify it on every POST request.
Other frameworks provide functions that you can use to do that. If
neither of these cases apply, then you&#39;ll have
to &lt;A href=&quot;https://www.google.com/search?q=preventing+(XSRF+OR+CSRF)&quot;
target=&quot;_top&quot;&gt;build your own&lt;/A&gt;. Be careful of things that don&#39;t
work: using &lt;CODE&gt;POST&lt;/CODE&gt; instead of &lt;CODE&gt;GET&lt;/CODE&gt; is advisable
but not sufficient by itself, checking Referer headers is
insufficient, and copying cookies into hidden form fields can make
your cookies less secure.
&lt;/P&gt;
&lt;!--MARK-7--&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H2&gt;&lt;A name=&quot;3__cross_site_script_inclusion&quot;&gt; &lt;/A&gt; Cross Site Script Inclusion (XSSI) &lt;/H2&gt;
&lt;P&gt;
Browsers prevent pages of one domain from reading pages in other
domains. But they do not prevent pages of a domain from referencing
resources in other domains. In particular, they allow images to be
rendered from other domains and scripts to be executed from other
domains. An included script doesn&#39;t have its own security context. It
runs in the security context of the page that included it. For
example, if &lt;CODE&gt;www.evil.example.com&lt;/CODE&gt; includes a script hosted
on &lt;CODE&gt;www.google.com&lt;/CODE&gt; then that script runs in
the &lt;CODE&gt;evil&lt;/CODE&gt; context not in the &lt;CODE&gt;google&lt;/CODE&gt;
context. So any user data in that script will &quot;leak.&quot;
&lt;/P&gt;
&lt;!--MARK-8--&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;3__xssi_challenge&quot;&gt; &lt;/A&gt; XSSI Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Find a way to read someone else&#39;s private snippet using XSSI.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; That is, create a page on another web site and put something in
that page that can read your private snippet. (You don&#39;t need to post
it to a web site: you can just create a &lt;CODE&gt;.html&lt;/CODE&gt; in your
home directory and double click on it to open in a browser.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV id=&quot;xssi_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can run a script from another domain by
adding
&lt;PRE&gt;
&amp;lt;SCRIPT src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/...&quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;
&lt;/PRE&gt;
to your HTML file. What scripts does Gruyere have?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;xssi_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is a
script. Given that, how can you get the private snippet out of the
script?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;xssi_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;xssi_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; put this in an html file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;script&amp;gt;
function _feed(s) {
  alert(&quot;Your private snippet is: &quot; + s[&#39;private_snippet&#39;]);
}
&amp;lt;/script&amp;gt;
&amp;lt;script src=&quot;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/feed.gtl&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
When the script
in &lt;CODE&gt;&lt;A href=&quot;/code/?resources/feed.gtl&quot;&gt;feed.gtl&lt;/A&gt;&lt;/CODE&gt; is
executed, it runs in the context of the attacker&#39;s web page and uses
the &lt;CODE&gt;_feed&lt;/CODE&gt; function which can do whatever it wants with
the data, including sending it off to another web site.
&lt;/P&gt;
&lt;P&gt;
You might think that you can fix this by eliminating the function
call and just having the bare expression. That way, when the script is
executed by inclusion, the response will be evaluated and then
discarded. That won&#39;t work because JavaScript allows you to do things
like redefine default constructors. So when the object is evaluated,
the hosting page&#39;s constructors are invoked, which can do whatever
they want with the values.
&lt;/P&gt;
&lt;!--MARK-9--&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; there are several changes you can make. Any
one of these changes will prevent currently possible attacks, but if
you add several layers of protection
(&quot;&lt;a href=&quot;https://www.google.com/search?q=%22defense+in+depth%22+security&quot;&gt;defense
in depth&lt;/a&gt;&quot;) you protect against the possibility that you get one of
the protections wrong and also against future browser
vulnerabilities. First, use an XSRF token as discussed earlier to make
sure that JSON results containing confidential data are only returned
to your own pages. Second, your JSON response pages should only
support &lt;CODE&gt;POST&lt;/CODE&gt; requests, which prevents the script from
being loaded via a script tag. Third, you should make sure that the
script is not executable. The standard way of doing this is to append
some non-executable prefix to it,
like &lt;CODE&gt;])}while(1);&amp;lt;/x&amp;gt;&lt;/CODE&gt;. A script running in the same
domain can read the contents of the response and strip out the prefix,
but scripts running in other domains can&#39;t.
&lt;/P&gt;
&lt;P&gt; NOTE: Making the script not executable is more subtle than it
seems. It&#39;s possible that what makes a script executable may change in
the future if new scripting features or languages are introduced. Some
people suggest that you can protect the script by making it a comment
by surrounding it with &lt;CODE&gt;/*&lt;/CODE&gt; and &lt;CODE&gt;*/&lt;/CODE&gt;, but that&#39;s
not as simple as it might seem. (Hint: what if someone
included &lt;CODE&gt;*/&lt;/CODE&gt; in one of their snippets?)
&lt;/P&gt;
&lt;P&gt;
There&#39;s &lt;A href=&quot;https://www.google.com/search?q=%22cross+site+script+inclusion%22&quot;
target=&quot;_top&quot;&gt;much more to XSSI&lt;/A&gt; than this. There&#39;s a variation of
JSON called JSONP which you should avoid using because it allows
script injection &lt;I&gt;by design&lt;/I&gt;. And
there&#39;s &lt;A href=&quot;https://www.google.com/search?q=E4X+markup+security&quot;
target=&quot;_top&quot;&gt;E4X&lt;/A&gt; (Ecmascript for XML) which can result in your
HTML file being parsed as a script. Surprisingly, one way to protect
against E4X attacks is to put some invalid XML in your files, like
the &lt;CODE&gt;&amp;lt;/x&amp;gt;&lt;/CODE&gt; above.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part4&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part4</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part4 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 4f63cf082e004e6cac6bc4ca207ce19e
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 24149

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (24149 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 4)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__path_traversal&quot;&gt; &lt;/A&gt; Path Traversal &lt;/H2&gt;
&lt;P&gt;
Most web applications serve static resources like images and CSS
files. Frequently, applications simply serve all the files in a
folder. If the application isn&#39;t careful, the user can use a path
traversal attack to read files from other folders that they shouldn&#39;t
have access to. For example, in both Windows and
Linux, &lt;CODE&gt;..&lt;/CODE&gt; represents the parent directory, so if you can
inject &lt;CODE&gt;../&lt;/CODE&gt; in a path you can &quot;escape&quot; to the parent
directory.
&lt;/P&gt;
&lt;P&gt; If an attacker knows the structure of your file system, then they
can craft a URL that will traverse out of the installation directory
to &lt;CODE&gt;/etc&lt;/CODE&gt;. For example, if Picasa was vulnerable to path
traversal (it isn&#39;t) and the Picasa servers use a Unix-like system,
then the following would retrieve the password file:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://www.picasa.com/../../../../../../../etc/passwd
&lt;/PRE&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__information_disclosure_path_traversal&quot;&gt; &lt;/A&gt; Information
disclosure via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to read &lt;CODE&gt;secret.txt&lt;/CODE&gt; from
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; Amazingly, this attack is not even necessary in many cases:
people often install applications and never change the defaults. So
the first thing an attacker would try is the default value.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
This isn&#39;t a black box attack because you need to know that
the &lt;CODE&gt;secret.txt&lt;/CODE&gt; file exists, where it&#39;s stored, and where
Gruyere stores its resource files. You don&#39;t need to look at any
source code.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does the server know which URLs represent resource files? You can
use curl or a web proxy to craft request URLs that some browsers may
not allow.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;read_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;read_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can steal &lt;CODE&gt;secret.txt&lt;/CODE&gt; via
this URL:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/../secret.txt
&lt;/PRE&gt;
&lt;P&gt;
Some browsers, like Firefox and Chrome, optimize out &lt;CODE&gt;../&lt;/CODE&gt;
in URLs. This doesn&#39;t provide any security protection because an
attacker will use &lt;CODE&gt;%2f&lt;/CODE&gt; to represent &lt;CODE&gt;/&lt;/CODE&gt; in the URL;
or a tool like curl, a web proxy or a browser that
doesn&#39;t do that optimization. But if you test your application with
one of these browsers to see if you&#39;re vulnerable, you might think you
were protected when you&#39;re not.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we need to prevent access to files outside
the resources directory.  Validating file paths is a bit tricky as
there are various ways to hide path elements like &quot;../&quot; or &quot;~&quot; that
allow escaping out of the resources folder. The best protection is to
only serve specific resource files. You can either hardcode a list or
when your application starts, you can crawl the resource directory and
build a list of files. Then only accept requests for those files. You
can even do some optimization here like caching small files in memory
which will make your application faster. If you are going to try to
file path validation, you need to do it on the final path, not on the
URL, as there are numerous ways to represent the same characters in
URLs. &lt;I&gt;Note: Changing file permissions will NOT work. Gruyere has
to be able to read this file.&lt;/I&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__data_tampering_path_traversal&quot;&gt; &lt;/A&gt; Data
tampering via path traversal &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to replace &lt;CODE&gt;secret.txt&lt;/CODE&gt; on
a running Gruyere server.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Again, this isn&#39;t a black box attack because you need to know about
the directory structure that Gruyere uses, specifically where
uploaded files are stored.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
If I log in as user &lt;CODE&gt;brie&lt;/CODE&gt; and upload a file, where does
the server store it? Can you trick the server into uploading a file
to &lt;CODE&gt;../../secret.txt&lt;/CODE&gt;?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a new user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload your new &lt;CODE&gt;secret.txt&lt;/CODE&gt;. You could also create a
user named &lt;CODE&gt;brie/../..&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; you should escape dangerous characters in the username
(replacing them with safe characters) before using it. It was earlier
suggested that we should restrict the characters allowed in a username,
but it probably didn&#39;t occur to you that &lt;CODE&gt;&quot;.&quot;&lt;/CODE&gt; was a
dangerous character.  It&#39;s worth noting that there&#39;s a vulnerability
unique to Windows servers with this implementation. On Windows,
filenames are not case sensitive but Gruyere usernames are. So one
user can attack another user&#39;s files by creating a similar username
that differs only in case, e.g., &lt;CODE&gt;BRIE&lt;/CODE&gt; instead
of &lt;CODE&gt;brie&lt;/CODE&gt;. So we need to not just escape unsafe characters
but convert the username to a canonical form that is different for
different usernames. Or we could avoid all these issues by assigning
each user a unique identifier instead.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem. Even with the
above fix in place, there is another way to perform this attack. Can
you find it?
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;another_write_secret_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;another_write_secret_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Are there any limits on the filename when you do an upload?  You may
need to use a special tool like &lt;CODE&gt;curl&lt;/CODE&gt; or a web proxy to
perform this attack.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;write_secret_txt_sol2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;write_secret_txt_sol2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt; Surprisingly, you can upload a file
named &lt;CODE&gt;../secret.txt&lt;/CODE&gt;. Gruyere provides no protection
against this attack. Most browsers won&#39;t let you upload that file but,
again, you can do it with curl or other tools. You need the same kind
of protection when writing files as you do on read.
&lt;/P&gt;
&lt;P&gt; As a general rule, you should never store user data in the
same place as your application files but that alone won&#39;t protect
against these attacks since if the user can inject &lt;CODE&gt;../&lt;/CODE&gt;
into the file path, they can traverse all the way to the root of the
file system and then back down to the normal install location of your
application (or even the Python interpreter itself).
&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;4__denial_of_service&quot;&gt; &lt;/A&gt; Denial of Service &lt;/H2&gt;
&lt;P&gt;
A denial of service (DoS) attack is an attempt to make a server unable
to service ordinary requests. A common form of DoS attack is sending
more requests to a server than it can handle. The server spends all
its time servicing the attacker&#39;s requests that it has very little
time to service legitimate requests. Protecting an application against
these kinds of DoS attacks is outside the scope of this codelab. And
attacking Gruyere in this way would be interpreted as an attack on
App&amp;nbsp;Engine.
&lt;/P&gt;&lt;P&gt; Hackers can also prevent a server from servicing requests by
taking advantage of server bugs, such as sending requests that crash a
server, make it run out of memory, or otherwise cause it fail serving
legitimate requests in some way. In the next few challenges, you&#39;ll
take advantage of bugs in Gruyere to perform DoS attacks.
&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_quit_server&quot;&gt; &lt;/A&gt; DoS - Quit the Server &lt;/H3&gt;
The simplest form of denial of service is shutting down a service.
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_bw.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to make the server quit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
How does an administrator make the server quit? The server management
page is &lt;CODE&gt;&lt;A href=&quot;/code/?resources/manage.gtl&quot;&gt;manage.gtl&lt;/A&gt;&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_quit_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_quit_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a request
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. You
should need to be logged in as an administrator to do this, but you
don&#39;t.
&lt;/P&gt;&lt;P&gt;
This is another example of a common bug. The server protects
against non-administrators accessing certain URLs but the list
includes &lt;CODE&gt;/quit&lt;/CODE&gt; instead of the actual
URL &lt;CODE&gt;/quitserver&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; add &lt;CODE&gt;/quitserver&lt;/CODE&gt; to the URLS only
accessible to administrators:
&lt;/P&gt;&lt;PRE&gt;
_PROTECTED_URLS = [
    &quot;/quitserver&quot;,
    &quot;/reset&quot;
]
&lt;/PRE&gt;
&lt;P&gt;
&lt;!--MARK-A--&gt;
&lt;B&gt;Oops!&lt;/B&gt; This doesn&#39;t completely solve the problem.
The &lt;CODE&gt;reset&lt;/CODE&gt; URL is in the protected list. Can you figure
out how to access it?
&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look carefully at the code that handles URLs and checks for protected ones.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_bonus_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Another Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_bonus_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt;
use &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/RESET&lt;/CODE&gt;. The check for
protected urls is case sensitive. After doing that check, it
capitalizes the string to look up the implementation. This is a
classic check/use bug where the condition being checked does not match
the actual use. This vulnerability is worse than the previous one
because it exposes all the protected urls.
&lt;/P&gt;&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; put the security check inside the dangerous
functions rather than outside them. That ensures that no matter how we
get there, the security check can&#39;t be skipped.
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;
&lt;H3&gt;&lt;A name=&quot;4__dos_overload_server&quot;&gt;&lt;/A&gt; DoS - Overloading the Server &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to overload the server when it processes a request.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a template that does this.
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Every page includes
the &lt;CODE&gt;&lt;A href=&quot;/code/?resources/menubar.gtl&quot;&gt;menubar.gtl&lt;/A&gt;&lt;/CODE&gt;
template. Can you figure out how to make that template overload the
server?
&lt;/P&gt;&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dos_overload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dos_overload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a file named &lt;CODE&gt;menubar.gtl&lt;/CODE&gt;
containing:
&lt;PRE&gt;
[[include:menubar.gtl]]DoS[[/include:menubar.gtl]]
&lt;/PRE&gt;
and upload it to the &lt;CODE&gt;resources&lt;/CODE&gt; directory using a path traversal attack, e.g., creating a user named &lt;CODE&gt;../resources&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; implement the protections against path traversal and uploading templates discussed earlier.

&lt;/P&gt;
&lt;/DIV&gt;

&lt;B&gt;NOTE:&lt;/B&gt; After performing the previous exploit, you&#39;ll need to
push the &lt;A href=&quot;/part1#1__reset_button&quot;&gt;reset button&lt;/A&gt;.

&lt;/P&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_dos&quot;&gt; &lt;/A&gt; More on Denial of
Service &lt;/H3&gt;
&lt;P&gt;
Unlike a well defined vulnerability like XSS or XSRF, denial of
service describes a wide class of attacks. This might mean bringing
your service down or flooding your inbox so you can&#39;t receive
legitimate mail. Some things to consider:
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt; If you were evil and greedy, how quickly could you take down your
application or starve all of its resources? For example, is it
possible for a user to upload their hard drive to your application?
Entering the attacker&#39;s mindset can help identify DoS points in your
application. Additionally, think about where the computationally and
memory intensive tasks are in your application and put safeguards in
place. Do sanity checks on input values.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;Put monitoring in place so you can detect when you are under
attack and enforce per user quotas and rate limiting to ensure that a
small subset of users cannot starve the rest. Abusive patterns could
include increased memory usage, higher latency, or more requests or
connections than usual.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-B--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;4__code_execution&quot;&gt; &lt;/A&gt; Code Execution &lt;/H2&gt;
&lt;P&gt;
If an attacker can execute arbitrary code remotely on your server,
it&#39;s usually game over. They may be able to take control over the
running program or potentially break out the process to open a new
shell on the computer. From here, it&#39;s usually not hard to compromise
the entire machine the server is running on.
&lt;/P&gt;
&lt;P&gt; Similar to information disclosure and denial of service, there
is no recipe or specific defense to prevent remote code execution. The
program must perform validation of all user input before handling it
and where possible, implement functions with least privilege
rights. This topic can&#39;t be done justice in just a short paragraph,
but know that this is likely the scariest results a security bug can
have and trumps any of the above attacks.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__code_execution_challenge&quot;&gt; &lt;/A&gt; Code Execution Challenge &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a code execution exploit.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You need to use two previous exploits.
&lt;/P&gt;&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;code_upload_soln&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;code_upload_soln&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; make a copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?gtl.py&quot;&gt;gtl.py&lt;/A&gt;&lt;/CODE&gt;
(or &lt;CODE&gt;&lt;A href=&quot;/code/?sanitize.py&quot;&gt;sanitize.py&lt;/A&gt;&lt;/CODE&gt;) and
add some exploit code. Now you can either upload a file
named &lt;CODE&gt;../gtl.py&lt;/CODE&gt; or create a user named &lt;CODE&gt;..&lt;/CODE&gt;
and upload &lt;CODE&gt;gtl.py&lt;/CODE&gt;. Then, make the server quit by browsing
to &lt;CODE&gt;https://google-gruyere.appspot.com/582835734666354056417651491707595504272/quitserver&lt;/CODE&gt;. When the
server restarts, your code will run.
&lt;/P&gt;
&lt;P&gt; This attack was possible because Gruyere has permission to both
read and write files in the Gruyere directory. Applications should
run with the minimal privileges possible.
&lt;/P&gt;
&lt;P&gt; Why would you attack &lt;CODE&gt;gtl.py&lt;/CODE&gt;
or &lt;CODE&gt;sanitize.py&lt;/CODE&gt; rather than &lt;CODE&gt;gruyere.py&lt;/CODE&gt;?
When an attacker has a choice, they would usually choose to attack the
infrastructure rather than the application itself. The infrastructure
is less likely to be updated and less likely to be noticed. When was
the last time you checked that no one had
replaced &lt;CODE&gt;python.exe&lt;/CODE&gt; with a trojan?
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; fix the two previous exploits.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;4__more_code_execution&quot;&gt; &lt;/A&gt; More on Remote
Code Execution &lt;/H3&gt;
&lt;P&gt;
Even though there is no single or simple defense to remote code
execution, here is a short list of some preventative measures:
&lt;/P&gt;
&lt;UL&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Least Privilege:&lt;/B&gt; Always run your application with
the &lt;A href=&quot;https://www.google.com/search?q=least+privileges&quot;
target=&quot;_top&quot;&gt;least privileges&lt;/A&gt; it needs.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Application Level Checks:&lt;/B&gt; Avoid passing user input
directly into commands that evaluate arbitrary code,
like &lt;CODE&gt;eval()&lt;/CODE&gt; or &lt;CODE&gt;system()&lt;/CODE&gt;. Instead, use the
user input as a switch to choose from a set of developer controlled
commands.
&lt;/P&gt;
&lt;LI&gt;&lt;P&gt;&lt;B&gt;Bounds Checks:&lt;/B&gt; Implement proper bounds checks for
non-safe languages like
C++. Avoid &lt;A href=&quot;https://www.google.com/search?q=unsafe+string+functions&quot;
target=&quot;_top&quot;&gt;unsafe string functions&lt;/A&gt;. Keep in mind that even safe
languages like Python and Java use native libraries.
&lt;/P&gt;
&lt;/UL&gt;
&lt;!--MARK-C--&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;


             &lt;FONT SIZE=&quot;+2&quot;&gt;
             &lt;A href=&quot;/part5&quot;&gt;Continue &amp;gt;&amp;gt;&lt;/A&gt;
             &lt;/FONT&gt;&lt;BR&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/part5</span>
												</summary>
												
<table class="alerts-table">
	
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>This check identifies responses where the HTTP Content-Type header declares a charset different from the charset defined by the body of the HTML or XML. When there&#39;s a charset mismatch between the HTTP header and content body Web browsers can be forced into an undesirable content-sniffing mode to determine the content&#39;s correct character set.</p>

<p>An attacker could manipulate content on the page to be interpreted in an encoding of their choice. For example, if an attacker can control content at the beginning of the page, they could inject script using UTF-7 encoded text and manipulate some browsers into interpreting that text.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>There was a charset mismatch between the HTTP Header and the META content-type encoding declarations: [utf-8] and [ISO-8859-1] do not match.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (330 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/part5 HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (244 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/html; charset=utf-8
X-Cloud-Trace-Context: 35f51fbbbb4fdbac8f6d4b6a16367b2c
Date: Sun, 15 May 2022 13:19:58 GMT
Server: Google Frontend
Content-Length: 25303

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (25303 bytes)</summary>
				
				<pre><code>&lt;HTML&gt;&lt;HEAD&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;TITLE&gt;Web Application Exploits and Defenses&lt;/TITLE&gt;
&lt;LINK type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;../static/codelab.css&quot;&gt;
&lt;!--MARK-Z--&gt;
&lt;SCRIPT&gt;
function toggleBlock(heading, whichID) {
  var image = heading.childNodes[0];
  var block = document.getElementById(whichID);
  if (block) {
    if (getDisplay(block) == &#39;block&#39;) {
      block.style.display = &#39;none&#39;;
      image.src = &#39;static/closed.gif&#39;;
    } else {    // &quot;none&quot; or &quot;&quot;
      block.style.display = &#39;block&#39;;
      image.src = &#39;static/open.gif&#39;;
    }
  }
}

function getDisplay(block) {
  var value = block.style.display;
  if (!value) {
    if (document.defaultView) {
      var computedStyle = document.defaultView.getComputedStyle(block, &quot;&quot;);
      value = computedStyle.getPropertyValue(&#39;display&#39;);
    } else if (block.currentStyle) {
      value = block.currentStyle.display;
    }
  }
  return value;
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;

&lt;DIV class=&quot;banner&quot;&gt;&lt;/DIV&gt;
&lt;H1&gt;&lt;FONT size=&quot;+2&quot;&gt;&lt;IMG src=&quot;/static/gruyere-78.png&quot; style=&quot;vertical-align:middle&quot;&gt;
Web Application Exploits and Defenses  (Part 5)&lt;/FONT&gt; &lt;/H1&gt;
&lt;P&gt;
A Codelab by Bruce Leban, Mugdha Bendre, and Parisa Tabriz
&lt;/P&gt;
&lt;DIV class=&quot;printable&quot;&gt;
&lt;DIV class=&quot;column1&quot;&gt;
Table of Contents
&lt;UL&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__hackers&quot;&gt;Beat the hackers&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot; style=&quot;padding-top:0pt&quot;&gt; &lt;A href=&quot;/#0__gruyere&quot;&gt;Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__setup&quot;&gt;Set-up&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__reset_button&quot;&gt;Reset Button&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__about_the_code&quot;&gt;About the Code&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part1#1__features_and_technologies&quot;&gt;Features and Technologies&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part1#1__using_gruyere&quot;&gt;Using Gruyere&lt;/A&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part2#2__cross_site_scripting&quot;&gt;Cross-Site Scripting (XSS)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__xss_challenge&quot;&gt;XSS Challenges&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__file_upload_xss&quot;&gt;File Upload XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss&quot;&gt;Reflected XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss&quot;&gt;Stored XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_html_attribute&quot;&gt;Stored XSS via HTML Attribute&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__stored_xss_via_ajax&quot;&gt;Stored XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__reflected_xss_via_ajax&quot;&gt;Reflected XSS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part2#2__more_about_xss&quot;&gt;More about XSS&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__client_state_manipulation&quot;&gt;Client-State Manipulation&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__elevation_of_privilege&quot;&gt; Elevation of Privilege &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__cookie_manipulation&quot;&gt; Cookie Manipulation &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_request_forgery&quot;&gt;Cross-Site Request Forgery (XSRF)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xsrf_challenge&quot;&gt;XSRF Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__more_about_preventing_xsrf&quot;&gt;More about preventing XSRF&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part3#3__cross_site_script_inclusion&quot;&gt;Cross Site Script Inclusion (XSSI)&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part3#3__xssi_challenge&quot;&gt;XSSI Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__path_traversal&quot;&gt;Path Traversal&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__information_disclosure_path_traversal&quot;&gt;Information disclosure via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__data_tampering_path_traversal&quot;&gt;Data tampering via path traversal &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__denial_of_service&quot;&gt;Denial of Service&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_quit_server&quot;&gt;DoS - Quit the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__dos_overload_server&quot;&gt;DoS - Overloading the Server&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_dos&quot;&gt;More on Denial of Service&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part4#4__code_execution&quot;&gt;Code Execution&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__code_execution_challenge&quot;&gt;Code Execution Challenge&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part4#4__more_code_execution&quot;&gt;More on Remote Code Execution&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__configuration_vulnerabilities&quot;&gt;Configuration Vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_1&quot;&gt;Information disclosure #1&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_config_2&quot;&gt;Information disclosure #2&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__information_disclosure_bug_3&quot;&gt;Information disclosure #3 &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__ajax_vulnerabilities&quot;&gt;AJAX vulnerabilities&lt;/A&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__dos_via_ajax&quot;&gt;DoS via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__phishing_via_ajax&quot;&gt;Phishing via AJAX&lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__other_vulnerabilities&quot;&gt; Other Vulnerabilities &lt;/A&gt; &lt;/H2&gt;
  &lt;UL&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__buffer_and_integer_overflow&quot;&gt;Buffer Overflow and Integer Overflow&lt;/A&gt;&lt;/LI&gt;
  &lt;LI class=&quot;L2&quot;&gt; &lt;A href=&quot;/part5#5__sql_injection&quot;&gt; SQL Injection &lt;/A&gt;&lt;/LI&gt;
  &lt;/UL&gt;&lt;/LI&gt;
&lt;LI class=&quot;L1&quot;&gt; &lt;A href=&quot;/part5#5__after_the_codelab&quot;&gt;After the Codelab&lt;/A&gt;&lt;/LI&gt;
&lt;/UL&gt;
&lt;/DIV&gt;
&lt;DIV class=&quot;column2&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;
&lt;NOAUTOLINK&gt;
&lt;/NOAUTOLINK&gt;&lt;/P&gt;

&lt;H2&gt;&lt;A name=&quot;5__configuration_vulnerabilities&quot;&gt; &lt;/A&gt; Configuration
Vulnerabilities &lt;/H2&gt;
&lt;P&gt;
Applications are often installed with default settings that attackers
can use to attack them. This is particularly an issue with third party
software where an attacker has easy access to a copy of the same
application or framework you are running. Hackers know the default
account names and passwords. For example, looking at the contents
of &lt;CODE&gt;&lt;A href=&quot;/code/?data.py&quot;&gt;data.py&lt;/A&gt;&lt;/CODE&gt; you know that
there&#39;s a default administrator account named &#39;admin&#39; with the
password
&#39;secret&#39;.
&lt;/P&gt;
&lt;P&gt; Configuration vulnerabilities also include features that
increase attack surface. A common example is a feature that is on by
default but you are not using, so you didn&#39;t configure it and the
default configuration is vulnerable. It also includes debug features
like status pages or dumping stack traces on failures.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_1&quot;&gt; &lt;/A&gt; Information disclosure #1 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Read the contents of the database off of a
running server by exploiting a configuration vulnerability.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;You should look through the Gruyere code looking for default
configurations or debug features that don&#39;t belong there.&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at all the files installed with Gruyere. Are there any files
that shouldn&#39;t be there?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look for a &lt;CODE&gt;.gtl&lt;/CODE&gt; file that isn&#39;t referenced anywhere.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_1_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_1_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; you can use the debug dump
page &lt;CODE&gt;&lt;A href=&quot;/code/?resoources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt;
to display the contents of the database via the following URL:
&lt;/P&gt;&lt;PRE&gt;
https://google-gruyere.appspot.com/582835734666354056417651491707595504272/dump.gtl
&lt;/PRE&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; always make sure debug features are not
installed. In this case, delete &lt;CODE&gt;dump.gtl&lt;/CODE&gt;. This is an
example of the kind of debug feature that might be left in an
application by mistake. If a debug feature like this is necessary,
then it needs to be carefully locked down: only admin users should
have access and only requests from debug IP addresses should be
accepted.
&lt;/P&gt;&lt;P&gt; This exploit exposes the users&#39; passwords. Passwords should
never be stored in cleartext. Instead, you should
use &lt;A href=&quot;https://www.google.com/search?q=password+hashing&quot;&gt;password
hashing&lt;/A&gt;. The idea is that to authenticate a user, you don&#39;t need
to know their password, only be convinced that the user knows it. When
the user sets their password, you store only a cryptographic hash of
the password and a salt value. When the user re-enters their password
later, you recompute the hash and if it matches you conclude the
password is correct. If an attacker obtains the hash value, it&#39;s very
difficult for them to reverse that to find the original
password. (Which is a good thing, since
despite &lt;A href=&quot;https://www.google.com/search?q=choosing+a+good+password&quot;&gt;lots
of advice&lt;/A&gt; to the contrary, users frequently use the same weak
passwords for multiple sites.)
&lt;/P&gt;&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_config_2&quot;&gt; &lt;/A&gt; Information disclosure #2 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fix described above, an attacker can
undo it and execute the attack! How can that be?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
You can upload a file of any type.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_2_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_2_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; Gruyere allows the user to upload files of any
type, including &lt;CODE&gt;.gtl&lt;/CODE&gt; files. So the attacker can simply
upload their own copy
of &lt;CODE&gt;&lt;A href=&quot;/code/?resources/dump.gtl&quot;&gt;dump.gtl&lt;/A&gt;&lt;/CODE&gt; or a
similar file and than access it. In fact, as noted earlier, hosting
arbitrary content on the server is a major security risk whether it&#39;s
HTML, JavaScript, Flash or something else. Allowing a file with an
unknown file type may lead to a security hole in the future.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; we should do several things:
&lt;/P&gt;&lt;OL&gt;
&lt;LI&gt; Only files that are part of Gruyere should be treated as templates.
&lt;/LI&gt;
&lt;LI&gt; Don&#39;t store user uploaded files in the same place as application files.
&lt;/LI&gt;
&lt;LI&gt; Consider limiting the types of files that can be uploaded (via a
whitelist).
&lt;/LI&gt;
&lt;/OL&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;H3&gt;&lt;A name=&quot;5__information_disclosure_bug_3&quot;&gt; &lt;/A&gt; Information disclosure #3 &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_w.png&quot; style=&quot;vertical-align:middle; padding-right: 5px;&quot;&gt;
&lt;B&gt;Even after implementing the fixes described above, a similar attack
is still possible through a different attack vector. Can you find it?&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt;
This attack isn&#39;t a a configuration vulnerability, just bad code.
&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint1&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint1&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;You can insert something in your private snippet which will display the contents of the database.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;This attack is closely related to the previous ones. There is a bug
in the code that expands templates that you can exploit.&lt;/P&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;disclosure_3_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fixes &lt;/H4&gt;
&lt;DIV id=&quot;disclosure_3_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
There is a defect in Gruyere&#39;s template expansion code that reparses
expanded variables. Specifically, when expanding a block it expands
variables in the block. Then it parses the block as a template and
expands variables again,
&lt;/P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; add this to your private snippet:
&lt;PRE&gt;
{{_db:pprint}}
&lt;/PRE&gt;
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; modify the template code so it never reparses inserted
variable values. The defect in the code is due to the fact
that &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; calls &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt;
followed by &lt;CODE&gt;_ExpandVariables&lt;/CODE&gt;,
but &lt;CODE&gt;_ExpandBlocks&lt;/CODE&gt; calls &lt;CODE&gt;ExpandTemplate&lt;/CODE&gt; on
nested blocks. So if a variable is expanded inside a nested block and
contains something that looks like a variable template, it will get
expanded a second time. That sounds complicated because it is
complicated. Parsing blocks and variables separately is a fundamental
flaw in the design of the expander, so the fix is non-trivial.
&lt;/P&gt;
&lt;P&gt;
This exploit is possible because the template language allows
arbitrary database access. It would be safer if the templates were
only allowed to access data specifically provided to them. For
example, a template could have an associated database query and only
the data matched by that query would be passed to the template. This
would limit the scope of a bug like this to data that the user was
already allowed to access.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;/P&gt;&lt;H2&gt;&lt;A name=&quot;5__ajax_vulnerabilities&quot;&gt; &lt;/A&gt; AJAX
vulnerabilities &lt;/H2&gt; Bad AJAX code allows attackers to modify parts
of your application in ways that you might not expect. In traditional
client development, there is a clear separation between the
application and the data it displays. That&#39;s not true in web
applications as the next two attacks will make clear.
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__dos_via_ajax&quot;&gt; &lt;/A&gt; DoS via AJAX &lt;/H3&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find an attack that prevents users from seeing
their private snippets on the home page.&lt;/B&gt; (The attack should be
triggered after clicking the refresh link and without using XSS.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Can you figure out how to change the value of the private snippet in
the AJAX response?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;dom_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
What happens if a JSON object has a duplicate key value?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;dom_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;dom_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;private_snippet&lt;/CODE&gt; and create at least one
snippet. The JSON response will then be &lt;CODE&gt;{&#39;private_snippet&#39; :
&amp;lt;user&#39;s private snippet&amp;gt;, ..., &#39;private_snippet&#39; :
&amp;lt;attacker&#39;s snippet&amp;gt;}&lt;/CODE&gt; and the attacker&#39;s snippet replaces
the user&#39;s.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the AJAX code needs to make sure that the
data only goes where it&#39;s supposed to go. The flaw here is that the
JSON structure is not robust. A better structure would
be &lt;CODE&gt;[&amp;lt;private_snippet&amp;gt;, {&amp;lt;user&amp;gt; :
&amp;lt;snippet&amp;gt;,...}]&lt;/CODE&gt;.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H3&gt;&lt;A name=&quot;5__phishing_via_ajax&quot;&gt; &lt;/A&gt; Phishing via AJAX &lt;/H3&gt;
&lt;P&gt;
While the previous attack may seem like a minor inconvenience,
careless DOM manipulation can lead to much more serious problems.
&lt;/P&gt;
&lt;P&gt;
&lt;IMG src=&quot;/static/cheese_b.png&quot; style=&quot;vertical-align:middle;
padding-right: 5px;&quot;&gt; &lt;B&gt;Find a way to change the sign in link in the
upper right corner to point to &lt;CODE&gt;https://evil.example.com&lt;/CODE&gt;.&lt;/B&gt;
&lt;/P&gt;
&lt;P&gt; (The attack should be triggered after clicking the refresh
link and without using XSS or a script.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;DIV style=&quot;margin-left:18pt&quot;&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 1 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at what the script does to replace the snippets on the page. Can
you get it to replace the sign in link?
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_hint2&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Hint 2 &lt;/H4&gt;
&lt;DIV id=&quot;phishing_hint2&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
Look at the AJAX code to see how it replaces each snippet, and then
look at the structure of the home page and see if you can see what
else you might be able to replace. (You can&#39;t just replace the sign in
link. You&#39;ll have to replace a bit more.)
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;H4 style=&quot;cursor: pointer&quot; onclick=&quot;toggleBlock(this, &#39;phishing_sol&#39;);&quot;&gt;&lt;IMG src=&quot;/static/closed.gif&quot;&gt; Exploit and Fix &lt;/H4&gt;
&lt;DIV id=&quot;phishing_sol&quot; style=&quot;display:none&quot;&gt;
&lt;P&gt;
&lt;B&gt;To exploit,&lt;/B&gt; create a user
named &lt;CODE&gt;menu-right&lt;/CODE&gt; and publish a snippet that looks exactly
like the right side of the menu bar.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;PRE&gt;
&amp;lt;a href=&#39;https://evil.example.com/login&#39;&amp;gt;Sign in&amp;lt;/a&amp;gt;
| &amp;lt;a href=&#39;https://evil.example.com/newaccount.gtl&#39;&amp;gt;Sign up&amp;lt;/a&amp;gt;
&lt;/PRE&gt;
&lt;P&gt;
If the user is already logged in, the menu bar will look wrong. But
that&#39;s ok, since there&#39;s a good chance the user will just think they
somehow accidentally got logged out of the web site and log in again.
&lt;/P&gt;
&lt;P&gt;
&lt;B&gt;To fix,&lt;/B&gt; the process of modifying the DOM needs to be
made more robust. When user values are used in as DOM element
identifiers, you should ensure that there can&#39;t be a conflict as there
is here, for example, applying a prefix to user values
like &lt;CODE&gt;id=&quot;user_&lt;USER&gt;&quot;&lt;/USER&gt;&lt;/CODE&gt;. Even better, use your own
identifiers rather than user values.
&lt;/P&gt;
&lt;P&gt; This spoofing attack is easily detected when the user clicks
Sign in and ends up at &lt;CODE&gt;evil.example.com&lt;/CODE&gt;. A clever attacker could
do something harder to detect, like replacing the Sign in link with a
script that renders the sign in form on the current page with the form
submission going to their server.
&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;/DIV&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;P&gt;&lt;/P&gt;
&lt;P&gt;&lt;/P&gt;
&lt;H2&gt;&lt;A name=&quot;5__other_vulnerabilities&quot;&gt; &lt;/A&gt; Other Vulnerabilities &lt;/H2&gt;
&lt;H3&gt;&lt;A name=&quot;5__buffer_and_integer_overflow&quot;&gt; &lt;/A&gt; Buffer Overflow and Integer Overflow &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;A &lt;A href=&quot;https://www.google.com/search?q=buffer+overflow&quot;
target=&quot;_top&quot;&gt;buffer overflow&lt;/A&gt; vulnerability exists when an
application does not properly guard its buffers and allow user data to
write past the end of a buffer. This excess data can modify other
variables, including pointers and function return addresses, leading
to arbitrary code execution. Historically, buffer overflow
vulnerabilities have been responsible for some of the most widespread
internet attacks
including &lt;a href=&quot;https://www.google.com/search?q=sql+slammer&quot;&gt;SQL
Slammer&lt;a&gt;, &lt;a href=&quot;https://www.google.com/search?q=blaster+worm&quot;&gt;Blaster&lt;/a&gt;
and &lt;a href=&quot;https://www.google.com/search?q=code+red+worm&quot;&gt;Code
Red&lt;/a&gt; computer worms. The PS2, Xbox and Wii have all been hacked
using buffer overflow exploits.
&lt;/P&gt;
&lt;P&gt;While not as well
known, &lt;A href=&quot;https://www.google.com/search?q=integer+overflow+vulnerability&quot;
target=&quot;_top&quot;&gt;integer overflow&lt;/A&gt; vulnerabilities can be just as
dangerous.  Any time an integer computation silently returns an
incorrect result, the application will operate incorrectly. In the
best case, the application fails. In the worst case, there is a
security bug. For example, if an application checks
that &lt;CODE&gt;length&amp;nbsp;+&amp;nbsp;1&amp;nbsp;&amp;lt;&amp;nbsp;limit&lt;/CODE&gt; then this
will succeed if &lt;CODE&gt;length&lt;/CODE&gt; is the largest positive integer
value, which can then expose a buffer overflow vulnerability.
&lt;/P&gt;
&lt;P&gt;This codelab doesn&#39;t cover overflow vulnerabilities because
Gruyere is written in Python, and therefore not vulnerable to
typical buffer and integer overflow problems. Python won&#39;t allow you
to read or write outside the bounds of an array and integers can&#39;t
overflow. While C and C++ programs are most commonly known to expose
these vulnerabilities, other languages are not immune. For example,
while Java was designed to prevent buffer overflows, it silently
ignores integer overflow.
&lt;/P&gt;
&lt;P&gt;
Like all applications, Gruyere is vulnerable to platform vulnerabilities. That
is, if there are security bugs in the platforms that Gruyere is built on top
of, then those bugs would also apply to Gruyere. Gruyere&#39;s platform
includes: the Python runtime system and libraries, AppEngine, the operating
system that Gruyere runs on and the client side software (including the web
browser) that users use to run Gruyere. While platform vulnerabilities are
important, they are outside the scope of this codelab as you generally can&#39;t fix
platform vulnerabilities by making changes to your application. Fixing platform
vulnerabilities yourself is also not practical for many people, but you can
mitigate your risks by making sure that you are diligent in applying security
updates as they are released by platform vendors.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;!--MARK-D--&gt;
&lt;H3&gt;&lt;A name=&quot;5__sql_injection&quot;&gt; &lt;/A&gt; SQL Injection &lt;/H3&gt;
&lt;DIV&gt;&lt;P&gt;Just as XSS vulnerabilities allow attackers to inject script into
web pages, &lt;a href=&quot;https://www.google.com/search?q=sql+injection&quot;&gt;SQL
injection&lt;/a&gt; vulnerabilities allow attackers to inject arbitrary
scripts into SQL queries. When a SQL query is executed it can either
read or write data, so an attacker can use SQL injection to read your
entire database as well as overwrite it, as described in the classic
&lt;a href=&quot;https://xkcd.com/327/&quot;&gt;Bobby Tables&lt;/a&gt; XKCD comic. If you use
SQL, the most important advice is to avoid building queries by string
concatenation: use API calls instead. This codelab doesn&#39;t cover SQL
injection because Gruyere doesn&#39;t use SQL.
&lt;/P&gt;
&lt;/DIV&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;H2&gt;&lt;A name=&quot;5__after_the_codelab&quot;&gt; &lt;/A&gt; After the Codelab &lt;/H2&gt;
&lt;P&gt;
We hope that you found this codelab instructive. If you want more
practice, there are many more security bugs in Gruyere than the ones
described above.  You should attack your own application using what
you&#39;ve learned and write unit tests to verify that these bugs are not
present and won&#39;t get introduced in the future. You should also
consider using &lt;A href=&quot;https://www.google.com/search?q=fuzz+testing&quot;
target=&quot;_top&quot;&gt;fuzz testing&lt;/A&gt; tools. For more information about
security at Google, please visit
our &lt;A href=&quot;https://security.googleblog.com/&quot;
target=&quot;_top&quot;&gt;blog&lt;/A&gt; or
our &lt;A href=&quot;https://www.google.com/about/appsecurity/&quot;
target=&quot;_top&quot;&gt;corporate security page&lt;/A&gt;.
&lt;/P&gt;
&lt;P&gt;
If you&#39;d like to share this codelab with others, please consider
tweeting or buzzing about it or posting one of these badges on your
blog or personal page:
&lt;!--MARK-E--&gt;
&lt;/P&gt;
&lt;div&gt;
&lt;table style=&quot;border-collapse:collapse;border:solid 1 black&quot; cellpadding=&quot;5&quot;&gt;
&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-badge.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot; style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;

&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;border:solid 1 black;text-align:center;vertical-align:middle&quot;&gt;

&lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&gt;
&lt;img src=&quot;../static/gruyere-40.png&quot; 
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot;&gt;&lt;/a&gt;

&lt;/td&gt;&lt;td style=&quot;border:solid 1 black;vertical-align:middle&quot;&gt;

&lt;pre style=&quot;margin:0&quot;&gt;
&amp;lt;a href=&quot;https://google-gruyere.appspot.com/&quot;&amp;gt;
&amp;lt;img src=&quot;//google-gruyere.appspot.com/static/gruyere-40.png&quot;
style=&quot;padding:4pt&quot; border=&quot;0&quot; title=&quot;Learn how to make web apps more
secure. Do the Gruyere codelab.&quot; alt=&quot;Learn how to make web apps more 
secure. Do the Gruyere codelab.&quot;&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;
&lt;div align=&quot;center&quot;  style=&quot;margin:0&quot;&gt;(Line breaks above should be copied verbatim.)&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!--MARK-F--&gt;

&lt;!--NEXTLINK--&gt;
&lt;BR&gt;
&lt;P style=&quot;font-size:x-small&quot;&gt;
&amp;copy; Google 2017 &lt;A href=&quot;https://www.google.com/intl/en/policies/terms/&quot;&gt;Terms of Service&lt;/A&gt;
&lt;BR&gt;The code portions of this codelab are licensed under the
Creative Commons Attribution-No Derivative Works 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by-nd/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by-nd/3.0/us&lt;/A&gt;&amp;gt;.
Brief excerpts of the code may be used for educational or
instructional purposes provided this notice is kept intact.
Except as otherwise noted the remainder of this codelab is licensed under the
Creative Commons Attribution 3.0 United States license
&amp;lt;&lt;A href=&quot;https://creativecommons.org/licenses/by/3.0/us/&quot;&gt;https://creativecommons.org/licenses/by/3.0/us&lt;/A&gt;&amp;gt;.
&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Force UTF-8 for all text content in both the HTTP header and meta tags in HTML or encoding declarations in XML.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-9">Information Disclosure - Suspicious Comments</a> <span>(2)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/lib.js</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html">OWASP_2017_A03</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The response appears to contain suspicious comments which may help an attacker. Note: Matches made within script blocks or files are against the entire content not only comments.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>The following pattern was used: \bUSER\b and was detected in the element starting with: &quot; * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}&quot;, see evidence field for the suspicious comment/snippet.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (411 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/425450881661954264328804432207969818728/lib.js HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/425450881661954264328804432207969818728/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (256 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Content-type: application/javascript
Cache-control: public, max-age=7200
X-XSS-Protection: 0
X-Cloud-Trace-Context: 919cfbe3fa7aad0e80e87d986e106a20
Date: Sun, 15 May 2022 13:19:57 GMT
Server: Google Frontend
Content-Length: 1962

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1962 bytes)</summary>
				
				<pre><code>/* Copyright 2017 Google Inc. */
/**
 * Swaps the display settings of two elements. Before calling, exactly one
 * of the two elements should have style=&quot;display:none&quot; and it shows the one
 * that is hidden and hides the one that is shown.
 */
function _showHide(id1, id2) {
  var x1 = document.getElementById(id1);
  var x2 = document.getElementById(id2);
  var shown = x1.style.display != &#39;&#39;;
  x1.style.display = shown ? &#39;&#39; : &#39;none&#39;;
  x2.style.display = shown ? &#39;none&#39; : &#39;&#39;;
};

/**
 * Refreshes the current page by loading the url and then passing the
 * json response object to the callback.
 */
function _refresh(url, callback) {
  var httpRequest = window.XMLHttpRequest ? new XMLHttpRequest()
      : new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
  httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState == 4) {
      _feed = callback;
      eval(&#39;(&#39; + httpRequest.responseText + &#39;)&#39;);
      httpRequest = null;
    }
  }
  httpRequest.open(&quot;GET&quot;, url, true);
  httpRequest.send(null);
};

/**
 * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}
 */
function _finishRefreshHome(response) {
  for (var uid in response) {
    var element = document.getElementById(uid);
    if (element) {
      element.innerHTML = response[uid];
    }
  }
};

function _refreshHome(uniqueId) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl&quot;, _finishRefreshHome);
};

/**
 * Processes refresh response [name, snippet, ...]
 */
function _finishRefreshSnippets(response) {
  var n = response.length;
  var element = document.getElementById(&#39;user_name&#39;);
  if (n &amp;&amp; element) {
    element.innerHTML = response[0];
  }

  // The snippet divs are numbered 0, 1, ...
  for (var i = 1; i &lt; n; ++i) {
    var element = document.getElementById(i - 1);
    if (element) {
      element.innerHTML = response[i];
    }
  }
};

function _refreshSnippets(uniqueId, uid) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl?uid=&quot; + uid, _finishRefreshSnippets);
};
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>user</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Remove all comments that return information that may help an attacker and fix any underlying problems they refer to.</p>
 </td>
	</tr>
</table>

											</details></li>
										<li><details>
												<summary>
													<span class="request-method-n-url">GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/lib.js</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				<li>
					<span><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP_2021_A01</a></span> 
				</li>
				<li>
					<span><a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html">OWASP_2017_A03</a></span> 
				</li>
			</ul>
		</td>
	</tr>
	<tr>
		<th scope="row">Alert description</th>
		<td> 
<p>The response appears to contain suspicious comments which may help an attacker. Note: Matches made within script blocks or files are against the entire content not only comments.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>The following pattern was used: \bUSER\b and was detected in the element starting with: &quot; * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}&quot;, see evidence field for the suspicious comment/snippet.</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (411 bytes)</summary>
				
				<pre><code>GET http://google-gruyere.appspot.com/582835734666354056417651491707595504272/lib.js HTTP/1.1
Host: google-gruyere.appspot.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
Pragma: no-cache
Cache-Control: no-cache
Referer: http://google-gruyere.appspot.com/582835734666354056417651491707595504272/
Cookie: GRUYERE_ID=582835734666354056417651491707595504272

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (0 bytes)</summary>
				
				<pre><code></code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (256 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Content-type: application/javascript
Cache-control: public, max-age=7200
X-XSS-Protection: 0
X-Cloud-Trace-Context: 9591902ef6e757c177772057c92e33bb
Date: Sun, 15 May 2022 13:20:03 GMT
Server: Google Frontend
Content-Length: 1962

</code></pre>
				
				
			</details> <details class="response-body" open="open">
				<summary>Response body (1962 bytes)</summary>
				
				<pre><code>/* Copyright 2017 Google Inc. */
/**
 * Swaps the display settings of two elements. Before calling, exactly one
 * of the two elements should have style=&quot;display:none&quot; and it shows the one
 * that is hidden and hides the one that is shown.
 */
function _showHide(id1, id2) {
  var x1 = document.getElementById(id1);
  var x2 = document.getElementById(id2);
  var shown = x1.style.display != &#39;&#39;;
  x1.style.display = shown ? &#39;&#39; : &#39;none&#39;;
  x2.style.display = shown ? &#39;none&#39; : &#39;&#39;;
};

/**
 * Refreshes the current page by loading the url and then passing the
 * json response object to the callback.
 */
function _refresh(url, callback) {
  var httpRequest = window.XMLHttpRequest ? new XMLHttpRequest()
      : new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
  httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState == 4) {
      _feed = callback;
      eval(&#39;(&#39; + httpRequest.responseText + &#39;)&#39;);
      httpRequest = null;
    }
  }
  httpRequest.open(&quot;GET&quot;, url, true);
  httpRequest.send(null);
};

/**
 * Processes refresh response {&#39;private_snippet&#39;:snippet, user:snippet, ...}
 */
function _finishRefreshHome(response) {
  for (var uid in response) {
    var element = document.getElementById(uid);
    if (element) {
      element.innerHTML = response[uid];
    }
  }
};

function _refreshHome(uniqueId) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl&quot;, _finishRefreshHome);
};

/**
 * Processes refresh response [name, snippet, ...]
 */
function _finishRefreshSnippets(response) {
  var n = response.length;
  var element = document.getElementById(&#39;user_name&#39;);
  if (n &amp;&amp; element) {
    element.innerHTML = response[0];
  }

  // The snippet divs are numbered 0, 1, ...
  for (var i = 1; i &lt; n; ++i) {
    var element = document.getElementById(i - 1);
    if (element) {
      element.innerHTML = response[i];
    }
  }
};

function _refreshSnippets(uniqueId, uid) {
  _refresh(&quot;/&quot; + uniqueId + &quot;/feed.gtl?uid=&quot; + uid, _finishRefreshSnippets);
};
</code></pre>
				
				
			</details></td>
	</tr>
	
	
	<tr>
		<th scope="row">Evidence</th>
		<td><pre><code>user</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Remove all comments that return information that may help an attacker and fix any underlying problems they refer to.</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				  
			</ol>
		</section>

		<section id="appendix" class="appendix">
			<h2>Appendix</h2>

			<section id="alert-types" class="alert-types">
				<h3>Alert types</h3>
				<p class="alert-types-intro">This section contains additional information on the types of alerts in the report.</p>
				<ol>
					<li
						id="alert-type-0">
						<h4>Cross Site Scripting (Reflected)</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by an active scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/40012/">Cross Site Scripting (Reflected)</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/79.html">79</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>8</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="http://projects.webappsec.org/Cross-Site-Scripting">http://projects.webappsec.org/Cross-Site-Scripting</a></li>
										<li><a
											href="http://cwe.mitre.org/data/definitions/79.html">http://cwe.mitre.org/data/definitions/79.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-1">
						<h4>X-Frame-Options Header Not Set</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10020/">X-Frame-Options Header</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/1021.html">1021</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>15</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-2">
						<h4>Absence of Anti-CSRF Tokens</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10202/">Absence of Anti-CSRF Tokens</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/352.html">352</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>9</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="http://projects.webappsec.org/Cross-Site-Request-Forgery">http://projects.webappsec.org/Cross-Site-Request-Forgery</a></li>
										<li><a
											href="http://cwe.mitre.org/data/definitions/352.html">http://cwe.mitre.org/data/definitions/352.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-3">
						<h4>Cookie No HttpOnly Flag</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10010/">Cookie No HttpOnly Flag</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/1004.html">1004</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>13</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://owasp.org/www-community/HttpOnly">https://owasp.org/www-community/HttpOnly</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-4">
						<h4>Cookie without SameSite Attribute</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10054/">Cookie without SameSite Attribute</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/1275.html">1275</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>13</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site">https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-5">
						<h4>Incomplete or No Cache-control Header Set</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10015/">Incomplete or No Cache-control Header Set</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/525.html">525</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>13</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching">https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching</a></li>
										<li><a
											href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-6">
						<h4>Timestamp Disclosure - Unix</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10096/">Timestamp Disclosure</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/200.html">200</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>13</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="http://projects.webappsec.org/w/page/13246936/Information%20Leakage">http://projects.webappsec.org/w/page/13246936/Information%20Leakage</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-7">
						<h4>X-Content-Type-Options Header Missing</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10021/">X-Content-Type-Options Header Missing</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/693.html">693</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>15</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="http://msdn.microsoft.com/en-us/library/ie/gg622941%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/ie/gg622941%28v=vs.85%29.aspx</a></li>
										<li><a
											href="https://owasp.org/www-community/Security_Headers">https://owasp.org/www-community/Security_Headers</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-8">
						<h4>Charset Mismatch (Header Versus Meta Content-Type Charset)</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/90011/">Charset Mismatch</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/436.html">436</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>15</td>
							</tr>
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="http://code.google.com/p/browsersec/wiki/Part2#Character_set_handling_and_detection">http://code.google.com/p/browsersec/wiki/Part2#Character_set_handling_and_detection</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-9">
						<h4>Information Disclosure - Suspicious Comments</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by a passive scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/10027/">Information Disclosure - Suspicious Comments</a>)
									</span>   
								</td>
							</tr>
							<tr>
								<th scope="row">CWE ID</th>
								<td><a
									href="https://cwe.mitre.org/data/definitions/200.html">200</a></td>
							</tr>
							<tr>
								<th scope="row">WASC ID</th>
								<td>13</td>
							</tr>
							
						</table>
					</li>
				</ol>
			</section>
		</section>
		 
	</main>
</body>
</html>



